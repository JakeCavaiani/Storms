unnest(cols = -c(response, doy, site.ID, year, storm.num)) %>%
ungroup()
HI.med <- HI.dat %>%
group_by(response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num))
str(HI.dat)
library(here)
library(tidyverse)
library(boot)
library(broom)
library(purrr)
library(viridis)
library(tidyr)
library(plyr)
library(dplyr)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(plyr)
library(imputeTS)
library(TSA)
library(bbmle)
library(zoo)
library(xts)
library(forecast)
library(stats)
library(lattice)
library(nlme)
library(geosphere)
library(car)
library(EcoHydRology)
library(dplyr)
HI.med <- HI.dat %>%
group_by(response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num)) %>%
ungroup()
HI.med <- HI.dat %>%
group_by(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num)) %>%
ungroup()
HI.med <- HI.dat %>%
group_by(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num))
HI.med <- HI.dat %>%
group_by(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num)) %>%
ungroup()
HI.med <- HI.dat %>%
group_by(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num))
write.csv(HI.dat, "~/Documents/Storms/Output_from_analysis/HI.dat.csv")
library(here)
library(tidyverse)
library(boot)
library(broom)
library(purrr)
library(viridis)
library(tidyr)
library(plyr)
library(dplyr)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(plyr)
library(imputeTS)
library(TSA)
library(bbmle)
library(zoo)
library(xts)
library(forecast)
library(stats)
library(lattice)
library(nlme)
library(geosphere)
library(car)
library(EcoHydRology)
library(dplyr)
HI.dat <- read.csv("Output_from_analysis/HI.dat.csv")
median_cl_boot <- function(x, conf = 0.95) {
lconf <- (1 - conf)/2
uconf <- 1 - lconf
require(boot)
bmedian <- function(x, ind) median(x[ind])
bt <- boot(x, bmedian, 10000)
bb <- boot.ci(bt, conf = 0.95, type = "perc")
data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t,
uconf))
}
str(HI.dat)
HI.med <- HI.dat %>%
group_by(response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num)) %>%
ungroup()
HI.med <- HI.dat %>%
group_by(response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num))
HI.test <- HI.dat %>% group_by(year) %>%
summarize(total = sum(year))
HI.dat %>% group_by(year) %>%
summarize(total = sum(year))
head(HI.dat)
HI.dat$response
HI.dat <- as.data.frame(HI.dat)
HI.Test <- HI.dat %>% group_by(year) %>%
summarize(total = sum(year))
HI.med <- HI.dat %>%
group_by(HI.dat$response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num))
HI.med <- HI.dat %>%
group_by(HI.dat$response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(HI.dat$response, doy, site.ID, year, storm.num))
HI.med <- HI.dat %>%
group_by(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num))
HI.med <- HI.dat %>%
group_by(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num)) %>%
ungroup()
str(HI.dat)
HI.dat$year <- as.numeric(HI.dat$year)
str(HI.dat)
HI.dat$doy<- as.numeric(HI.dat$doy)
HI.fDOM.doy.pl <-HI.dat %>% filter(response == "fDOM") %>%
ggplot(aes(x = doy, y = statistic)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high, color = site.ID), size=.5, width = 0.1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(4)),
labels = c("French", "Moose", "Poker", "Stuart", "Vault")) +
ylab("fDOM\nHysteresis Index") +
xlab("day of year") +
facet_grid(rows=vars(year)) +
theme_bw() +
theme(panel.border = element_rect(fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(size=20),
strip.background = element_blank(),
legend.title = element_blank()
)
typeof(HI.dat)
rm(HI.dat)
HI.dat <- read.csv("Output_from_analysis/HI.dat.csv")
typeof(HI.dat)
HI.dat <- data.frame(matrix(unlist(HI.dat), nrow=length(HI.dat), byrow=TRUE),stringsAsFactors=FALSE)
typeof(HI.dat)
rm(HI.dat)
HI.dat <- read.csv("Output_from_analysis/HI.dat.csv")
HI.dat <- data.frame(matrix(unlist(HI.dat), nrow=length(HI.dat), byrow=TRUE),stringsAsFactors=FALSE)
median_cl_boot <- function(x, conf = 0.95) {
lconf <- (1 - conf)/2
uconf <- 1 - lconf
require(boot)
bmedian <- function(x, ind) median(x[ind])
bt <- boot(x, bmedian, 10000)
bb <- boot.ci(bt, conf = 0.95, type = "perc")
data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t,
uconf))
}
HI.med <- HI.dat %>%
group_by(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num)) %>%
ungroup()
rm(HI.dat)
HI.dat <- read.csv("Output_from_analysis/HI.dat.csv")
HI.dat <- data.frame(matrix(unlist(HI.dat), nrow=length(HI.dat), byrow=TRUE))
HI.dat <- data.frame(matrix(unlist(HI.dat), nrow=length(HI.dat), byrow=FALSE))
HI.med <- HI.dat %>%
group_by(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(HI.dat$response, HI.dat$doy, HI.dat$site.ID, HI.dat$year, HI.dat$storm.num)) %>%
ungroup()
HI.Test <- HI.dat %>% group_by(year) %>%
summarize(total = sum(year))
HI.Test <- HI.dat %>% group_by(HI.dat$year) %>%
summarize(total = sum(HI.dat$year))
HI.dat <- as.data.frame(HI.dat)
is.data.frame(HI.dat)
HI.dat <- read.csv("Output_from_analysis/HI.dat.csv")
rm(HI.dat)
HI.dat <- read.csv("Output_from_analysis/HI.dat.csv")
is.data.frame(HI.dat)
HI.dat$year <- as.numeric(HI.dat$year)
HI.dat$doy<- as.numeric(HI.dat$doy)
median_cl_boot <- function(x, conf = 0.95) {
lconf <- (1 - conf)/2
uconf <- 1 - lconf
require(boot)
bmedian <- function(x, ind) median(x[ind])
bt <- boot(x, bmedian, 10000)
bb <- boot.ci(bt, conf = 0.95, type = "perc")
data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t,
uconf))
}
HI.Test <- HI.dat %>% group_by(HI.dat$year) %>%
summarize(total = sum(HI.dat$year))
HI.dat <- read.csv("Output_from_analysis/HI.dat.csv")
str(HI.dat)
is.data.frame(HI.dat)
library(here)
library(tidyverse)
library(boot)
library(broom)
library(purrr)
library(viridis)
library(tidyr)
library(plyr)
library(dplyr)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(plyr)
library(imputeTS)
library(TSA)
library(bbmle)
library(zoo)
library(xts)
library(forecast)
library(stats)
library(lattice)
library(nlme)
library(geosphere)
library(car)
library(EcoHydRology)
library(dplyr)
median_cl_boot <- function(x, conf = 0.95) {
lconf <- (1 - conf)/2
uconf <- 1 - lconf
require(boot)
bmedian <- function(x, ind) median(x[ind])
bt <- boot(x, bmedian, 10000)
bb <- boot.ci(bt, conf = 0.95, type = "perc")
data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t,
uconf))
}
str(HI.dat)
HI.Test <- HI.dat %>% group_by(year) %>%
summarize(total = sum(year)) %>% data.frame()
HI.dat$year <- as.numeric(HI.dat$year)
HI.Test <- HI.dat %>% group_by(year) %>%
summarize(total = sum(doy)) %>% data.frame()
test <- HI.dat %>% group_by(year) %>%
summarize(total=sum(year)) %>% data.frame()
HI.recent <- HI.dat %>% dplyr::filter(year>=2019)
rm(HI.dat)
HI.dat <- read.csv("Output_from_analysis/HI.dat.csv")
HI.recent <- HI.dat %>% dplyr::filter(year>=2019)
str(HI.dat)
HI.dat$year <- as.factor(HI.dat$year)
str(HI.dat)
HI.recent <- HI.dat %>% dplyr::filter(year>=2019)
rm(HI.dat)
HI.med <- HI.dat %>%
group_by(response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num)) %>%
ungroup()
test <- HI.dat %>% group_by(year) %>%
summarize(total=sum(year)) %>% data.frame()
HI.dat <- read.csv("Output_from_analysis/HI.dat.csv")
test <- HI.dat %>% group_by(year) %>%
summarize(total=sum(year)) %>% data.frame()
View(HI.dat)
str(HI.dat)
rm(HI.dat)
HI.dat <- read.csv("~/Downloads/comb.all.HI.df.csv")
str(HI.dat)
median_cl_boot <- function(x, conf = 0.95) {
lconf <- (1 - conf)/2
uconf <- 1 - lconf
require(boot)
bmedian <- function(x, ind) median(x[ind])
bt <- boot(x, bmedian, 10000)
bb <- boot.ci(bt, conf = 0.95, type = "perc")
data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t,
uconf))
}
bay.data.system <- bay.data %>% group_by(System, retYr) %>%
summarize(total=sum(ret)) %>% data.frame()
HI.med <- HI.dat %>%
group_by(response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num)) %>%
ungroup()
median_cl_boot <- function(x, conf = 0.95) {
lconf <- (1 - conf)/2
uconf <- 1 - lconf
require(boot)
bmedian <- function(x, ind) median(x[ind])
bt <- boot(x, bmedian, 10000)
bb <- boot.ci(bt, conf = 0.95, type = "perc")
data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t,
uconf))
}
HI.med <- HI.dat %>%
group_by(response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num)) %>%
ungroup()
library(here)
library(tidyverse)
library(boot)
library(broom)
library(purrr)
library(viridis)
library(here)
library(tidyverse)
library(boot)
library(broom)
library(purrr)
library(viridis)
#
HI.dat <- read.csv("~/Downloads/comb.all.HI.df.csv")
median_cl_boot <- function(x, conf = 0.95) {
lconf <- (1 - conf)/2
uconf <- 1 - lconf
require(boot)
bmedian <- function(x, ind) median(x[ind])
bt <- boot(x, bmedian, 10000)
bb <- boot.ci(bt, conf = 0.95, type = "perc")
data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t,
uconf))
}
HI.med <- HI.dat %>%
group_by(response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num)) %>%
ungroup()
library(here)
library(tidyverse)
library(boot)
library(broom)
library(purrr)
library(viridis)
HI.med <- HI.dat %>%
group_by(response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num)) %>%
ungroup()
rm(HI.dat)
HI.dat <- read.csv("Output_from_analysis/HI.dat.csv")
median_cl_boot <- function(x, conf = 0.95) {
lconf <- (1 - conf)/2
uconf <- 1 - lconf
require(boot)
bmedian <- function(x, ind) median(x[ind])
bt <- boot(x, bmedian, 10000)
bb <- boot.ci(bt, conf = 0.95, type = "perc")
data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t,
uconf))
}
HI.med <- HI.dat %>%
group_by(response, doy, site.ID, year, storm.num) %>%
nest() %>%
mutate(medHI.boot = map(data,
~boot(data = .$HI,
statistic = function(x,i) median(x[i]),
R = 1000)),
boot_tidy = map(medHI.boot, tidy, conf.int = TRUE, con.method = "perc"),
n = map(data, nrow)) %>%
select(-data, -medHI.boot) %>%
unnest(cols = -c(response, doy, site.ID, year, storm.num)) %>%
ungroup()
