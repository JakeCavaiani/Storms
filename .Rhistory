strip.background = element_blank(),
legend.title = element_blank()
)
HI.NO3.fDOM.doy.pl <-HI.med %>% filter(year == "2021") %>%
ggplot(aes(x = doy, y = statistic)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high, color = site.ID), size=.5, width = 0.1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(4)),
labels = c("French", "Moose", "Poker", "Stuart", "Vault")) +
ylab("Hysteresis Index") +
xlab("day of year") +
facet_grid(rows = vars(responselabs), labeller = label_parsed) +
theme_bw() +
theme(panel.border = element_rect(fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(size = 20),
strip.background = element_blank(),
legend.title = element_blank()
)
HI.yrs.pl <- HI.med %>%
ggplot(aes(x = site.ID, y = statistic, fill = as.factor(year))) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_boxplot() +
ylab("Hysteresis Index") +
scale_fill_manual(values = c("brown", "deepskyblue4", "#E69F00", "springgreen3")) +
scale_x_discrete(labels = c("French", "Moose", "Poker", "Stuart", "Vault")) +
facet_grid(cols = vars(responselabs), labeller = label_parsed) +
theme_bw() +
theme(panel.border = element_rect(fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.x = element_blank(),
text = element_text(size = 20),
strip.background = element_blank(),
legend.title = element_blank(),
legend.position = c(0.425,0.95),
legend.background = element_blank()
)
HI.fDOM.pl <- HI.med %>% filter(response == "fDOM") %>%
ggplot(aes(x = site.ID, y = statistic, fill = as.factor(year))) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_boxplot() +
ylab("fDOM\nHysteresis Index") +
scale_fill_manual(values = c("brown", "deepskyblue4", "#E69F00", "springgreen3")) +
scale_x_discrete(labels = c("French", "Moose", "Poker", "Stuart", "Vault")) +
theme_bw() +
theme(panel.border = element_rect(fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.x = element_blank(),
text = element_text(size = 20),
strip.background = element_blank(),
legend.title = element_blank(),
legend.position = c(0.875,0.95),
legend.background = element_blank()
)
HI.NO3.pl <- HI.med %>% filter(response == "NO3") %>%
ggplot(aes(x = site.ID, y = statistic, fill = as.factor(year))) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_boxplot() +
ylab("NO3\nHysteresis Index") +
scale_fill_manual(values = c("brown", "deepskyblue4", "#E69F00", "springgreen3")) +
scale_x_discrete(labels = c("French", "Moose", "Poker", "Stuart", "Vault")) +
theme_bw() +
theme(panel.border = element_rect(fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.x = element_blank(),
text = element_text(size = 20),
strip.background = element_blank(),
legend.title = element_blank(),
legend.position = c(0.875,0.95),
legend.background = element_blank()
)
HI.SPC.pl <- HI.med %>% filter(response == "SPC") %>%
ggplot(aes(x = site.ID, y = statistic, fill = as.factor(year))) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_boxplot() +
ylab("SPC\nHysteresis Index") +
scale_fill_manual(values = c("brown", "deepskyblue4", "#E69F00", "springgreen3")) +
scale_x_discrete(labels = c("French", "Moose", "Poker", "Stuart", "Vault")) +
theme_bw() +
theme(panel.border = element_rect(fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.x = element_blank(),
text = element_text(size = 20),
strip.background = element_blank(),
legend.title = element_blank(),
legend.position = c(0.875,0.95),
legend.background = element_blank()
)
HI.turb.pl <- HI.med %>% filter(response == "turb") %>%
ggplot(aes(x = site.ID, y = statistic, fill = as.factor(year))) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_boxplot() +
ylab("SPC\nHysteresis Index") +
scale_fill_manual(values = c("brown", "deepskyblue4", "#E69F00", "springgreen3")) +
scale_x_discrete(labels = c("French", "Moose", "Poker", "Stuart", "Vault")) +
theme_bw() +
theme(panel.border = element_rect(fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.x = element_blank(),
text = element_text(size = 20),
strip.background = element_blank(),
legend.title = element_blank(),
legend.position = c(0.875,0.95),
legend.background = element_blank()
)
ggsave(HI.fDOM.pl, path = here("Output_from_analysis"), file = "HI_fDOM_box.pdf", width = 5.5, height = 5.5, units = "in")
ggsave(HI.NO3.pl, path = here("Output_from_analysis"), file = "HI_NO3_box.pdf", width = 5.5, height = 5.5, units = "in")
ggsave(HI.SPC.pl, path = here("Output_from_analysis"), file = "HI_SPC_box.pdf", width = 5.5, height = 5.5, units = "in")
ggsave(HI.turb.pl, path = here("Output_from_analysis"), file = "HI_turb_box.pdf", width = 5.5, height = 5.5, units = "in")
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(plyr)
library(imputeTS)
library(TSA)
library(bbmle)
library(zoo)
library(xts)
library(forecast)
library(stats)
library(lattice)
library(nlme)
library(geosphere)
library(car)
library(EcoHydRology)
library(dplyr)
################################### 2018 ##################################################################
# Load from local machine #
Q.daily.2018 <- read_csv("~/Documents/DoD_Discharge/Predicted_Discharge/2018/Q.daily.2018.csv")
View(Q.daily.2018)
EXO.2018 <- read.csv("~/Documents/DoD_2018/EXO_data/from_internal_harddrive/processed/EXO.processed.csv")
View(EXO.2018)
Q_2018 <- read_csv("~/Documents/DoD_Discharge/Predicted_Discharge/2018/Q_2018.csv")
names(EXO.2018) <- c("X", "Date", "Time", "Time.s", "Site", "Fault", "Battery.V", "CablePwr.V", "fDOM.RFU", "fDOM.QSU", "Temp.C","Cond.uScm",  "SpCond.uScm", "Sal.psu", "nLFCond.uScm", "TDS.mgL", "Turbidity.FNU", "TSS.mgL")
EXO.2018$Date <- mdy(EXO.2018$Date)
EXO.2018$DateTime <- as.POSIXct(paste(EXO.2018$Date, EXO.2018$Time), format = "%Y-%m-%d %H:%M", tz = "America/Anchorage")
EXO.Q.2018 <- full_join(EXO.2018, Q_2018)
# SUNA #
SUNA.2018 <- read.csv("~/Documents/DoD_2018/SUNA_data/from_internal_harddrive/processed/SUNA.processed.csv")
View(EXO.Q.2018)
SUNA.2018 <- SUNA.2018[, -c(14:269)] # removing channels
SUNA.2018$DateTime <- SUNA.2018$datetimeAK
SUNA.2018$DateTime <- as.POSIXct(SUNA.2018$DateTime, tz = "America/Anchorage", format = "%Y-%m-%d %H:%M")
attributes(SUNA.2018$DateTime)$tzone <- "America/Anchorage"
SUNA.moos <- subset(SUNA.2018, site.ID == "MOOS") # making 15 minute intervals for MOOS
SUNA.2018.1 <- cut(SUNA.moos$DateTime, breaks = "15 min")
SUNA.2018.2 <- as.data.frame(aggregate(nitrateuM~ SUNA.2018.1, data = SUNA.moos, FUN = mean)) # Averaging 15 minute intervals
SUNA.2018.2$DateTime <-as.POSIXct(SUNA.2018.2$SUNA.2018.1, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
SUNA.2018.2$Site <- "MOOS"
SUNA.2018.2 <- SUNA.2018.2[, -c(1)]
SUNA.2018.2$DateTime <- round_date(SUNA.2018.2$DateTime, unit="15 mins")
SUNA.frch <- subset(SUNA.2018, site.ID == "FRCH") # making 15 minute intervals for FRCH
SUNA.2018.3 <- cut(SUNA.frch$DateTime, breaks = "15 min")
SUNA.2018.4 <- as.data.frame(aggregate(nitrateuM~ SUNA.2018.3, data = SUNA.frch, FUN = mean)) # Averaging 15 minute intervals
SUNA.2018.4$DateTime <-as.POSIXct(SUNA.2018.4$SUNA.2018.3, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
SUNA.2018.4$Site <- "FRCH"
SUNA.2018.4 <- SUNA.2018.4[, -c(1)]
SUNA.2018.5 <- rbind(SUNA.2018.2, SUNA.2018.4)
SUNA.2018.5$DateTime <- round_date(SUNA.2018.5$DateTime, unit="15 mins")
EXO.Q.2018 <- EXO.Q.2018[, -c(1,2,3,4,6,7,8,14,15,16,18,20,21)] # removing unnecessary columns
DOD.2018 <- full_join(EXO.Q.2018, SUNA.2018.5)
# subset data by site #
FRCH.2018 <-  subset(DOD.2018, Site == "FRCH")
head(FRCH.2018$DateTime)
frch.final.discharge.2018 <- subset(Q_2018, Site == "FRCH")
head(frch.final.discharge.2018$DateTime)
attributes(frch.final.discharge.2018$DateTime)$tzone <-  'America/Anchorage'
Q_2018$day = format(as.POSIXct(Q_2018$DateTime,format="%Y-%m-%d %H:%M:%S"),format="%Y-%m-%d")
attributes(Q_2018$DateTime)$tzone <- 'America/Anchorage'
Q_2018$day = as.POSIXct(Q_2018$day, "%Y-%m-%d", tz="America/Anchorage")
Q.daily.2018 = with(Q_2018, tapply(MeanDischarge, list(day, Site), mean))
Q.daily.2018 = as.data.frame(Q.daily.2018)
FRCH.Q.2018 = as.data.frame(Q.daily.2018$FRCH)
FRCH.Q.2018$day = as.Date(rownames(Q.daily.2018))
names(FRCH.Q.2018) = c("Discharge_Lsec", "day")
# FRCH #
FRCH.no3 <- subset(FRCH.2018, select = c("DateTime","nitrateuM"))
#plot(FRCH$nitrateuM ~ FRCH$datetimeAK) # plot check
names(FRCH.no3) = c("DateTime", "nitrateuM")
frch.no3.1 <- cut(FRCH.no3$DateTime, breaks="15 min")
frch.no3.final <- as.data.frame(aggregate(nitrateuM ~ frch.no3.1, data = FRCH.no3, FUN = mean)) # Averaging 15 minute intervals
frch.no3.final$DateTime <-as.POSIXct(frch.no3.final$frch.no3.1, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH.fDOM = subset(FRCH.2018, select = c("DateTime","fDOM.QSU"))
names(FRCH.fDOM) = c("DateTime", "fDOM.QSU")
FRCH.fDOM$fDOM.QSU <- as.numeric(FRCH.fDOM$fDOM.QSU)
frch.fdom.final = aggregate(fDOM.QSU ~ DateTime, FUN=mean, data = FRCH.fDOM)# Averaging 15 minute intervals
names(frch.fdom.final) <- c("DateTime", "fDOM.QSU")
FRCH.SpCond = subset(FRCH.2018, select = c("DateTime","SpCond.uScm"))
FRCH.SpCond$SpCond.uScm <- as.numeric(FRCH.SpCond$SpCond.uScm)
frch.spcond.final = aggregate(SpCond.uScm ~ DateTime, FUN=mean, data = FRCH.SpCond) # Averaging 15 minute intervals
frch.spcond.1 <- cut(FRCH.SpCond$DateTime, breaks = "15 min")
frch.spcond.final <- as.data.frame(aggregate(SpCond.uScm ~ frch.spcond.1, data = FRCH.SpCond, FUN = mean)) # Averaging 15 minute intervals
frch.spcond.final$DateTime <-as.POSIXct(frch.spcond.final$frch.spcond.1, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH.turb = subset(FRCH.2018, select = c("DateTime","Turbidity.FNU"))
FRCH.turb$Turbidity.FNU <- as.numeric(FRCH.turb$Turbidity.FNU)
frch.turb.final = aggregate(Turbidity.FNU ~ DateTime, FUN=mean, data = FRCH.turb) # Averaging 15 minute intervals
frch.turb.1 <- cut(FRCH.turb$DateTime, breaks = "15 min")
frch.turb.final <- as.data.frame(aggregate(Turbidity.FNU ~ frch.turb.1, data = FRCH.turb, FUN = mean)) # Averaging 15 minute intervals
frch.turb.final$DateTime <-as.POSIXct(frch.turb.final$frch.turb.1, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH = left_join(frch.final.discharge.2018, frch.fdom.final, by="DateTime")
FRCH = left_join(FRCH, frch.no3.final, by="DateTime")
FRCH = left_join(FRCH, frch.spcond.final, by="DateTime")
FRCH = left_join(FRCH, frch.turb.final, by="DateTime")
FRCH <- FRCH[, -c(3,4,6,8,10,12)]
View(FRCH)
# Write CSV #
write.csv(FRCH, "~/Documents/Storms/Q_Chem/FRCH/FRCH_chem_2018.csv")
View(FRCH)
knitr::opts_chunk$set(echo = TRUE)
library(reticulate)
Sys.which("python")
use_python("/usr/bin/python")
library(tidyverse)
options(tz="America/Anchorage")
library(ggplot2)
library(gridExtra)
library(boot)
```{r}
FRCH.HI.2018 <- read.csv("Output_from_analysis/HI_plots/2018/FRCH/FRCH.HI.doy.df.csv")
FRCH.HI.2018 <- read.csv("~/Documents/Output_from_analysis/HI_plots/2018/FRCH/FRCH.HI.doy.df.csv")
FRCH.HI.2018 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2018/FRCH/FRCH.HI.doy.df.csv")
MOOS.HI.2018 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2018/MOOS/MOOS.HI.doy.df.csv")
HI.2018 <- rbind(FRCH.HI.2018, MOOS.HI.2018)
FRCH.HI.2019 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2019/FRCH/FRCH.HI.doy.df.csv")
MOOS.HI.2019 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2019/MOOS/MOOS.HI.doy.df.csv")
POKE.HI.2019 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2019/POKE/POKE.HI.doy.df.csv")
VAUL.HI.2019 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2019/VAUL/VAUL.HI.doy.df.csv")
STRT.HI.2019 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2019/STRT/STRT.HI.doy.df.csv")
HI.2019 <- rbind(FRCH.HI.2019, MOOS.HI.2019, POKE.HI.2019, VAUL.HI.2019, STRT.HI.2019)
test <- rbind(HI.2018, HI.2019)
FRCH.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/FRCH/FRCH.HI.doy.df.csv")
MOOS.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/MOOS/MOOS.HI.doy.df.csv")
POKE.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/POKE/POKE.HI.doy.df.csv")
FRCH.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/FRCH/FRCH.HI.doy.df.csv")
MOOS.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/MOOS/MOOS.HI.doy.df.csv")
VAUL.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/VAUL/VAUL.HI.doy.df.csv")
STRT.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/STRT/STRT.HI.doy.df.csv")
POKE_HI_doy_df_2020 <- read_csv("~/Downloads/comb.all.HI.df.csv")
POKE_HI_doy_df_2020 <- subset(POKE_HI_doy_df_2020, site.ID == "POKE" & year == "2020")
POKE_HI_doy_df_2020 <- POKE_HI_doy_df_2020[,-1]
names(POKE_HI_doy_df_2020) <- c("X1", "column_label",  "HI","Q_interval", "storm.ID","site.ID","storm.num",
"month","day","response","date","doy","year")
write.csv(POKE_HI_doy_df_2020, "~/Documents/Storms/Output_from_analysis/HI_plots/2020/POKE/POKE_HI_doy_df_2020.csv")
POKE.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/POKE/POKE.HI.doy.df.csv")
POKE.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/POKE/POKE_HI_doy_df_2020.csv")
HI.2020 <- rbind(FRCH.HI.2020, MOOS.HI.2020, POKE.HI.2020, VAUL.HI.2020, STRT.HI.2020)
HI.2020 <- rbind(FRCH.HI.2020, MOOS.HI.2020, VAUL.HI.2020, STRT.HI.2020)
FRCH.HI.2021 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2021/FRCH/FRCH.HI.doy.df.csv")
MOOS.HI.2021 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2021/MOOS/MOOS.HI.doy.df.csv")
HI.2021 <- rbind(FRCH.HI.2021, MOOS.HI.2021)
all.results <- rbind(HI.2018, HI.2019, HI.2020, HI.2021)
all.results$storm.ID = as.factor(all.results$storm.ID)
all.results = separate(data=all.results, col=storm.ID, into=c("site.ID","storm.num", "response"), sep = "_", remove = F)
View(all.results)
all.results = separate(data=all.results, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
all.results.sig = filter(all.results, all.results$wilcox.test.p<0.01)
rm(all.results)
all.results <- rbind(HI.2018, HI.2019, HI.2020, HI.2021)
all.results$storm.ID = as.factor(all.results$storm.ID)
all.results = separate(data=all.results, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
all.results.sig = filter(all.results, all.results$wilcox.test.p<0.01)
library(reticulate)
Sys.which("python")
use_python("/usr/bin/python")
library(tidyverse)
options(tz="America/Anchorage")
library(ggplot2)
library(gridExtra)
library(boot)
all.results = read.csv("/Users/alexwebster/Dropbox/Harms Lab/CPCRW 2017/new tidy files/CPCRW_2017/Output from analyses/24_25_CPCRW_2017/ALL.hyst.results.csv", header = T)
FRCH.HI.2018 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2018/FRCH/FRCH.hyst.results.csv")
MOOS.HI.2018 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2018/MOOS/MOOS.hyst.results.csv")
HI.2018 <- rbind(FRCH.HI.2018, MOOS.HI.2018)
FRCH.HI.2019 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2019/FRCH/FRCH.hyst.results.csv")
MOOS.HI.2019 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2019/MOOS/MOOS.hyst.results.csv")
POKE.HI.2019 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2019/POKE/POKE.hyst.results.csv")
VAUL.HI.2019 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2019/VAUL/VAUL.hyst.results.csv")
STRT.HI.2019 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2019/STRT/STRT.hyst.results.csv")
HI.2019 <- rbind(FRCH.HI.2019, MOOS.HI.2019, POKE.HI.2019, VAUL.HI.2019, STRT.HI.2019)
FRCH.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/FRCH/FRCH.hyst.results.csv")
MOOS.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/MOOS/MOOS.hyst.results.csv")
#POKE.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/POKE/POKE_HI_doy_df_2020.csv")
VAUL.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/VAUL/VAUL.hyst.results.csv")
STRT.HI.2020 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2020/STRT/STRT.hyst.results.csv")
HI.2020 <- rbind(FRCH.HI.2020, MOOS.HI.2020, VAUL.HI.2020, STRT.HI.2020)
#FRCH.HI.2021 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2021/FRCH/FRCH.HI.doy.df.csv")
MOOS.HI.2021 <- read.csv("~/Documents/Storms/Output_from_analysis/HI_plots/2021/MOOS/MOOS.hyst.results.csv")
HI.2021 <- rbind(MOOS.HI.2021)
all.results <- rbind(HI.2018, HI.2019, HI.2020, HI.2021)
all.results$storm.ID = as.factor(all.results$storm.ID)
all.results = separate(data=all.results, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
all.results.sig$site.ID <- factor(all.results.sig$site.ID, levels = c('FRCH','MOOS','POKE','VAUL', 'STRT'))
all.results.sig = filter(all.results, all.results$wilcox.test.p<0.01)
all.results.sig$site.ID <- factor(all.results.sig$site.ID, levels = c('FRCH','MOOS','POKE','VAUL', 'STRT'))
all.results$site.ID <- factor(all.results$site.ID, levels = c('FRCH','MOOS','POKE','VAUL', 'STRT'))
show_col(brewer_pal(palette="RdBu",-1)(4))
ggplot(all.results.sig) +
geom_boxplot(aes(site.ID, HI_mean_Interp, colour=site.ID)) +
#scale_color_brewer(palette="RdBu", direction = -1, name="site.ID") +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020"))+
facet_wrap(~ response) +
theme_bw()
ggplot(all.results.sig) +
geom_boxplot(aes(site.ID, HI_mean_Interp, colour=site.ID)) +
#scale_color_brewer(palette="RdBu", direction = -1, name="site.ID") +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw()
ggplot(all.results.sig) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0)
ggplot(all.results.sig) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0)
ggplot(all.results.sig) +
geom_boxplot(aes(site.ID, HI_mean_Interp, colour=site.ID)) +
#scale_color_brewer(palette="RdBu", direction = -1, name="site.ID") +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw()
HI.2020$storm.ID = as.factor(HI.2020$storm.ID)
HI.2020 = separate(data = HI.2020, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
HI.2020.sig = filter(HI.2020, HI.2020$wilcox.test.p<0.01)
HI.2020.sig$site.ID <- factor(HI.2020.sig$site.ID, levels = c('FRCH','MOOS','POKE','VAUL', 'STRT'))
HI.2020$site.ID <- factor(HI.2020$site.ID, levels = c('FRCH','MOOS','POKE','VAUL', 'STRT'))
show_col(brewer_pal(palette="RdBu",-1)(4))
ggplot(HI.2020.sig) +
geom_boxplot(aes(site.ID, HI_mean_Interp, colour=site.ID)) +
#scale_color_brewer(palette="RdBu", direction = -1, name="site.ID") +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw()
ggplot(HI.2020) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response, scales = "free_x") +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(all.results.sig) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0)
ggplot(HI.2020.sig) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0)
all.HI.p = ggplot(all.results) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response, scales = "free_x") +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
all.HI.p
ggplot(all.results.sig) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0)
ggplot(HI.2020.sig) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0)
HI.2018$year <- "2018"
HI.2019$year <- "2019"
HI.2020$year <- "2020"
HI.2021$year <- "2021"
all.results <- rbind(HI.2018, HI.2019, HI.2020, HI.2021)
rm(all.results)
rm(HI.2018)
rm(HI.2019)
rm(HI.2020)
rm(HI.2020.sig)
rm(HI.2021)
HI.2018 <- rbind(FRCH.HI.2018, MOOS.HI.2018)
HI.2019 <- rbind(FRCH.HI.2019, MOOS.HI.2019, POKE.HI.2019, VAUL.HI.2019, STRT.HI.2019)
HI.2020 <- rbind(FRCH.HI.2020, MOOS.HI.2020, VAUL.HI.2020, STRT.HI.2020)
HI.2021 <- rbind(MOOS.HI.2021)
HI.2018$year <- "2018"
HI.2019$year <- "2019"
HI.2020$year <- "2020"
HI.2021$year <- "2021"
all.results <- rbind(HI.2018, HI.2019, HI.2020, HI.2021)
all.results$storm.ID = as.factor(all.results$storm.ID)
all.results = separate(data=all.results, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
all.results.sig = filter(all.results, all.results$wilcox.test.p<0.01)
all.results.sig$site.ID <- factor(all.results.sig$site.ID, levels = c('FRCH','MOOS','POKE','VAUL', 'STRT'))
all.results$site.ID <- factor(all.results$site.ID, levels = c('FRCH','MOOS','POKE','VAUL', 'STRT'))
show_col(brewer_pal(palette="RdBu",-1)(4))
ggplot(all.results.sig) +
geom_boxplot(aes(site.ID, HI_mean_Interp, colour=site.ID)) +
#scale_color_brewer(palette="RdBu", direction = -1, name="site.ID") +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw()
View(all.results.sig)
ggplot(all.results.sig) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID, shape = year)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0)
ggsave("~/Documents/Storms/Output_from_analysis/HI_plots/AllYears/all.HI.p.pdf", plot=all.HI.p, width = 10, height = 7, units ="in")
all.HI.p = ggplot(all.results) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID, shape = year)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response, scales = "free_x") +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggsave("~/Documents/Storms/Output_from_analysis/HI_plots/AllYears/all.HI.p.pdf", plot=all.HI.p, width = 10, height = 7, units ="in")
ggsave("/Users/alexwebster/Dropbox/Harms Lab/CPCRW 2017/new tidy files/CPCRW_2017/Output from analyses/24_25_CPCRW_2017/all.HI.p.pdf", plot=all.HI.p, width = 20, height = 7, units ="in")
ggsave("~/Documents/Storms/Output_from_analysis/HI_plots/AllYears/all.HI.p.pdf", plot=all.HI.p, width = 20, height = 7, units ="in")
ggsave("~/Documents/Storms/Output_from_analysis/HI_plots/AllYears/all.HI.p.pdf", plot=all.HI.p, width = 25, height = 15, units ="in")
all.results$date <- as.Date(with(all.results, paste(year, mon, day,sep="-")), "%Y-%m-%d")
all.results$date <- as.Date(with(all.results, paste(year, month, day,sep="-")), "%Y-%m-%d")
all.results$storm.ID = as.factor(all.results$storm.ID)
all.results = separate(data=all.results, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
all.results.sig = filter(all.results, all.results$wilcox.test.p<0.01)
all.results.sig$site.ID <- factor(all.results.sig$site.ID, levels = c('FRCH','MOOS','POKE','VAUL', 'STRT'))
all.results$site.ID <- factor(all.results$site.ID, levels = c('FRCH','MOOS','POKE','VAUL', 'STRT'))
show_col(brewer_pal(palette="RdBu",-1)(4))
ggplot(all.results.sig) +
geom_boxplot(aes(site.ID, HI_mean_Interp, colour=site.ID)) +
#scale_color_brewer(palette="RdBu", direction = -1, name="site.ID") +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw()
ggplot(all.results.sig) +
geom_point(aes(date, HI_mean_Interp, colour=site.ID, shape = year)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0)
str(all.results.sig
)
ggplot(all.results.sig) +
geom_point(aes(date, HI_mean_Interp, colour=site.ID, shape = year)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0)
ggplot(all.results.sig) +
geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID, shape = year)) +
scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
facet_wrap(~ response) +
theme_bw() +
geom_errorbar(aes(x=storm.ID,
ymin=HI_mean_Interp-(HI_sd_with_Interp*2),
ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
geom_hline(yintercept=0)
ggsave("~/Documents/Storms/Output_from_analysis/HI_plots/AllYears/all.HI.p.pdf", plot=all.HI.p, width = 20, height = 10, units ="in")
library(readr)
MOOS_storm9_08_29_SPC <- read_csv("Storm_Events/2018/MOOS/MOOS_storm9_08_29_SPC.csv")
View(MOOS_storm9_08_29_SPC)
3+3
3+3
