vif(M1.NO3.beta)
plot(M1.NO3_beta)
plot(M1.NO3.beta)
qqnorm(resid(M1.NO3.beta))
pr <- ggpredict(M1.NO3.beta, terms = c("PrecipWeek"))
plot(pr, add.data = TRUE)
f2.NO3_beta <- formula(beta ~ StormPrecip + PrecipWeek + PrecipMonth + Intensity + TempWeek +  TimeSinceChena + (PrecipWeek|site.ID))
M2.NO3.beta <- lmer(f2.NO3_beta, data = NO3_data_beta)
aictab(list(M0.NO3_beta, M1.NO3.beta, M2.NO3.beta))
dwplot(list(M1.NO3.beta),
vline = geom_vline(xintercept = 0,
colour = "grey60",
linetype = 2)) +
ggtitle("Antecedent Conditions, NO3")
sjPlot::tab_model(M1.NO3.beta)
r.squaredGLMM(M1.NO3.beta)
HI_FI_fDOM %>% ggplot(aes(x = StormPrecip, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. StormPrecip")
HI_FI_fDOM %>% ggplot(aes(x = PrecipWeek, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs.PrecipWeek")
HI_FI_fDOM %>% ggplot(aes(x = PrecipMonth, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)),
labels = c("French", "Moose", "Poker", "Vault", "Stuart", "Caribou")) +
ylab("beta") +
ggtitle("Beta vs. PrecipMonth")
HI_FI_fDOM %>% ggplot(aes(x = PrecipMonth, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. PrecipMonth")
HI_FI_fDOM %>% ggplot(aes(x = ThreeMonth, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs.ThreeMonth")
HI_FI_fDOM %>% ggplot(aes(x = StormTemp, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. StormTemp")
HI_FI_fDOM %>% ggplot(aes(x = TempWeek, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. TempWeek")
HI_FI_fDOM %>% ggplot(aes(x = Intensity, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. Intensity")
HI_FI_fDOM %>% ggplot(aes(x = TimeSinceChena, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin=FI_ymin, ymax=FI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. TimeSinceChena")
HI_FI_fDOM %>% ggplot(aes(x = TimeSinceChena, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. TimeSinceChena")
fDOM_data_beta <- HI_FI_fDOM[,c("beta", "site.ID", "StormPrecip", "StormTemp", "PrecipWeek", "PrecipMonth", "ThreeMonth", "TempWeek", "Intensity", "TimeSinceChena", "burn", "pf")]
View(fDOM_data_beta)
fDOM_data_beta <- na.omit(fDOM_data_beta) #236 to 216
nrow(fDOM_data_beta)
which(fDOM_data_beta$beta > 1.5)
fDOM_data_beta <- fDOM_data_beta[-c(29,40,46, 54,57,79,85,105,125,152,153,154,177,185,186,195,205,207,212, 215, 221), ] # remove outliers
which(fDOM_data_beta$beta < -1.5)
fDOM_data_beta <- fDOM_data_beta[-c(56,83,84,90,117,164,201,203), ] # remove outliers
cor(fDOM_data_beta[,c(1,3:10)])
f0.fDOM_beta <- formula(beta ~ StormPrecip + PrecipWeek + PrecipMonth + ThreeMonth + Intensity + StormTemp + TempWeek +  TimeSinceChena + (1|site.ID))
M0.fDOM_beta <- lmer(f0.fDOM_beta, data = fDOM_data_beta)
summary(M0.fDOM_beta)
plot(M0.fDOM_beta)
qqnorm(resid(M0.fDOM_beta))
vif(M0.fDOM_beta)
f1.fDOM_beta <- formula(beta ~ StormPrecip + PrecipWeek + PrecipMonth + Intensity + TempWeek +  TimeSinceChena + (1|site.ID))
M1.fDOM_beta <- lmer(f1.fDOM_beta, data = fDOM_data_beta)
summary(M1.fDOM_beta)
vif(M1.fDOM_beta)
plot(M1.fDOM_beta)
qqnorm(resid(M1.fDOM_beta))
pr <- ggpredict(M1.turb, terms = c("TempWeek"))
pr <- ggpredict(M1.turb, terms = c("TempWeek"))
plot(pr, add.data = TRUE)
f2.fDOM_beta <- formula(beta ~ StormPrecip + PrecipWeek + PrecipMonth + ThreeMonth + Intensity + StormTemp + TempWeek +  TimeSinceChena + (TempWeek|site.ID))
M2.fDOM_beta <- lmer(f2.fDOM_beta, data = fDOM_data_beta)
summary(M2.fDOM_beta)
aictab(list(M0.fDOM_beta, M1.fDOM_beta, M2.fDOM_beta))
dwplot(list(M1.fDOM_beta),
vline = geom_vline(xintercept = 0,
colour = "grey60",
linetype = 2)) +
ggtitle("Antecedent Conditions, fDOM")
sjPlot::tab_model(M1.fDOM_beta)
r.squaredGLMM(M1.fDOM_beta)
f3.fDOM_beta <- formula(beta ~ StormPrecip*pf + PrecipWeek*pf + PrecipMonth*pf + ThreeMonth*pf + Intensity*pf + StormTemp*pf + TempWeek*pf +  TimeSinceChena*pf + (1|site.ID))
M3.fDOM_beta <- lmer(f3.fDOM_beta, data = fDOM_data_beta)
summary(M3.fDOM_beta)
f4.fDOM_beta <- formula(beta ~ StormPrecip*burn + PrecipWeek*burn + PrecipMonth*burn + ThreeMonth*burn + Intensity*burn + StormTemp*burn + TempWeek*burn +  TimeSinceChena*burn + (1|site.ID))
M4.fDOM_beta <- lmer(f4.fDOM_beta, data = fDOM_data_beta)
summary(M4.fDOM_beta)
HI_FI_SPC %>% ggplot(aes(x = StormPrecip, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. StormPrecip")
HI_FI_SPC %>% ggplot(aes(x = PrecipWeek, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. PrecipWeek")
HI_FI_SPC %>% ggplot(aes(x = PrecipMonth, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("beta vs. PrecipMonth")
HI_FI_SPC %>% ggplot(aes(x = ThreeMonth, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. ThreeMonth")
HI_FI_SPC %>% ggplot(aes(x = ThreeMonth, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. ThreeMonth")
HI_FI_SPC %>% ggplot(aes(x = StormTemp, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)),
labels = c("French", "Moose", "Poker", "Vault", "Stuart", "Caribou")) +
ylab("beta") +
ggtitle("Beta vs. StormTemp")
HI_FI_SPC %>% ggplot(aes(x = StormTemp, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. StormTemp")
HI_FI_SPC %>% ggplot(aes(x = TempWeek, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("Beta") +
ggtitle("Beta vs. TempWeek")
HI_FI_SPC %>% ggplot(aes(x = Intensity, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("Beta") +
ggtitle("Beta vs. Intensity")
HI_FI_SPC %>% ggplot(aes(x = TimeSinceChena, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. TimeSinceChena")
SPC_data_beta <- HI_FI_SPC[,c("beta", "site.ID", "StormPrecip", "StormTemp", "PrecipWeek", "PrecipMonth", "ThreeMonth", "TempWeek", "Intensity", "TimeSinceChena", "burn", "pf")]
nrow(SPC_data_beta)
SPC_data_beta <- na.omit(SPC_data_beta) #236 to 216
nrow(SPC_data_beta)
which(SPC_data_beta$beta > 1.5)
SPC_data_beta <- SPC_data_beta[-c(48,61,88,109,111,130,173,206), ]
which(SPC_data_beta$beta < -1.5)
SPC_data_beta <- SPC_data_beta[-c(44,96,97,100,117,120), ]
cor(SPC_data_beta[,c(1,3:10)])
f0.SPC_beta <- formula(beta ~ StormPrecip + PrecipWeek + PrecipMonth + ThreeMonth + Intensity + StormTemp + TempWeek +  TimeSinceChena + (1|site.ID))
M0.SPC_beta <- lmer(f0.SPC_beta, data = SPC_data_beta)
summary(M0.SPC_beta)
plot(M0.SPC_beta)
qqnorm(resid(M0.SPC_beta))
f1.SPC_beta <- formula(log(beta + 1) ~ StormPrecip + PrecipWeek + PrecipMonth + ThreeMonth + Intensity + StormTemp + TempWeek +  TimeSinceChena + (1|site.ID))
M1.SPC_beta <- lmer(f1.SPC_beta, data = SPC_data_beta)
summary(M1.SPC_beta)
f1.SPC_beta <- formula(log(beta) + 1  ~ StormPrecip + PrecipWeek + PrecipMonth + ThreeMonth + Intensity + StormTemp + TempWeek +  TimeSinceChena + (1|site.ID))
M1.SPC_beta <- lmer(f1.SPC_beta, data = SPC_data_beta)
summary(M1.SPC_beta)
plot(M1.SPC_beta)
f1.SPC_beta <- formula(log(beta + 1)  ~ StormPrecip + PrecipWeek + PrecipMonth + ThreeMonth + Intensity + StormTemp + TempWeek +  TimeSinceChena + (1|site.ID))
plot(M1.SPC_beta)
f1.SPC_beta <- formula(beta ~ StormPrecip + PrecipWeek + PrecipMonth + Intensity + TempWeek +  TimeSinceChena + (1|site.ID))
M1.SPC_beta <- lmer(f1.SPC_beta, data = SPC_data_beta)
summary(M1.SPC_beta)
Vif(M1.SPC_beta)
summary(M1.SPC_beta)
vif(M1.SPC_beta)
plot(M1.SPC_beta)
qqnorm(resid(M1.SPC_beta))
pr <- ggpredict(M1.turb, terms = c("PrecipMonth"))
plot(pr, add.data = TRUE)
f2.SPC_beta <- formula(beta ~ StormPrecip + PrecipWeek + PrecipMonth  + Intensity + TempWeek +  TimeSinceChena + (PrecipMonth|site.ID))
M2.SPC_beta <- lmer(f2.SPC_beta, data = SPC_data_beta)
summary(M2.SPC_beta)
aictab(list(M0.SPC_beta, M1.SPC_beta, M2.SPC_beta))
dwplot(list(M1.SPC_beta),
vline = geom_vline(xintercept = 0,
colour = "grey60",
linetype = 2)) +
ggtitle("Antecedent Conditions, SOC")
dwplot(list(M1.SPC_beta),
vline = geom_vline(xintercept = 0,
colour = "grey60",
linetype = 2)) +
ggtitle("Antecedent Conditions, SPC")
sjPlot::tab_model(M1.SPC_beta)
r.squaredGLMM(M1.SPC_beta)
f3.SPC_beta <- formula(beta ~ StormPrecip*pf + PrecipWeek*pf + PrecipMonth*pf + ThreeMonth*pf + Intensity*pf + StormTemp*pf + TempWeek*pf +  TimeSinceChena*pf + (1|site.ID))
M3.SPC_beta <- lmer(f3.SPC_beta, data = SPC_data_beta)
summary(M3_SPC_beta)
summary(M3.SPC_beta)
f4.SPC_beta <- formula(beta ~ StormPrecip*burn + PrecipWeek*burn + PrecipMonth*burn + ThreeMonth*burn + Intensity*burn + StormTemp*burn + TempWeek*burn +  TimeSinceChena*burn + (1|site.ID))
M4.SPC_beta <- lmer(f4.SPC_beta, data = SPC_data_beta)
summary(M4.SPC_beta)
HI_FI_turb %>% ggplot(aes(x = StormPrecip, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("beta vs. StormPrecip")
HI_FI_turb %>% ggplot(aes(x = PrecipWeek, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("Beta") +
ggtitle("Beta vs. PrecipWeek")
HI_FI_turb %>% ggplot(aes(x = PrecipMonth, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("Beta") +
ggtitle("Beta vs. PrecipMonth")
HI_FI_turb %>% ggplot(aes(x = ThreeMonth, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("Beta") +
ggtitle("Beta vs. ThreeMonth")
HI_FI_turb %>% ggplot(aes(x = StormTemp, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("Beta") +
ggtitle("Beta vs. StormTemp")
HI_FI_turb %>% ggplot(aes(x = TempWeek, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("Beta") +
ggtitle("Beta vs. TempWeek")
HI_FI_turb %>% ggplot(aes(x = Intensity, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta") +
ggtitle("Beta vs. Intensity")
HI_FI_turb %>% ggplot(aes(x = TimeSinceChena, y = beta)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ylim(c(-1.5, 1.5)) +
ylab("beta ") +
ggtitle("Beta vs. TimeSinceChena")
turb_data_beta <- HI_FI_turb[,c("beta", "site.ID", "StormPrecip", "StormTemp", "PrecipWeek", "PrecipMonth", "ThreeMonth", "TempWeek", "Intensity", "TimeSinceChena", "burn", "pf")]
nrow(turb_data_beta)
turb_data_beta <- na.omit(turb_data_beta) #236 to 216
nrow(turb_data_beta)
which(turb_data_beta$beta > 1.5)
turb_data_beta <- turb_data_beta[-c(22,25,51,68,73,83,91,92,95,99,120,129,146,174,177,200,209,219,221)]
turb_data_beta <- turb_data_beta[-c(22,25,51,68,73,83,91,92,95,99,120,129,146,174,177,200,209,219,221),]
which(turb_data_beta$beta < -1.5)
turb_data_beta <- turb_data_beta[-c(21,139,195),]
cor(turb_data_beta[,c(1,3:10)])
f0.turb_beta <- formula(beta ~ StormPrecip + PrecipWeek + PrecipMonth + ThreeMonth + Intensity + StormTemp + TempWeek +  TimeSinceChena + (1|site.ID))
M0.turb_beta <- lmer(f0.turb_beta, data = turb_data_beta)
summary(M0.turb_beta)
plot(M0.turb_beta)
qqnorm(resid(M0.turb_beta))
f1.turb_beta <- formula(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + Intensity + TempWeek +  TimeSinceChena + (1|site.ID))
M1.turb_beta <- lmer(f1.turb, data = turb_data_beta)
M1.turb_beta <- lmer(f1.turb_beta, data = turb_data_beta)
f1.turb_beta <- formula(beta~ StormPrecip + PrecipWeek + PrecipMonth + Intensity + TempWeek +  TimeSinceChena + (1|site.ID))
M1.turb_beta <- lmer(f1.turb_beta, data = turb_data_beta)
summary(M1.turb_beta)
vif(M1.turb_beta)
plot(M1.turb_beta)
qqnorm(resid(M1.turb_beta))
pr <- ggpredict(M1.turb_beta, terms = c("StormPrecip"))
plot(pr, add.data = TRUE)
f2.turb_beta <- formula(beta ~ StormPrecip + PrecipWeek + PrecipMonth + Intensity + TempWeek +  TimeSinceChena + (StormPrecip|site.ID))
f2.turb_beta <- formula(beta ~ StormPrecip + PrecipWeek + PrecipMonth + Intensity + TempWeek +  TimeSinceChena + (StormPrecip|site.ID))
M2.turb_beta <- lmer(f2.turb_beta, data = turb_data_beta)
summary(M2.turb_beta)
aictab(list(M0.turb_beta, M1.turb_beta, M2.turb_beta))
dwplot(list(M1.turb_beta),
vline = geom_vline(xintercept = 0,
colour = "grey60",
linetype = 2)) +
ggtitle("Antecedent Conditions, Turb")
sjPlot::tab_model(M1.turb_beta)
r.squaredGLMM(M1.turb_beta)
f3.turb_beta <- formula(beta ~ StormPrecip*pf + PrecipWeek*pf + PrecipMonth*pf + ThreeMonth*pf + Intensity*pf + StormTemp*pf + TempWeek*pf +  TimeSinceChena*pf + (1|site.ID))
M3.turb_beta <- lmer(f3.turb_beta, data = turb_data_beta)
summary(M3.turb_beta)
f4.turb_beta <- formula(beta ~ StormPrecip*burn + PrecipWeek*burn + PrecipMonth*burn + Intensity*burn + TempWeek*burn +  TimeSinceChena*burn + (1|site.ID))
M4.turb_beta <- lmer(f4.turb_beta, data = turb_data_beta)
summary(M4.turb_beta)
citation("MuMIn")
library(dplyr)
library(magrittr)
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(lubridate)
library(data.table)
library(ggplot2)
library(scales)
library(lme4)
library(nlme)
library(datasets)
library(arm)
library(AICcmodavg)
library(gridExtra)
library(grid)
library(ggpmisc)
library(boot)
library(here)
library(broom)
library(purrr)
library(viridis)
library(car)
library(MuMIn)
library(ggeffects)
library(tidyverse)
