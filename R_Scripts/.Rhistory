xlim =  as.POSIXct(c("2021-05-01 00:00:00","2021-10-01 00:00:00"), tz="America/Anchorage"),
ylim = c(0, 3000), col="blue")
#
plot(poke.final.discharge.2021$MeanDischarge ~ poke.final.discharge.2021$DateTime, type="l", xlab="", ylab="Q (L/sec)",
xlim = as.POSIXct(c("2021-05-01 00:00:00","2021-10-01 00:00:00"), tz="America/Anchorage"),
ylim = c(0,2000), col="blue")
plot(vaul.final.discharge.2021$MeanDischarge ~ vaul.final.discharge.2021$DateTime, type="l", xlab="", ylab="Q (L/sec)",
xlim = as.POSIXct(c("2021-05-01 00:00:00","2021-10-01 00:00:00"), tz="America/Anchorage"),
ylim = c(0,2000), col="blue")
plot(strt.final.discharge.2021$MeanDischarge ~ strt.final.discharge.2021$DateTime, type="l", xlab="", ylab="Q (L/sec)",
xlim = as.POSIXct(c("2021-05-01 00:00:00","2021-10-01 00:00:00"), tz="America/Anchorage"),
ylim = c(0,3000), col="blue")
plot(moos.final.discharge.2021$MeanDischarge ~ moos.final.discharge.2021$DateTime, type="l", xlab="", ylab="Q (L/sec)",
xlim = as.POSIXct(c("2021-05-01 00:00:00","2021-10-01 00:00:00"), tz="America/Anchorage"),
ylim = c(0,4000), col="blue")
ggplot(aes(x = DateTime, y = Discharge), data = CARI_2021) +
geom_line(color="#A6CEE3", size=1.25) +
theme_classic() +
ggtitle("CARI measured Q") +
xlab("Date") +
ylab("Discharge (L/s)") +
xlab("")
### Hydrograph Separation ###
#
frch.final.discharge.2021.1 <- na.omit(frch.final.discharge.2021)
strt.final.discharge.2021.1 <- na.omit(strt.final.discharge.2021)
poke.final.discharge.2021.1 <- na.omit(poke.final.discharge.2021)
vaul.final.discharge.2021.1 <- na.omit(vaul.final.discharge.2021)
moos.final.discharge.2021.1 <- na.omit(moos.final.discharge.2021)
FRCH_Q_bf = BaseflowSeparation(frch.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(FRCH.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=FRCH_Q_bf$bt)
STRT_Q_bf = BaseflowSeparation(strt.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(STRT.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=STRT_Q_bf$bt)
#
POKE_Q_bf = BaseflowSeparation(poke.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(POKE.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=POKE_Q_bf$bt)
#
VAUL_Q_bf = BaseflowSeparation(vaul.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(VAUL.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=VAUL_Q_bf$bt)
MOOS_Q_bf = BaseflowSeparation(moos.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(MOOS.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=MOOS_Q_bf$bt)
# CARI
any(is.na(cari.final.discharge.2021$Discharge))
cari.final.discharge.2021 <- na.omit(cari.final.discharge.2021) # removed 225351-209057
CARI_Q_bf = BaseflowSeparation(cari.final.discharge.2021$Discharge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(CARI.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=CARI_Q_bf$bt)
###.925 ###
FRCH_Q_bf = BaseflowSeparation(frch.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(FRCH.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=FRCH_Q_bf$bt)
#
STRT_Q_bf = BaseflowSeparation(strt.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(STRT.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=STRT_Q_bf$bt)
#
POKE_Q_bf = BaseflowSeparation(poke.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(POKE.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=POKE_Q_bf$bt)
#
VAUL_Q_bf = BaseflowSeparation(vaul.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(VAUL.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=VAUL_Q_bf$bt)
MOOS_Q_bf = BaseflowSeparation(moos.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(MOOS.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=MOOS_Q_bf$bt)
#
CARI_Q_bf = BaseflowSeparation(cari.final.discharge.2021$Discharge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(CARI.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=CARI_Q_bf$bt)
### .95 ###
FRCH_Q_bf = BaseflowSeparation(frch.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(FRCH.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=FRCH_Q_bf$bt)
#
STRT_Q_bf = BaseflowSeparation(strt.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(STRT.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=STRT_Q_bf$bt)
#
POKE_Q_bf = BaseflowSeparation(poke.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(POKE.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=POKE_Q_bf$bt)
#
VAUL_Q_bf = BaseflowSeparation(vaul.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(VAUL.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=VAUL_Q_bf$bt)
MOOS_Q_bf = BaseflowSeparation(moos.final.discharge.2021.1$MeanDischarge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(MOOS.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=MOOS_Q_bf$bt)
#
CARI_Q_bf = BaseflowSeparation(cari.final.discharge.2021$Discharge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(CARI.Q.2021, select = c(day, Discharge_Lsec)), streamflow2=CARI_Q_bf$bt)
FRCH_bfQ_mn = mean(FRCH_Q_bf$bt)
FRCH_bfQ_mn
FRCH_bfQ_mn*2
STRT_bfQ_mn = mean(STRT_Q_bf$bt)
STRT_bfQ_mn
STRT_bfQ_mn*2
VAUL_bfQ_mn = mean(VAUL_Q_bf$bt)
VAUL_bfQ_mn
VAUL_bfQ_mn*2
POKE_bfQ_mn = mean(POKE_Q_bf$bt)
POKE_bfQ_mn
POKE_bfQ_mn*2
MOOS_bfQ_mn = mean(MOOS_Q_bf$bt)
MOOS_bfQ_mn
MOOS_bfQ_mn*2
CARI_bfQ_mn = mean(CARI_Q_bf$bt)
CARI_bfQ_mn
CARI_bfQ_mn*2
### Merge Discharge and Precip ###
STRT.st <- read_csv("~/Documents/DoD_2021/RainGauge/STRT.RainGauge.2021.csv")
attributes(STRT.st$DateTime)$tzone <- 'America/Anchorage'
VAUL.st <- read_csv("~/Documents/DoD_2021/RainGauge/VAUL.RainGauge.2021.csv")
attributes(VAUL.st$DateTime)$tzone <- 'America/Anchorage'
POKE.st <- read_csv("~/Documents/DoD_2021/RainGauge/POKE.RainGauge.2021.csv")
attributes(POKE.st$DateTime)$tzone <- 'America/Anchorage'
strt.precip.discharge <- full_join(strt.final.discharge.2021, STRT.st) # merging precip data and discharge
vaul.precip.discharge <- full_join(vaul.final.discharge.2021, VAUL.st) # merging precip data and discharge
poke.precip.discharge <- full_join(poke.final.discharge.2021, POKE.st) # merging precip data and discharge
### Sum daily discharge ###
strt.precip.discharge$twentyfour <- rollapplyr(strt.precip.discharge$inst_rainfall_mm, 96, sum, na.rm = TRUE, fill = NA, partial = TRUE)
strt.precip.discharge$fourtyeight <- rollapplyr(strt.precip.discharge$inst_rainfall_mm, 192, sum, na.rm = TRUE, fill = NA, partial = TRUE)
vaul.precip.discharge$twentyfour <- rollapplyr(vaul.precip.discharge$inst_rainfall_mm, 96, sum, na.rm = TRUE, fill = NA, partial = TRUE)
vaul.precip.discharge$fourtyeight <- rollapplyr(vaul.precip.discharge$inst_rainfall_mm, 192, sum, na.rm = TRUE, fill = NA, partial = TRUE)
poke.precip.discharge$twentyfour <- rollapplyr(poke.precip.discharge$inst_rainfall_mm, 96, sum, na.rm = TRUE, fill = NA, partial = TRUE)
poke.precip.discharge$fourtyeight <- rollapplyr(poke.precip.discharge$inst_rainfall_mm, 192, sum, na.rm = TRUE, fill = NA, partial = TRUE)
# Greater than 5 #
strt.five.twenty.four <- strt.precip.discharge[which(strt.precip.discharge$twentyfour >= 5),] # twenty four hour period where the precip is 5
strt.five.fourty.eight <- strt.precip.discharge[which(strt.precip.discharge$fourtyeight >= 5),] # fourty eight hour period where the precip is greater than 10
vaul.five.twenty.four <- vaul.precip.discharge[which(vaul.precip.discharge$twentyfour >= 5),] # twenty four hour period where the precip is 5
vaul.five.fourty.eight <- vaul.precip.discharge[which(vaul.precip.discharge$fourtyeight >= 5),] # fourty eight hour period where the precip is greater than 10
poke.five.twenty.four <- poke.precip.discharge[which(poke.precip.discharge$twentyfour >= 5),] # twenty four hour period where the precip is 5
poke.five.fourty.eight <- poke.precip.discharge[which(poke.precip.discharge$fourtyeight >= 5),] # fourty eight hour period where the precip is greater than 10
# Greater than 10 #
strt.ten.twenty.four <- strt.precip.discharge[which(strt.precip.discharge$twentyfour >= 10),] # twenty four hour period where the precip is 10
strt.ten.fourty.eight <- strt.precip.discharge[which(strt.precip.discharge$fourtyeight >= 10),] # fourty eight hour period where the precip is greater than 10
vaul.ten.twenty.four <- vaul.precip.discharge[which(vaul.precip.discharge$twentyfour >= 10),] # twenty four hour period where the precip is 10
vaul.ten.fourty.eight <- vaul.precip.discharge[which(vaul.precip.discharge$fourtyeight >= 10),] # fourty eight hour period where the precip is greater than 10
poke.ten.twenty.four <- poke.precip.discharge[which(poke.precip.discharge$twentyfour >= 10),] # twenty four hour period where the precip is 10
poke.ten.fourty.eight <- poke.precip.discharge[which(poke.precip.discharge$fourtyeight >= 10),] # fourty eight hour period where the precip is greater than 10
write.csv(strt.precip.discharge, "~/Documents/DoD_2021/RainGauge/strt.precip.discharge.csv", row.names = FALSE)
write.csv(vaul.precip.discharge, "~/Documents/DoD_2021/RainGauge/vaul.precip.discharge.csv", row.names = FALSE)
write.csv(poke.precip.discharge, "~/Documents/DoD_2021/RainGauge/poke.precip.discharge.csv", row.names = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(lubridate)
library(data.table)
library(ggplot2)
library(scales)
library(lme4)
library(nlme)
library(datasets)
library(arm)
library(AICcmodavg)
library(gridExtra)
library(grid)
library(ggpmisc)
library(boot)
library(here)
library(broom)
library(purrr)
library(viridis)
library(car)
# Read in data #
antecedent_HI_FI_1_0 <- read_csv("~/Documents/Storms/Output_from_analysis/06_HI_fire_permafrost_script/antecedent_HI_FI_1.0.csv") # read in data
antecedent_HI_FI_1_0 <- antecedent_HI_FI_1_0[,-c(1:2,14:15,17,19)] # cleaning up columns that are unnecessary
colNames <- c("Hyst_index", "HI_ymin", "HI_ymax", "site.ID", "storm.ID", "month", "day", "response_var", "Flush_index", "FI_ymin", "FI_ymax", "year", "beta", "StormPrecip", "StormTemp", "PrecipWeek", "PrecipMonth", "ThreeMonth", "TempWeek", "Duration", "Intensity", "doy", "burn", "pf", "date", "TimeSinceChena")
names(antecedent_HI_FI_1_0)<- colNames # renaming columns
# filling in holes that the automated script did not do correctly
antecedent_HI_FI_1_0[c(310:313), 20] <- 68.75
antecedent_HI_FI_1_0[c(310:313), 21] <- 0.01454545
antecedent_HI_FI_1_0[c(317:319), 20] <- 71.25
antecedent_HI_FI_1_0[c(317:319), 21] <- 0.5277193
antecedent_HI_FI_1_0[c(331:334), 20] <- 61.25
antecedent_HI_FI_1_0[c(331:334), 21] <- 0.07183673
antecedent_HI_FI_1_0[c(629:632), 20] <- 21.25
antecedent_HI_FI_1_0[c(629:632), 21] <- 0.09411765
antecedent_HI_FI_1_0[c(651:653), 20] <- 30.25
antecedent_HI_FI_1_0[c(651:653), 21] <- 0.2181818
antecedent_HI_FI_1_0[c(658:659), 20] <- 23.5
antecedent_HI_FI_1_0[c(658:659), 21] <- 0.03404255
antecedent_HI_FI_1_0[c(814:817), 20] <- 30.5
antecedent_HI_FI_1_0[c(814:817), 21] <- 0.1901639
antecedent_HI_FI_1_0[c(852:854), 20] <- 58.5
antecedent_HI_FI_1_0[c(852:854), 21] <- 0.1628205
antecedent_HI_FI_1_0[c(889:892), 20] <- 31.5
antecedent_HI_FI_1_0[c(889:892), 21] <- 0.1777778
##subsetting by solute
# NO3 #
HI_FI_NO3 = subset(antecedent_HI_FI_1_0, response_var == "NO3")
# fDOM #
HI_FI_fDOM = subset(antecedent_HI_FI_1_0, response_var == "fDOM")
# SPC #
HI_FI_SPC = subset(antecedent_HI_FI_1_0, response_var == "SPC")
# turb #
HI_FI_turb = subset(antecedent_HI_FI_1_0, response_var == "turb")
HI_FI_NO3$site.ID <- factor(HI_FI_NO3$site.ID, levels = c('FRCH','MOOS','POKE','STRT','VAUL', 'CARI'))
HI_FI_NO3.p =
ggplot(HI_FI_NO3, aes(Flush_index, Hyst_index)) + geom_point(aes(colour=factor(site.ID), shape = pf), size = 4)+
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_hline(yintercept = 0) + geom_vline(xintercept = 0)+
geom_errorbarh(aes(xmin=FI_ymin, xmax=FI_ymax), colour="black", alpha=0.5, size=.5, height = 0.1) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5)+
ggtitle("a) NO3-")+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), text = element_text(size = 20))
HI_FI_NO3.p
HI_FI_fDOM$site.ID <- factor(HI_FI_fDOM$site.ID, levels = c('FRCH','MOOS','POKE','STRT','VAUL', 'CARI'))
HI_FI_fDOM.p =
ggplot(HI_FI_fDOM, aes(Flush_index, Hyst_index)) + geom_point(aes(colour=factor(site.ID), shape = pf), size = 4)+
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_hline(yintercept = 0) + geom_vline(xintercept = 0)+
geom_errorbarh(aes(xmin=FI_ymin, xmax=FI_ymax), colour="black", alpha=0.5, size=.5, height = 0.1) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5)+
ggtitle("b) fDOM")+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), text = element_text(size = 20))
HI_FI_fDOM.p
HI_FI_SPC$site.ID <- factor(HI_FI_SPC$site.ID, levels = c('FRCH','MOOS','POKE','STRT','VAUL', 'CARI'))
HI_FI_SPC.p =
ggplot(HI_FI_SPC, aes(Flush_index, Hyst_index)) + geom_point(aes(colour=factor(site.ID), shape = pf), size = 4)+
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_hline(yintercept = 0) + geom_vline(xintercept = 0)+
geom_errorbarh(aes(xmin=FI_ymin, xmax=FI_ymax), colour="black", alpha=0.5, size=.5, height = 0.1) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5)+
ggtitle("c) SPC")+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), text = element_text(size = 20))
HI_FI_SPC.p
HI_FI_turb$site.ID <- factor(HI_FI_turb$site.ID, levels = c('FRCH','MOOS','POKE','STRT','VAUL', 'CARI'))
HI_FI_turb.p =
ggplot(HI_FI_turb, aes(Flush_index, Hyst_index)) + geom_point(aes(colour=factor(site.ID), shape = pf), size = 4)+
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_hline(yintercept = 0) + geom_vline(xintercept = 0)+
geom_errorbarh(aes(xmin=FI_ymin, xmax=FI_ymax), colour="black", alpha=0.5, size=.5, height = 0.1) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5)+
ggtitle("d) Turb")+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), text = element_text(size = 20))
HI_FI_turb.p
# all together
ggplot(HI_FI_NO3, aes(Flush_index, beta)) + geom_point(aes(colour=factor(site.ID)), size = 4) +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5) +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE)
# all together
ggplot(HI_FI_fDOM, aes(Flush_index, beta)) + geom_point(aes(colour=factor(site.ID)), size = 4) +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5) +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE)
# all together
ggplot(HI_FI_SPC, aes(Flush_index, beta)) + geom_point(aes(colour=factor(site.ID)), size = 4) +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5) +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE)
ggplot(HI_FI_turb, aes(Flush_index, beta)) + geom_point(aes(colour=factor(site.ID)), size = 4) +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5) +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE)
ggplot(antecedent_HI_FI_1_0, aes(doy, TimeSinceChena)) +
geom_point() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_grid(rows = vars(year))
HI.pl <- antecedent_HI_FI_1_0  %>%
ggplot(aes(x = doy, y = Hyst_index)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_point(aes(color = site.ID)) +
scale_color_manual(values = c("orange red", viridis::viridis(6)),
labels = c("French", "Moose", "Poker", "Vault", "Stuart", "Caribou")) +
ylab("Hysteresis Index") +
ggtitle("HI") +
facet_grid(rows=vars(year), cols = vars(response_var))
HI_FI_NO3.2018.pl <- HI_FI_NO3 %>% filter(year == "2018") %>%
ggplot(aes(x = doy, y = Hyst_index)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(3)),
labels = c("French", "Moose", "Caribou")) +
ylab("Hysteresis Index") +
ggtitle("a) 2018 NO3-")
ggplot(antecedent_HI_FI_1_0, aes(doy, TimeSinceChena)) +
geom_point() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_grid(rows = vars(year))
ggplot(antecedent_HI_FI_1_0, aes(doy, Hyst_index)) +
geom_point()
ggplot(antecedent_HI_FI_1_0, aes(doy, Hyst_index)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1) +
geom_point(aes(color = site.ID))
ggplot(antecedent_HI_FI_1_0, aes(doy, Hyst_index)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1) +
geom_point(aes(color = site.ID))  +
scale_color_manual(values = c("orange red", viridis::viridis(6)),
labels = c("French", "Moose", "Poker", "Vault", "Stuart", "Caribou")) +
ylab("Hysteresis Index") +
ggtitle("HI") +
facet_grid(rows=vars(year), cols = vars(response_var))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(lubridate)
library(data.table)
library(ggplot2)
library(scales)
library(lme4)
library(nlme)
library(datasets)
library(arm)
library(AICcmodavg)
library(gridExtra)
library(grid)
library(ggpmisc)
library(boot)
library(here)
library(broom)
library(purrr)
library(viridis)
library(car)
# Read in data #
antecedent_HI_FI_1_0 <- read_csv("~/Documents/Storms/Output_from_analysis/06_HI_fire_permafrost_script/antecedent_HI_FI_1.0.csv") # read in data
antecedent_HI_FI_1_0 <- antecedent_HI_FI_1_0[,-c(1:2,14:15,17,19)] # cleaning up columns that are unnecessary
colNames <- c("Hyst_index", "HI_ymin", "HI_ymax", "site.ID", "storm.ID", "month", "day", "response_var", "Flush_index", "FI_ymin", "FI_ymax", "year", "beta", "StormPrecip", "StormTemp", "PrecipWeek", "PrecipMonth", "ThreeMonth", "TempWeek", "Duration", "Intensity", "doy", "burn", "pf", "date", "TimeSinceChena")
names(antecedent_HI_FI_1_0)<- colNames # renaming columns
# filling in holes that the automated script did not do correctly
antecedent_HI_FI_1_0[c(310:313), 20] <- 68.75
antecedent_HI_FI_1_0[c(310:313), 21] <- 0.01454545
antecedent_HI_FI_1_0[c(317:319), 20] <- 71.25
antecedent_HI_FI_1_0[c(317:319), 21] <- 0.5277193
antecedent_HI_FI_1_0[c(331:334), 20] <- 61.25
antecedent_HI_FI_1_0[c(331:334), 21] <- 0.07183673
antecedent_HI_FI_1_0[c(629:632), 20] <- 21.25
antecedent_HI_FI_1_0[c(629:632), 21] <- 0.09411765
antecedent_HI_FI_1_0[c(651:653), 20] <- 30.25
antecedent_HI_FI_1_0[c(651:653), 21] <- 0.2181818
antecedent_HI_FI_1_0[c(658:659), 20] <- 23.5
antecedent_HI_FI_1_0[c(658:659), 21] <- 0.03404255
antecedent_HI_FI_1_0[c(814:817), 20] <- 30.5
antecedent_HI_FI_1_0[c(814:817), 21] <- 0.1901639
antecedent_HI_FI_1_0[c(852:854), 20] <- 58.5
antecedent_HI_FI_1_0[c(852:854), 21] <- 0.1628205
antecedent_HI_FI_1_0[c(889:892), 20] <- 31.5
antecedent_HI_FI_1_0[c(889:892), 21] <- 0.1777778
##subsetting by solute
# NO3 #
HI_FI_NO3 = subset(antecedent_HI_FI_1_0, response_var == "NO3")
# fDOM #
HI_FI_fDOM = subset(antecedent_HI_FI_1_0, response_var == "fDOM")
# SPC #
HI_FI_SPC = subset(antecedent_HI_FI_1_0, response_var == "SPC")
# turb #
HI_FI_turb = subset(antecedent_HI_FI_1_0, response_var == "turb")
HI_FI_NO3$site.ID <- factor(HI_FI_NO3$site.ID, levels = c('FRCH','MOOS','POKE','STRT','VAUL', 'CARI'))
HI_FI_NO3.p =
ggplot(HI_FI_NO3, aes(Flush_index, Hyst_index)) + geom_point(aes(colour=factor(site.ID), shape = pf), size = 4)+
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_hline(yintercept = 0) + geom_vline(xintercept = 0)+
geom_errorbarh(aes(xmin=FI_ymin, xmax=FI_ymax), colour="black", alpha=0.5, size=.5, height = 0.1) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5)+
ggtitle("a) NO3-")+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), text = element_text(size = 20))
HI_FI_NO3.p
HI_FI_fDOM$site.ID <- factor(HI_FI_fDOM$site.ID, levels = c('FRCH','MOOS','POKE','STRT','VAUL', 'CARI'))
HI_FI_fDOM.p =
ggplot(HI_FI_fDOM, aes(Flush_index, Hyst_index)) + geom_point(aes(colour=factor(site.ID), shape = pf), size = 4)+
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_hline(yintercept = 0) + geom_vline(xintercept = 0)+
geom_errorbarh(aes(xmin=FI_ymin, xmax=FI_ymax), colour="black", alpha=0.5, size=.5, height = 0.1) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5)+
ggtitle("b) fDOM")+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), text = element_text(size = 20))
HI_FI_fDOM.p
HI_FI_SPC$site.ID <- factor(HI_FI_SPC$site.ID, levels = c('FRCH','MOOS','POKE','STRT','VAUL', 'CARI'))
HI_FI_SPC.p =
ggplot(HI_FI_SPC, aes(Flush_index, Hyst_index)) + geom_point(aes(colour=factor(site.ID), shape = pf), size = 4)+
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_hline(yintercept = 0) + geom_vline(xintercept = 0)+
geom_errorbarh(aes(xmin=FI_ymin, xmax=FI_ymax), colour="black", alpha=0.5, size=.5, height = 0.1) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5)+
ggtitle("c) SPC")+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), text = element_text(size = 20))
HI_FI_SPC.p
HI_FI_turb$site.ID <- factor(HI_FI_turb$site.ID, levels = c('FRCH','MOOS','POKE','STRT','VAUL', 'CARI'))
HI_FI_turb.p =
ggplot(HI_FI_turb, aes(Flush_index, Hyst_index)) + geom_point(aes(colour=factor(site.ID), shape = pf), size = 4)+
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_hline(yintercept = 0) + geom_vline(xintercept = 0)+
geom_errorbarh(aes(xmin=FI_ymin, xmax=FI_ymax), colour="black", alpha=0.5, size=.5, height = 0.1) +
scale_color_manual(values = c("orange red", viridis::viridis(6)), "Catchment")+theme_bw() +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5)+
ggtitle("d) Turb")+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), text = element_text(size = 20))
HI_FI_turb.p
# all together
ggplot(HI_FI_NO3, aes(Flush_index, beta)) + geom_point(aes(colour=factor(site.ID)), size = 4) +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5) +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE)
# all together
ggplot(HI_FI_fDOM, aes(Flush_index, beta)) + geom_point(aes(colour=factor(site.ID)), size = 4) +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5) +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE)
# all together
ggplot(HI_FI_SPC, aes(Flush_index, beta)) + geom_point(aes(colour=factor(site.ID)), size = 4) +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5) +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE)
ggplot(HI_FI_turb, aes(Flush_index, beta)) + geom_point(aes(colour=factor(site.ID)), size = 4) +
ylim(-1.5, 1.5) + xlim(-1.5, 1.5) +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE)
ggplot(antecedent_HI_FI_1_0, aes(doy, TimeSinceChena)) +
geom_point() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_grid(rows = vars(year))
ggplot(antecedent_HI_FI_1_0, aes(doy, Hyst_index)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1) +
geom_point(aes(color = site.ID))  +
scale_color_manual(values = c("orange red", viridis::viridis(6)),
labels = c("French", "Moose", "Poker", "Vault", "Stuart", "Caribou")) +
ylab("Hysteresis Index") +
ggtitle("HI") +
facet_grid(rows=vars(year), cols = vars(response_var))
HI_FI_NO3 %>% filter(year == "2018") %>%
ggplot(aes(x = doy, y = Hyst_index)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(3)),
labels = c("French", "Moose", "Caribou")) +
ylab("Hysteresis Index") +
ggtitle("a) 2018 NO3-")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(lubridate)
library(data.table)
library(ggplot2)
library(scales)
library(lme4)
library(nlme)
library(datasets)
library(arm)
library(AICcmodavg)
library(gridExtra)
library(grid)
library(ggpmisc)
library(boot)
library(here)
library(broom)
library(purrr)
library(viridis)
library(car)
HI_FI_NO3 %>% filter(year == "2018") %>%
ggplot(aes(x = doy, y = Hyst_index)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(3)),
labels = c("French", "Moose", "Caribou")) +
ylab("Hysteresis Index") +
ggtitle("a) 2018 NO3-")
View(HI_FI_NO3)
HI_FI_NO3 %>% filter(year == "2018")
HI_FI_NO3 %>% subset(year == "2018")
library(dplyr)
HI_FI_NO3 %>% filter(year == "2018")
HI_FI_NO3 %>% dplyr::filter(year == "2018")
HI_FI_NO3 %>% dplyr::filter(year == "2018") %>%
ggplot(aes(x = doy, y = Hyst_index)) +
geom_hline(yintercept = 0, linetype = "dotted", size = 1) +
geom_errorbar(aes(ymin=HI_ymin, ymax=HI_ymax), colour="black", alpha=0.5, size=.5, width = 0.1)+
geom_point(aes(color = site.ID), size = 2) +
scale_color_manual(values = c("orange red", viridis::viridis(3)),
labels = c("French", "Moose", "Caribou")) +
ylab("Hysteresis Index") +
ggtitle("a) 2018 NO3-")
reticulate::repl_python()
