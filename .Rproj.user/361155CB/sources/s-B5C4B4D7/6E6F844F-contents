### The purpose of this script is to read in thermistor data from the hillslope and valley bottoms of each 
# DoD site (FRCH, MOOS, POKE, VAUL, STRT)
# Step 1) read in csv from google drive "DoD Project->2021 AK sensors->Thermistor->"site"
# Step 2) convert into ak date time and plot each site 
# Step 3) upload to DoD ancillary github repo

# Load libraries #
library(readr)
library(lubridate)
library(ggplot2)
library(cowplot)
# import data # 
strt.hill.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vTFhpKHR3qV37FhV5rIZkY-cKaxPiE8UBu4xmezJ5-Fvrw-20OW1OqXQR0efxhiztB2pYHNv9_1-QvT/pub?output=csv"
strt.valley.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ9YnMFZ2jcnhI6aWyAU1s_IsskLbi9Rh0I7UjfUMoQPb2i6_PulmgJuqGEM7uMnJcjbopA3p9dyOXK/pub?output=csv"
poke.valley.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vTemH86M_4s01_l6hNESML2VaeiDYB4I6V9FBbifGcYl4L9ZeJcpWtpZca_oo9alv6y-Aij9FYaik3y/pub?output=csv"
poke.hill.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vTldXPq6Uw9wAwgNd847xzaWgc6DmJWFXmgr_AwLkqvKgJOVYpvnip4W7PM9at_8JkCypcUwaBULXha/pub?output=csv"
vaul.valley.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vTyCZl2bd9XgLRfziO1akG32c3b0TSfnH-lPqd6KuGcF_0FMe6h8qJGzYU3cJodSu74JTOX8JVcWGsT/pub?output=csv"
vaul.hill.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vTjbzfe0W02DtppkJVao4UUhhsTxRG8OMQsp3giPPWsiYW4gk-Oe9qB-_Ec82dpegdsZebl_jEPEJFV/pub?output=csv"
frch.valley.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4RlniQ_AWBQ7_y6f6R12-ZEFhgCaYbTiYnhlY4aO2Gr1g40ONPLEwdraxPp4XgRv40gIAZ5sB3_tX/pub?output=csv"
moos.valley.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vT3zwSy0oXB9IlrGUB_HpWMVMUdmKBv970C3jxnvoprqu41KSL8VkwCW7lgol_1T_-WnBlccEophH2V/pub?output=csv"
# Load data 
strt.hill <- read.csv(strt.hill.url, skip = 1, header = T)
strt.valley <- read.csv(strt.valley.url, skip = 1, header = T)
poke.hill <- read.csv(poke.hill.url, skip = 1, header = T)
poke.valley <- read.csv(poke.valley.url, skip = 1, header = T)
vaul.hill <- read.csv(vaul.hill.url, skip = 1, header = T)
vaul.valley <- read.csv(vaul.valley.url, skip = 1, header = T)
frch.valley <- read.csv(frch.valley.url, skip = 1, header = T)
moos.valley <- read.csv(moos.valley.url, skip = 1, header = T)

# Rename columns #
names(strt.valley) <- c("Site", "DateTime", "Temp50", "Temp10")
names(strt.hill) <- c("Site", "DateTime", "Temp50", "Temp10")
names(poke.valley) <- c("Site", "DateTime", "Temp50", "Temp10")
names(poke.hill) <- c("Site", "DateTime", "Temp50", "Temp10")
names(vaul.valley) <- c("Site", "DateTime", "Temp50", "Temp10")
names(vaul.hill) <- c("Site", "DateTime", "Temp50", "Temp10")
names(frch.valley) <- c("Site", "DateTime", "Temp50", "Temp10")
names(moos.valley) <- c("Site", "DateTime", "Temp50", "Temp10")

strt.valley$Site <- "StrtValley"
strt.hill$Site <- "StrtHill"
poke.valley$Site <- "PokeValley"
poke.hill$Site <- "PokeHill"
vaul.valley$Site <- "VaulValley"
vaul.hill$Site <- "VaulHill"
frch.valley$Site <- "FrchValley"
moos.valley$Site <- "MoosValley"

# Convert into AK time #
strt.valley$DateTime <- mdy_hms(strt.valley$DateTime)
attributes(strt.valley$DateTime)$tzone <- "America/Anchorage"
strt.hill$DateTime <- mdy_hms(strt.hill$DateTime)
attributes(strt.hill$DateTime)$tzone <- "America/Anchorage"

poke.valley$DateTime <- mdy_hms(poke.valley$DateTime)
attributes(poke.valley$DateTime)$tzone <- "America/Anchorage"
poke.hill$DateTime <- mdy_hms(poke.hill$DateTime)
attributes(poke.hill$DateTime)$tzone <- "America/Anchorage"

vaul.valley$DateTime <- mdy_hms(vaul.valley$DateTime)
attributes(vaul.valley$DateTime)$tzone <- "America/Anchorage"
vaul.hill$DateTime <- mdy_hms(vaul.hill$DateTime)
attributes(vaul.hill$DateTime)$tzone <- "America/Anchorage"

frch.valley$DateTime <- mdy_hms(frch.valley$DateTime)
attributes(frch.valley$DateTime)$tzone <- "America/Anchorage"

moos.valley$DateTime <- mdy_hms(moos.valley$DateTime)
attributes(moos.valley$DateTime)$tzone <- "America/Anchorage"

# clean data # 
strt.valley <- strt.valley[-c(1:3), ] # remove out of soil points 

# Plot data #
# STRT #
ggplot(strt, aes(x = DateTime, y = Temp50, col = Site)) +
  geom_line() + 
  ggtitle("Stuart Valley") +
  theme_classic()


ggplot(aes(x = DateTime, y = Temp50), data= strt) +
  geom_line(color="#A6CEE3", size=1.25) +
  geom_line(aes(x = DateTime, y = Temp10)) +
  theme_classic() +
  ggtitle("Stuart Valley") +
  scale_shape_discrete(name = "Depth (cm)", labels = c("10", "50")) +
  xlab("Date") +
  ylab("Temperature (°C)") 


sv.plot <- ggplot(strt.valley) +
  geom_line(aes(x = DateTime, y = Temp50)) +
  geom_line(aes(x = DateTime, y = Temp10)) + 
  xlab("") +
  ylab("Temperature (°C)") +
  ggtitle("Stuart Valley") +
  theme_classic()

sh.plot <- ggplot(strt.hill) +
  geom_line(aes(x = DateTime, y = Temp50)) +
  geom_line(aes(x = DateTime, y = Temp10)) + 
  xlab("") +
  ylab("") +
  ggtitle("Stuart Hill") +
  theme_classic()

# POKE # 
pv.plot <- ggplot(poke.valley) +
  geom_line(aes(x = DateTime, y = Temp50)) +
  geom_line(aes(x = DateTime, y = Temp10)) + 
  xlab("") +
  ylab("Temperature (°C)") +
  ggtitle("Poker Valley") +
  theme_classic()

ph.plot <- ggplot(poke.hill) +
  geom_line(aes(x = DateTime, y = Temp50)) +
  geom_line(aes(x = DateTime, y = Temp10)) + 
  xlab("") +
  ylab("") +
  ggtitle("Poker Hill") +
  theme_classic()

# Vaul #
vv.plot <- ggplot(vaul.valley) +
  geom_line(aes(x = DateTime, y = Temp50)) +
  geom_line(aes(x = DateTime, y = Temp10)) + 
  xlab("Date") +
  ylab("Temperature (°C)") +
  ggtitle("Vault Valley") +
  theme_classic()

vh.plot <- ggplot(vaul.hill) +
  geom_line(aes(x = DateTime, y = Temp50)) +
  geom_line(aes(x = DateTime, y = Temp10)) + 
  xlab("Date") +
  ylab("") +
  ggtitle("Vault Hill") +
  theme_classic()

# FRCH #
ggplot(frch.valley) +
  geom_line(aes(x = DateTime, y = Temp50)) +
  geom_line(aes(x = DateTime, y = Temp10)) + 
  xlab("Date") +
  ylab("Temperature (°C)") +
  ggtitle("French Valley") +
  labs(fill = "Depth (cm)")+
  scale_fill_discrete(name = "Depth (cm)", labels = c("10", "50")) +
  theme_classic()

# moos #
ggplot(moos.valley) +
  geom_line(aes(x = DateTime, y = Temp50)) +
  geom_line(aes(x = DateTime, y = Temp10)) + 
  xlab("Date") +
  ylab("Temperature (°C)") +
  ggtitle("Moose Valley") +
  labs(fill = "Depth (cm)")+
  scale_fill_discrete(name = "Depth (cm)", labels = c("10", "50")) +
  theme_classic()


# Merge data # 
strt <- rbind(strt.hill, strt.valley)
poke <- rbind(poke.hill, poke.valley)
vaul <- rbind(vaul.hill, vaul.valley)
thermistor <- rbind(strt, poke, vaul)
ggplot(strt) +
  geom_line(aes(x = DateTime, y = Temp50, col = Site)) +
  geom_point(aes(x = DateTime, y = Temp10, shape = Site)) +
  xlab("Date") +
  ylab("Temperature (°C)") +
  ggtitle("Stuart Hill") +
  theme_classic()

ggplot(poke) +
  geom_line(aes(x = DateTime, y = Temp50, col = Site)) +
  geom_point(aes(x = DateTime, y = Temp10, shape = Site)) +
  xlab("Date") +
  ylab("Temperature (°C)") +
  ggtitle("Poker") +
  theme_classic()

ggplot(vaul) +
  geom_line(aes(x = DateTime, y = Temp50, col = Site)) +
  geom_point(aes(x = DateTime, y = Temp10, shape = Site)) +
  xlab("Date") +
  ylab("Temperature (°C)") +
  ggtitle("Poker") +
  theme_classic()

ggplot(thermistor) +
  geom_line(aes(x = DateTime, y = Temp50, col = Site)) +
  xlab("Date") +
  ylab("Temperature (°C)") +
  ggtitle("Stuart Hill") +
  theme_classic()



plot_grid(sv.plot, sh.plot,
          pv.plot, ph.plot,
          vv.plot, vh.plot,
          ncol = 2,
          nrow = 3)












