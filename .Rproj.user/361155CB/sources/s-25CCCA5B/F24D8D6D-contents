#### READ ME ####
##The purpose of this script is to plot hysteresis loops from DoD sites data prior to hysteresis analysis and, specifically, the hysteresisMetrics function.##


#### libraries ####
options(tz="America/Anchorage")
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(plyr)
library(imputeTS)
library(TSA)
library(bbmle)
library(zoo)
library(xts)
library(forecast)
library(stats)
library(lattice)
library(nlme)
library(geosphere)
library(car)
library(EcoHydRology)
library(dplyr)
############################################ 2018 ################################################
# plot on normalized scale # 
#### load data #####
STRT_storm1a_06_19 <- read.csv("Storms/STRT_storm1a_06_19.csv")
STRT_storm1a_06_19_Q <- read.csv("Storms/STRT_storm1a_06_19_Q.csv")
STRT_storm1a_06_19_NO3 <- read.csv("Storms/STRT_storm1a_06_19_NO3.csv")
STRT_storm1a_06_19_fDOM <- read.csv("Storms/STRT_storm1a_06_19_fDOM.csv")

STRT_storm1b_06_20 <- read.csv("Storms/STRT_storm1b_06_20.csv")
STRT_storm1b_06_20_Q <- read.csv("Storms/STRT_storm1b_06_20_Q.csv")
STRT_storm1b_06_20_NO3 <- read.csv("Storms/STRT_storm1b_06_20_NO3.csv")
STRT_storm1b_06_20_fDOM <- read.csv("Storms/STRT_storm1b_06_20_fDOM.csv")

STRT_storm1c_06_22 <- read.csv("Storms/STRT_storm1c_06_22.csv")
STRT_storm1c_06_22_Q <- read.csv("Storms/STRT_storm1c_06_22_Q.csv")
STRT_storm1c_06_22_NO3 <- read.csv("Storms/STRT_storm1c_06_22_NO3.csv")
STRT_storm1c_06_22_fDOM <- read.csv("Storms/STRT_storm1c_06_22_fDOM.csv")

STRT_storm1d_06_23 <- read.csv("Storms/STRT_storm1d_06_23.csv")
STRT_storm1d_06_23_Q <- read.csv("Storms/STRT_storm1d_06_23_Q.csv")
STRT_storm1d_06_23_NO3 <- read.csv("Storms/STRT_storm1d_06_23_NO3.csv")
STRT_storm1d_06_23_fDOM <- read.csv("Storms/STRT_storm1d_06_23_fDOM.csv")

STRT_storm1e_06_24 <- read.csv("Storms/STRT_storm1e_06_24.csv")
STRT_storm1e_06_24_Q <- read.csv("Storms/STRT_storm1e_06_24_Q.csv")
STRT_storm1e_06_24_NO3 <- read.csv("Storms/STRT_storm1e_06_24_NO3.csv")
STRT_storm1e_06_24_fDOM <- read.csv("Storms/STRT_storm1e_06_24_fDOM.csv")

STRT_storm2_07_09 <- read.csv("Storms/STRT_storm2_07_09.csv")
STRT_storm2_07_09_Q <- read.csv("Storms/STRT_storm2_07_09_Q.csv")
STRT_storm2_07_09_NO3 <- read.csv("Storms/STRT_storm2_07_09_NO3.csv")
STRT_storm2_07_09_fDOM <- read.csv("Storms/STRT_storm2_07_09_fDOM.csv")

STRT_storm3_07_21 <- read.csv("Storms/STRT_storm3_07_21.csv")
STRT_storm3_07_21_Q <- read.csv("Storms/STRT_storm3_07_21_Q.csv")
STRT_storm3_07_21_NO3 <- read.csv("Storms/STRT_storm3_07_21_NO3.csv")
STRT_storm3_07_21_fDOM <- read.csv("Storms/STRT_storm3_07_21_fDOM.csv")

STRT_storm4a_08_01 <- read.csv("Storms/STRT_storm4a_08_01.csv")
STRT_storm4a_08_01_Q <- read.csv("Storms/STRT_storm4a_08_01_Q.csv")
STRT_storm4a_08_01_NO3 <- read.csv("Storms/STRT_storm4a_08_01_NO3.csv")
STRT_storm4a_08_01_fDOM <- read.csv("Storms/STRT_storm4a_08_01_fDOM.csv")

STRT_storm4b_08_03 <- read.csv("Storms/STRT_storm4b_08_03.csv")
STRT_storm4b_08_03_Q <- read.csv("Storms/STRT_storm4b_08_03_Q.csv")
STRT_storm4b_08_03_NO3 <- read.csv("Storms/STRT_storm4b_08_03_NO3.csv")
STRT_storm4b_08_03_fDOM <- read.csv("Storms/STRT_storm4b_08_03_fDOM.csv")

STRT_storm5_08_09 <- read.csv("Storms/STRT_storm5_08_09.csv")
STRT_storm5_08_09_Q <- read.csv("Storms/STRT_storm5_08_09_Q.csv")
STRT_storm5_08_09_NO3 <- read.csv("Storms/STRT_storm5_08_09_NO3.csv")
STRT_storm5_08_09_fDOM <- read.csv("Storms/STRT_storm5_08_09_fDOM.csv")

STRT_storm6_08_12 <- read.csv("Storms/STRT_storm6_08_12.csv")
STRT_storm6_08_12_Q <- read.csv("Storms/STRT_storm6_08_12_Q.csv")
STRT_storm6_08_12_NO3 <- read.csv("Storms/STRT_storm6_08_12_NO3.csv")
STRT_storm6_08_12_fDOM <- read.csv("Storms/STRT_storm6_08_12_fDOM.csv")

STRT_storm7a_08_20 <- read.csv("Storms/STRT_storm7a_08_20.csv")
STRT_storm7a_08_20_Q <- read.csv("Storms/STRT_storm7a_08_20_Q.csv")
STRT_storm7a_08_20_NO3 <- read.csv("Storms/STRT_storm7a_08_20_NO3.csv")
STRT_storm7a_08_20_fDOM <- read.csv("Storms/STRT_storm7a_08_20_fDOM.csv")

STRT_storm7b_08_21 <- read.csv("Storms/STRT_storm7b_08_21.csv")
STRT_storm7b_08_21_Q <- read.csv("Storms/STRT_storm7b_08_21_Q.csv",)
STRT_storm7b_08_21_NO3 <- read.csv("Storms/STRT_storm7b_08_21_NO3.csv")
STRT_storm7b_08_21_fDOM <- read.csv("Storms/STRT_storm7b_08_21_fDOM.csv")

STRT_storm8_08_28 <- read.csv("Storms/STRT_storm8_08_28.csv")
STRT_storm8_08_28_Q <- read.csv("Storms/STRT_storm8_08_28_Q.csv")
STRT_storm8_08_28_NO3 <- read.csv("Storms/STRT_storm8_08_28_NO3.csv")
STRT_storm8_08_28_fDOM <- read.csv("Storms/STRT_storm8_08_28_fDOM.csv")

STRT_storm9a_09_03 <- read.csv("Storms/STRT_storm9a_09_03.csv")
STRT_storm9a_09_03_Q <- read.csv("Storms/STRT_storm9a_09_03_Q.csv")
STRT_storm9a_09_03_NO3 <- read.csv("Storms/STRT_storm9a_09_03_NO3.csv")
STRT_storm9a_09_03_fDOM <- read.csv("Storms/STRT_storm9a_09_03_fDOM.csv")

STRT_storm9b_09_06 <- read.csv("Storms/STRT_storm9b_09_06.csv")
STRT_storm9b_09_06_Q <- read.csv("Storms/STRT_storm9b_09_06_Q.csv")
STRT_storm9b_09_06_NO3 <- read.csv("Storms/STRT_storm9b_09_06_NO3.csv")
STRT_storm9b_09_06_fDOM <- read.csv("Storms/STRT_storm9b_09_06_fDOM.csv")

STRT_storm9c_09_09 <- read.csv("Storms/STRT_storm9c_09_09.csv")
STRT_storm9c_09_09_Q <- read.csv("Storms/STRT_storm9c_09_09_Q.csv")
STRT_storm9c_09_09_NO3 <- read.csv("Storms/STRT_storm9c_09_09_NO3.csv")
STRT_storm9c_09_09_fDOM <- read.csv("Storms/STRT_storm9c_09_09_fDOM.csv")

STRT_storm10_09_23 <- read.csv("Storms/STRT_storm10_09_23.csv")
STRT_storm10_09_23_Q <- read.csv("Storms/STRT_storm10_09_23_Q.csv")
STRT_storm10_09_23_NO3 <- read.csv("Storms/STRT_storm10_09_23_NO3.csv")
STRT_storm10_09_23_fDOM <- read.csv("Storms/STRT_storm10_09_23_fDOM.csv")

# MOOS #
MOOS_storm1_06_21 <- read.csv("Storms/MOOS_storm1_06_21.csv", row.names = 1)
MOOS_storm1_06_21_Q <- read.csv("Storms/MOOS_storm1_06_21_Q.csv", row.names = 1)
MOOS_storm1_06_21_NO3 <- read.csv("Storms/MOOS_storm1_06_21_NO3.csv", row.names = 1)
MOOS_storm1_06_21_fDOM <- read.csv("Storms/MOOS_storm1_06_21_fDOM.csv", row.names = 1)

MOOS_storm2_06_28 <- read.csv("Storms/MOOS_storm2_06_28.csv", row.names = 1)
MOOS_storm2_06_28_Q <- read.csv("Storms/MOOS_storm2_06_28_Q.csv", row.names = 1)
MOOS_storm2_06_28_NO3 <- read.csv("Storms/MOOS_storm2_06_28_NO3.csv", row.names = 1)
MOOS_storm2_06_28_fDOM <- read.csv("Storms/MOOS_storm2_06_28_fDOM.csv", row.names = 1)

MOOS_storm3_07_18 <- read.csv("Storms/MOOS_storm3_07_18.csv", row.names = 1)
MOOS_storm3_07_18_Q <- read.csv("Storms/MOOS_storm3_07_18_Q.csv", row.names = 1)
MOOS_storm3_07_18_NO3 <- read.csv("Storms/MOOS_storm3_07_18_NO3.csv", row.names = 1)
MOOS_storm3_07_18_fDOM <- read.csv("Storms/MOOS_storm3_07_18_fDOM.csv", row.names = 1)

MOOS_storm4_07_20 <- read.csv("Storms/MOOS_storm4_07_20.csv", row.names = 1)
MOOS_storm4_07_20_Q <- read.csv("Storms/MOOS_storm4_07_20_Q.csv", row.names = 1)
MOOS_storm4_07_20_NO3 <- read.csv("Storms/MOOS_storm4_07_20_NO3.csv", row.names = 1)
MOOS_storm4_07_20_fDOM <- read.csv("Storms/MOOS_storm4_07_20_fDOM.csv", row.names = 1)

MOOS_storm5_07_27 <- read.csv("Storms/MOOS_storm5_07_27.csv", row.names = 1)
MOOS_storm5_07_27_Q <- read.csv("Storms/MOOS_storm5_07_27_Q.csv", row.names = 1)
MOOS_storm5_07_27_NO3 <- read.csv("Storms/MOOS_storm5_07_27_NO3.csv", row.names = 1)
MOOS_storm5_07_27_fDOM <- read.csv("Storms/MOOS_storm5_07_27_fDOM.csv", row.names = 1)

MOOS_storm6a_08_01 <- read.csv("Storms/MOOS_storm6a_08_01.csv", row.names = 1)
MOOS_storm6a_08_01_Q <- read.csv("Storms/MOOS_storm6a_08_01_Q.csv", row.names = 1)
MOOS_storm6a_08_01_NO3 <- read.csv("Storms/MOOS_storm6a_08_01_NO3.csv", row.names = 1)
MOOS_storm6a_08_01_fDOM <- read.csv("Storms/MOOS_storm6a_08_01_fDOM.csv", row.names = 1)

MOOS_storm6b_08_03 <- read.csv("Storms/MOOS_storm6b_08_03.csv", row.names = 1)
MOOS_storm6b_08_03_Q <- read.csv("Storms/MOOS_storm6b_08_03_Q.csv", row.names = 1)
MOOS_storm6b_08_03_NO3 <- read.csv("Storms/MOOS_storm6b_08_03_NO3.csv", row.names = 1)
MOOS_storm6b_08_03_fDOM <- read.csv("Storms/MOOS_storm6b_08_03_fDOM.csv", row.names = 1)

MOOS_storm7a_08_09 <- read.csv("Storms/MOOS_storm7a_08_09.csv", row.names = 1)
MOOS_storm7a_08_09_Q <- read.csv("Storms/MOOS_storm7a_08_09_Q.csv", row.names = 1)
MOOS_storm7a_08_09_NO3 <- read.csv("Storms/MOOS_storm7a_08_09_NO3.csv", row.names = 1)
MOOS_storm7a_08_09_fDOM <- read.csv("Storms/MOOS_storm7a_08_09_fDOM.csv", row.names = 1)

MOOS_storm7b_08_12 <- read.csv("Storms/MOOS_storm7b_08_12.csv", row.names = 1)
MOOS_storm7b_08_12_Q <- read.csv("Storms/MOOS_storm7b_08_12_Q.csv", row.names = 1)
MOOS_storm7b_08_12_NO3 <- read.csv("Storms/MOOS_storm7b_08_12_NO3.csv", row.names = 1)
MOOS_storm7b_08_12_fDOM <- read.csv("Storms/MOOS_storm7b_08_12_fDOM.csv", row.names = 1)

MOOS_storm8_09_03 <- read.csv("Storms/MOOS_storm8_09_03.csv", row.names = 1)
MOOS_storm8_09_03_Q <- read.csv("Storms/MOOS_storm8_09_03_Q.csv", row.names = 1)
MOOS_storm8_09_03_NO3 <- read.csv("Storms/MOOS_storm8_09_03_NO3.csv", row.names = 1)
MOOS_storm8_09_03_fDOM <- read.csv("Storms/MOOS_storm8_09_03_fDOM.csv", row.names = 1)

MOOS_storm9_09_09 <- read.csv("Storms/MOOS_storm9_09_09.csv", row.names = 1)
MOOS_storm9_09_09_Q <- read.csv("Storms/MOOS_storm9_09_09_Q.csv", row.names = 1)
MOOS_storm9_09_09_NO3 <- read.csv("Storms/MOOS_storm9_09_09_NO3.csv", row.names = 1)
MOOS_storm9_09_09_fDOM <- read.csv("Storms/MOOS_storm9_09_09_fDOM.csv", row.names = 1)

# FRCH #
FRCH_storm1_06_13 <- read.csv("Storms/FRCH_storm1_06_13.csv", row.names = 1)
FRCH_storm1_06_13_Q <- read.csv("Storms/FRCH_storm1_06_13_Q.csv", row.names = 1)
FRCH_storm1_06_13_NO3 <- read.csv("Storms/FRCH_storm1_06_13_NO3.csv", row.names = 1)
FRCH_storm1_06_13_fDOM <- read.csv("Storms/FRCH_storm1_06_13_fDOM.csv", row.names = 1)

FRCH_storm2_06_19 <- read.csv("Storms/FRCH_storm2_06_19.csv", row.names = 1)
FRCH_storm2_06_19_Q <- read.csv("Storms/FRCH_storm2_06_19_Q.csv", row.names = 1)
FRCH_storm2_06_19_NO3 <- read.csv("Storms/FRCH_storm2_06_19_NO3.csv", row.names = 1)
FRCH_storm2_06_19_fDOM <- read.csv("Storms/FRCH_storm2_06_19_fDOM.csv", row.names = 1)

FRCH_storm3a_06_20 <- read.csv("Storms/FRCH_storm3a_06_20.csv", row.names = 1)
FRCH_storm3a_06_20_Q <- read.csv("Storms/FRCH_storm3a_06_20_Q.csv", row.names = 1)
FRCH_storm3a_06_20_NO3 <- read.csv("Storms/FRCH_storm3a_06_20_NO3.csv", row.names = 1)
FRCH_storm3a_06_20_fDOM <- read.csv("Storms/FRCH_storm3a_06_20_fDOM.csv", row.names = 1)

FRCH_storm3b_06_22 <- read.csv("Storms/FRCH_storm3b_06_22.csv", row.names = 1)
FRCH_storm3b_06_22_Q <- read.csv("Storms/FRCH_storm3b_06_22_Q.csv", row.names = 1)
FRCH_storm3b_06_22_NO3 <- read.csv("Storms/FRCH_storm3b_06_22_NO3.csv", row.names = 1)
FRCH_storm3b_06_22_fDOM <- read.csv("Storms/FRCH_storm3b_06_22_fDOM.csv", row.names = 1)

FRCH_storm3c_06_28 <- read.csv("Storms/FRCH_storm3c_06_28.csv", row.names = 1)
FRCH_storm3c_06_28_Q <- read.csv("Storms/FRCH_storm3c_06_28_Q.csv", row.names = 1)
FRCH_storm3c_06_28_NO3 <- read.csv("Storms/FRCH_storm3c_06_28_NO3.csv", row.names = 1)
FRCH_storm3c_06_28_fDOM <- read.csv("Storms/FRCH_storm3c_06_28_fDOM.csv", row.names = 1)

FRCH_storm4a_07_07 <- read.csv("Storms/FRCH_storm4a_07_07.csv", row.names = 1)
FRCH_storm4a_07_07_Q <- read.csv("Storms/FRCH_storm4a_07_07_Q.csv", row.names = 1)
FRCH_storm4a_07_07_NO3 <- read.csv("Storms/FRCH_storm4a_07_07_NO3.csv", row.names = 1)
FRCH_storm4a_07_07_fDOM <- read.csv("Storms/FRCH_storm4a_07_07_fDOM.csv", row.names = 1)

FRCH_storm4b_07_09 <- read.csv("Storms/FRCH_storm4b_07_09.csv", row.names = 1)
FRCH_storm4b_07_09_Q <- read.csv("Storms/FRCH_storm4b_07_09_Q.csv", row.names = 1)
FRCH_storm4b_07_09_NO3 <- read.csv("Storms/FRCH_storm4b_07_09_NO3.csv", row.names = 1)
FRCH_storm4b_07_09_fDOM <- read.csv("Storms/FRCH_storm4b_07_09_fDOM.csv", row.names = 1)

FRCH_storm5_07_16 <- read.csv("Storms/FRCH_storm5_07_16.csv", row.names = 1)
FRCH_storm5_07_16_Q <- read.csv("Storms/FRCH_storm5_07_16_Q.csv", row.names = 1)
FRCH_storm5_07_16_NO3 <- read.csv("Storms/FRCH_storm5_07_16_NO3.csv", row.names = 1)
FRCH_storm5_07_16_fDOM <- read.csv("Storms/FRCH_storm5_07_16_fDOM.csv", row.names = 1)

FRCH_storm6_07_17 <- read.csv("Storms/FRCH_storm6_07_17.csv", row.names = 1)
FRCH_storm6_07_17_Q <- read.csv("Storms/FRCH_storm6_07_17_Q.csv", row.names = 1)
FRCH_storm6_07_17_NO3 <- read.csv("Storms/FRCH_storm6_07_17_NO3.csv", row.names = 1)
FRCH_storm6_07_17_fDOM <- read.csv("Storms/FRCH_storm6_07_17_fDOM.csv", row.names = 1)

FRCH_storm7_07_20 <- read.csv("Storms/FRCH_storm7_07_20.csv", row.names = 1)
FRCH_storm7_07_20_Q <- read.csv("Storms/FRCH_storm7_07_20_Q.csv", row.names = 1)
FRCH_storm7_07_20_NO3 <- read.csv("Storms/FRCH_storm7_07_20_NO3.csv", row.names = 1)
FRCH_storm7_07_20_fDOM <- read.csv("Storms/FRCH_storm7_07_20_fDOM.csv", row.names = 1)

FRCH_storm8_07_26 <- read.csv("Storms/FRCH_storm8_07_26.csv", row.names = 1)
FRCH_storm8_07_26_Q <- read.csv("Storms/FRCH_storm8_07_26_Q.csv", row.names = 1)
FRCH_storm8_07_26_NO3 <- read.csv("Storms/FRCH_storm8_07_26_NO3.csv", row.names = 1)
FRCH_storm8_07_26_fDOM <- read.csv("Storms/FRCH_storm8_07_26_fDOM.csv", row.names = 1)

FRCH_storm9a_08_01 <- read.csv("Storms/FRCH_storm9a_08_01.csv", row.names = 1)
FRCH_storm9a_08_01_Q <- read.csv("Storms/FRCH_storm9a_08_01_Q.csv", row.names = 1)
FRCH_storm9a_08_01_NO3 <- read.csv("Storms/FRCH_storm9a_08_01_NO3.csv", row.names = 1)
FRCH_storm9a_08_01_fDOM <- read.csv("Storms/FRCH_storm9a_08_01_fDOM.csv", row.names = 1)

FRCH_storm9b_08_02 <- read.csv("Storms/FRCH_storm9b_08_02.csv", row.names = 1)
FRCH_storm9b_08_02_Q <- read.csv("Storms/FRCH_storm9b_08_02_Q.csv", row.names = 1)
FRCH_storm9b_08_02_NO3 <- read.csv("Storms/FRCH_storm9b_08_02_NO3.csv", row.names = 1)
FRCH_storm9b_08_02_fDOM <- read.csv("Storms/FRCH_storm9b_08_02_fDOM.csv", row.names = 1)

# VAUL # 
VAUL_storm1a_06_19 <- read.csv("Storms/VAUL_storm1a_06_19.csv", row.names = 1)
VAUL_storm1a_06_19_Q <- read.csv("Storms/VAUL_storm1a_06_19_Q.csv", row.names = 1)
VAUL_storm1a_06_19_NO3 <- read.csv("Storms/VAUL_storm1a_06_19_NO3.csv", row.names = 1)
VAUL_storm1a_06_19_fDOM <- read.csv("Storms/VAUL_storm1a_06_19_fDOM.csv", row.names = 1)

VAUL_storm1b_06_20 <- read.csv("Storms/VAUL_storm1b_06_20.csv", row.names = 1)
VAUL_storm1b_06_20_Q <- read.csv("Storms/VAUL_storm1b_06_20_Q.csv", row.names = 1)
VAUL_storm1b_06_20_NO3 <- read.csv("Storms/VAUL_storm1b_06_20_NO3.csv", row.names = 1)
VAUL_storm1b_06_20_fDOM <- read.csv("Storms/VAUL_storm1b_06_20_fDOM.csv", row.names = 1)

VAUL_storm1c_06_22 <- read.csv("Storms/VAUL_storm1c_06_22.csv", row.names = 1)
VAUL_storm1c_06_22_Q <- read.csv("Storms/VAUL_storm1c_06_22_Q.csv", row.names = 1)
VAUL_storm1c_06_22_NO3 <- read.csv("Storms/VAUL_storm1c_06_22_NO3.csv", row.names = 1)
VAUL_storm1c_06_22_fDOM <- read.csv("Storms/VAUL_storm1c_06_22_fDOM.csv", row.names = 1)

VAUL_storm2_06_28 <- read.csv("Storms/VAUL_storm2_06_28.csv", row.names = 1)
VAUL_storm2_06_28_Q <- read.csv("Storms/VAUL_storm2_06_28_Q.csv", row.names = 1)
VAUL_storm2_06_28_NO3 <- read.csv("Storms/VAUL_storm2_06_28_NO3.csv", row.names = 1)
VAUL_storm2_06_28_fDOM <- read.csv("Storms/VAUL_storm2_06_28_fDOM.csv", row.names = 1)

VAUL_storm3_07_09 <- read.csv("Storms/VAUL_storm3_07_09.csv", row.names = 1)
VAUL_storm3_07_09_Q <- read.csv("Storms/VAUL_storm3_07_09_Q.csv", row.names = 1)
VAUL_storm3_07_09_NO3 <- read.csv("Storms/VAUL_storm3_07_09_NO3.csv", row.names = 1)
VAUL_storm3_07_09_fDOM <- read.csv("Storms/VAUL_storm3_07_09_fDOM.csv", row.names = 1)

VAUL_storm4_07_12 <- read.csv("Storms/VAUL_storm4_07_12.csv", row.names = 1)
VAUL_storm4_07_12_Q <- read.csv("Storms/VAUL_storm4_07_12_Q.csv", row.names = 1)
VAUL_storm4_07_12_NO3 <- read.csv("Storms/VAUL_storm4_07_12_NO3.csv", row.names = 1)
VAUL_storm4_07_12_fDOM <- read.csv("Storms/VAUL_storm4_07_12_fDOM.csv", row.names = 1)

VAUL_storm5_07_27 <- read.csv("Storms/VAUL_storm5_07_27.csv", row.names = 1)
VAUL_storm5_07_27_Q <- read.csv("Storms/VAUL_storm5_07_27_Q.csv", row.names = 1)
VAUL_storm5_07_27_NO3 <- read.csv("Storms/VAUL_storm5_07_27_NO3.csv", row.names = 1)
VAUL_storm5_07_27_fDOM <- read.csv("Storms/VAUL_storm5_07_27_fDOM.csv", row.names = 1)

VAUL_storm6a_08_01 <- read.csv("Storms/VAUL_storm6a_08_01.csv", row.names = 1)
VAUL_storm6a_08_01_Q <- read.csv("Storms/VAUL_storm6a_08_01_Q.csv", row.names = 1)
VAUL_storm6a_08_01_NO3 <- read.csv("Storms/VAUL_storm6a_08_01_NO3.csv", row.names = 1)
VAUL_storm6a_08_01_fDOM <- read.csv("Storms/VAUL_storm6a_08_01_fDOM.csv", row.names = 1)

VAUL_storm6b_08_02 <- read.csv("Storms/VAUL_storm6b_08_02.csv", row.names = 1)
VAUL_storm6b_08_02_Q <- read.csv("Storms/VAUL_storm6b_08_02_Q.csv", row.names = 1)
VAUL_storm6b_08_02_NO3 <- read.csv("Storms/VAUL_storm6b_08_02_NO3.csv", row.names = 1)
VAUL_storm6b_08_02_fDOM <- read.csv("Storms/VAUL_storm6b_08_02_fDOM.csv", row.names = 1)

VAUL_storm7_08_08 <- read.csv("Storms/VAUL_storm7_08_08.csv", row.names = 1)
VAUL_storm7_08_08_Q <- read.csv("Storms/VAUL_storm7_08_08_Q.csv", row.names = 1)
VAUL_storm7_08_08_NO3 <- read.csv("Storms/VAUL_storm7_08_08_NO3.csv", row.names = 1)
VAUL_storm7_08_08_fDOM <- read.csv("Storms/VAUL_storm7_08_08_fDOM.csv", row.names = 1)

VAUL_storm8_08_11 <- read.csv("Storms/VAUL_storm8_08_11.csv", row.names = 1)
VAUL_storm8_08_11_Q <- read.csv("Storms/VAUL_storm8_08_11_Q.csv", row.names = 1)
VAUL_storm8_08_11_NO3 <- read.csv("Storms/VAUL_storm8_08_11_NO3.csv", row.names = 1)
VAUL_storm8_08_11_fDOM <- read.csv("Storms/VAUL_storm8_08_11_fDOM.csv", row.names = 1)

VAUL_storm9_08_12 <- read.csv("Storms/VAUL_storm9_08_12.csv", row.names = 1)
VAUL_storm9_08_12_Q <- read.csv("Storms/VAUL_storm9_08_12_Q.csv", row.names = 1)
VAUL_storm9_08_12_NO3 <- read.csv("Storms/VAUL_storm9_08_12_NO3.csv", row.names = 1)
VAUL_storm9_08_12_fDOM <- read.csv("Storms/VAUL_storm9_08_12_fDOM.csv", row.names = 1)

VAUL_storm10_08_25 <- read.csv("Storms/VAUL_storm10_08_25.csv", row.names = 1)
VAUL_storm10_08_25_Q <- read.csv("Storms/VAUL_storm10_08_25_Q.csv", row.names = 1)
VAUL_storm10_08_25_NO3 <- read.csv("Storms/VAUL_storm10_08_25_NO3.csv", row.names = 1)
VAUL_storm10_08_25_fDOM <- read.csv("Storms/VAUL_storm10_08_25_fDOM.csv", row.names = 1)

VAUL_storm11_08_27 <- read.csv("Storms/VAUL_storm11_08_27.csv", row.names = 1)
VAUL_storm11_08_27_Q <- read.csv("Storms/VAUL_storm11_08_27_Q.csv", row.names = 1)
VAUL_storm11_08_27_NO3 <- read.csv("Storms/VAUL_storm11_08_27_NO3.csv", row.names = 1)
VAUL_storm11_08_27_fDOM <- read.csv("Storms/VAUL_storm11_08_27_fDOM.csv", row.names = 1)

VAUL_storm12_09_01 <- read.csv("Storms/VAUL_storm12_09_01.csv", row.names = 1)
VAUL_storm12_09_01_Q <- read.csv("Storms/VAUL_storm12_09_01_Q.csv", row.names = 1)
VAUL_storm12_09_01_NO3 <- read.csv("Storms/VAUL_storm12_09_01_NO3.csv", row.names = 1)
VAUL_storm12_09_01_fDOM <- read.csv("Storms/VAUL_storm12_09_01_fDOM.csv", row.names = 1)

VAUL_storm13_09_03 <- read.csv("Storms/VAUL_storm13_09_03.csv", row.names = 1)
VAUL_storm13_09_03_Q <- read.csv("Storms/VAUL_storm13_09_03_Q.csv", row.names = 1)
VAUL_storm13_09_03_NO3 <- read.csv("Storms/VAUL_storm13_09_03_NO3.csv", row.names = 1)
VAUL_storm13_09_03_fDOM <- read.csv("Storms/VAUL_storm13_09_03_fDOM.csv", row.names = 1)

VAUL_storm14_09_06 <- read.csv("Storms/VAUL_storm14_09_06.csv", row.names = 1)
VAUL_storm14_09_06_Q <- read.csv("Storms/VAUL_storm14_09_06_Q.csv", row.names = 1)
VAUL_storm14_09_06_NO3 <- read.csv("Storms/VAUL_storm14_09_06_NO3.csv", row.names = 1)
VAUL_storm14_09_06_fDOM <- read.csv("Storms/VAUL_storm14_09_06_fDOM.csv", row.names = 1)

POKE_storm1_06_09 <- read.csv("Storms/POKE_storm1_06_09.csv", row.names = 1)
POKE_storm1_06_09_Q <- read.csv("Storms/POKE_storm1_06_09_Q.csv", row.names = 1)
POKE_storm1_06_09_NO3 <- read.csv("Storms/POKE_storm1_06_09_NO3.csv", row.names = 1)
POKE_storm1_06_09_fDOM <- read.csv("Storms/POKE_storm1_06_09_fDOM.csv", row.names = 1)

POKE_storm2_06_12 <- read.csv("Storms/POKE_storm2_06_12.csv", row.names = 1)
POKE_storm2_06_12_Q <- read.csv("Storms/POKE_storm2_06_12_Q.csv", row.names = 1)
POKE_storm2_06_12_NO3 <- read.csv("Storms/POKE_storm2_06_12_NO3.csv", row.names = 1)
POKE_storm2_06_12_fDOM <- read.csv("Storms/POKE_storm2_06_12_fDOM.csv", row.names = 1)

POKE_storm3_06_15 <- read.csv("Storms/POKE_storm3_06_15.csv", row.names = 1)
POKE_storm3_06_15_Q <- read.csv("Storms/POKE_storm3_06_15_Q.csv", row.names = 1)
POKE_storm3_06_15_NO3 <- read.csv("Storms/POKE_storm3_06_15_NO3.csv", row.names = 1)
POKE_storm3_06_15_fDOM <- read.csv("Storms/POKE_storm3_06_15_fDOM.csv", row.names = 1)

POKE_storm4a_06_19 <- read.csv("Storms/POKE_storm4a_06_19.csv", row.names = 1)
POKE_storm4a_06_19_Q <- read.csv("Storms/POKE_storm4a_06_19_Q.csv", row.names = 1)
POKE_storm4a_06_19_NO3 <- read.csv("Storms/POKE_storm4a_06_19_NO3.csv", row.names = 1)
POKE_storm4a_06_19_fDOM <- read.csv("Storms/POKE_storm4a_06_19_fDOM.csv", row.names = 1)

POKE_storm4b_06_20 <- read.csv("Storms/POKE_storm4b_06_20.csv", row.names = 1)
POKE_storm4b_06_20_Q <- read.csv("Storms/POKE_storm4b_06_20_Q.csv", row.names = 1)
POKE_storm4b_06_20_NO3 <- read.csv("Storms/POKE_storm4b_06_20_NO3.csv", row.names = 1)
POKE_storm4b_06_20_fDOM <- read.csv("Storms/POKE_storm4b_06_20_fDOM.csv", row.names = 1)

POKE_storm4c_06_21 <- read.csv("Storms/POKE_storm4c_06_21.csv", row.names = 1)
POKE_storm4c_06_21_Q <- read.csv("Storms/POKE_storm4c_06_21_Q.csv", row.names = 1)
POKE_storm4c_06_21_NO3 <- read.csv("Storms/POKE_storm4c_06_21_NO3.csv", row.names = 1)
POKE_storm4c_06_21_fDOM <- read.csv("Storms/POKE_storm4c_06_21_fDOM.csv", row.names = 1)

POKE_storm5_06_22 <- read.csv("Storms/POKE_storm5_06_22.csv", row.names = 1)
POKE_storm5_06_22_Q <- read.csv("Storms/POKE_storm5_06_22_Q.csv", row.names = 1)
POKE_storm5_06_22_NO3 <- read.csv("Storms/POKE_storm5_06_22_NO3.csv", row.names = 1)
POKE_storm5_06_22_fDOM <- read.csv("Storms/POKE_storm5_06_22_fDOM.csv", row.names = 1)

POKE_storm6_06_29 <- read.csv("Storms/POKE_storm6_06_29.csv", row.names = 1)
POKE_storm6_06_29_Q <- read.csv("Storms/POKE_storm6_06_29_Q.csv", row.names = 1)
POKE_storm6_06_29_NO3 <- read.csv("Storms/POKE_storm6_06_29_NO3.csv", row.names = 1)
POKE_storm6_06_29_fDOM <- read.csv("Storms/POKE_storm6_06_29_fDOM.csv", row.names = 1)

POKE_storm7_07_04 <- read.csv("Storms/POKE_storm7_07_04.csv", row.names = 1)
POKE_storm7_07_04_Q <- read.csv("Storms/POKE_storm7_07_04_Q.csv", row.names = 1)
POKE_storm7_07_04_NO3 <- read.csv("Storms/POKE_storm7_07_04_NO3.csv", row.names = 1)
POKE_storm7_07_04_fDOM <- read.csv("Storms/POKE_storm7_07_04_fDOM.csv", row.names = 1)

POKE_storm8_07_09 <- read.csv("Storms/POKE_storm8_07_09.csv", row.names = 1)
POKE_storm8_07_09_Q <- read.csv("Storms/POKE_storm8_07_09_Q.csv", row.names = 1)
POKE_storm8_07_09_NO3 <- read.csv("Storms/POKE_storm8_07_09_NO3.csv", row.names = 1)
POKE_storm8_07_09_fDOM <- read.csv("Storms/POKE_storm8_07_09_fDOM.csv", row.names = 1)

POKE_storm9_07_12 <- read.csv("Storms/POKE_storm9_07_12.csv", row.names = 1)
POKE_storm9_07_12_Q <- read.csv("Storms/POKE_storm9_07_12_Q.csv", row.names = 1)
POKE_storm9_07_12_NO3 <- read.csv("Storms/POKE_storm9_07_12_NO3.csv", row.names = 1)
POKE_storm9_07_12_fDOM <- read.csv("Storms/POKE_storm9_07_12_fDOM.csv", row.names = 1)

POKE_storm10_07_16 <- read.csv("Storms/POKE_storm10_07_16.csv", row.names = 1)
POKE_storm10_07_16_Q <- read.csv("Storms/POKE_storm10_07_16_Q.csv", row.names = 1)
POKE_storm10_07_16_NO3 <- read.csv("Storms/POKE_storm10_07_16_NO3.csv", row.names = 1)
POKE_storm10_07_16_fDOM <- read.csv("Storms/POKE_storm10_07_16_fDOM.csv", row.names = 1)

POKE_storm11_07_18 <- read.csv("Storms/POKE_storm11_07_18.csv", row.names = 1)
POKE_storm11_07_18_Q <- read.csv("Storms/POKE_storm11_07_18_Q.csv", row.names = 1)
POKE_storm11_07_18_NO3 <- read.csv("Storms/POKE_storm11_07_18_NO3.csv", row.names = 1)
POKE_storm11_07_18_fDOM <- read.csv("Storms/POKE_storm11_07_18_fDOM.csv", row.names = 1)

POKE_storm12_07_20 <- read.csv("Storms/POKE_storm12_07_20.csv", row.names = 1)
POKE_storm12_07_20_Q <- read.csv("Storms/POKE_storm12_07_20_Q.csv", row.names = 1)
POKE_storm12_07_20_NO3 <- read.csv("Storms/POKE_storm12_07_20_NO3.csv", row.names = 1)
POKE_storm12_07_20_fDOM <- read.csv("Storms/POKE_storm12_07_20_fDOM.csv", row.names = 1)

POKE_storm13_07_24 <- read.csv("Storms/POKE_storm13_07_24.csv", row.names = 1)
POKE_storm13_07_24_Q <- read.csv("Storms/POKE_storm13_07_24_Q.csv", row.names = 1)
POKE_storm13_07_24_NO3 <- read.csv("Storms/POKE_storm13_07_24_NO3.csv", row.names = 1)
POKE_storm13_07_24_fDOM <- read.csv("Storms/POKE_storm13_07_24_fDOM.csv", row.names = 1)

POKE_storm14_07_26 <- read.csv("Storms/POKE_storm14_07_26.csv", row.names = 1)
POKE_storm14_07_26_Q <- read.csv("Storms/POKE_storm14_07_26_Q.csv", row.names = 1)
POKE_storm14_07_26_NO3 <- read.csv("Storms/POKE_storm14_07_26_NO3.csv", row.names = 1)
POKE_storm14_07_26_fDOM <- read.csv("Storms/POKE_storm14_07_26_fDOM.csv", row.names = 1)

POKE_storm15_08_02 <- read.csv("Storms/POKE_storm15_08_02.csv", row.names = 1)
POKE_storm15_08_02_Q <- read.csv("Storms/POKE_storm15_08_02_Q.csv", row.names = 1)
POKE_storm15_08_02_NO3 <- read.csv("Storms/POKE_storm15_08_02_NO3.csv", row.names = 1)
POKE_storm15_08_02_fDOM <- read.csv("Storms/POKE_storm15_08_02_fDOM.csv", row.names = 1)

POKE_storm16_08_12 <- read.csv("Storms/POKE_storm16_08_12.csv", row.names = 1)
POKE_storm16_08_12_Q <- read.csv("Storms/POKE_storm16_08_12_Q.csv", row.names = 1)
POKE_storm16_08_12_NO3 <- read.csv("Storms/POKE_storm16_08_12_NO3.csv", row.names = 1)
POKE_storm16_08_12_fDOM <- read.csv("Storms/POKE_storm16_08_12_fDOM.csv", row.names = 1)

POKE_storm17_08_24 <- read.csv("Storms/POKE_storm17_08_24.csv", row.names = 1)
POKE_storm17_08_24_Q <- read.csv("Storms/POKE_storm17_08_24_Q.csv", row.names = 1)
POKE_storm17_08_24_NO3 <- read.csv("Storms/POKE_storm17_08_24_NO3.csv", row.names = 1)
POKE_storm17_08_24_fDOM <- read.csv("Storms/POKE_storm17_08_24_fDOM.csv", row.names = 1)

POKE_storm18_08_25 <- read.csv("Storms/POKE_storm18_08_25.csv", row.names = 1)
POKE_storm18_08_25_Q <- read.csv("Storms/POKE_storm18_08_25_Q.csv", row.names = 1)
POKE_storm18_08_25_NO3 <- read.csv("Storms/POKE_storm18_08_25_NO3.csv", row.names = 1)
POKE_storm18_08_25_fDOM <- read.csv("Storms/POKE_storm18_08_25_fDOM.csv", row.names = 1)

POKE_storm19_08_27 <- read.csv("Storms/POKE_storm19_08_27.csv", row.names = 1)
POKE_storm19_08_27_Q <- read.csv("Storms/POKE_storm19_08_27_Q.csv", row.names = 1)
POKE_storm19_08_27_NO3 <- read.csv("Storms/POKE_storm19_08_27_NO3.csv", row.names = 1)
POKE_storm19_08_27_fDOM <- read.csv("Storms/POKE_storm19_08_27_fDOM.csv", row.names = 1)

POKE_storm20_09_01 <- read.csv("Storms/POKE_storm20_09_01.csv", row.names = 1)
POKE_storm20_09_01_Q <- read.csv("Storms/POKE_storm20_09_01_Q.csv", row.names = 1)
POKE_storm20_09_01_NO3 <- read.csv("Storms/POKE_storm20_09_01_NO3.csv", row.names = 1)
POKE_storm20_09_01_fDOM <- read.csv("Storms/POKE_storm20_09_01_fDOM.csv", row.names = 1)

POKE_storm21_09_03 <- read.csv("Storms/POKE_storm21_09_03.csv", row.names = 1)
POKE_storm21_09_03_Q <- read.csv("Storms/POKE_storm21_09_03_Q.csv", row.names = 1)
POKE_storm21_09_03_NO3 <- read.csv("Storms/POKE_storm21_09_03_NO3.csv", row.names = 1)
POKE_storm21_09_03_fDOM <- read.csv("Storms/POKE_storm21_09_03_fDOM.csv", row.names = 1)

POKE_storm22a_09_07 <- read.csv("Storms/POKE_storm22a_09_07.csv", row.names = 1)
POKE_storm22a_09_07_Q <- read.csv("Storms/POKE_storm22a_09_07_Q.csv", row.names = 1)
POKE_storm22a_09_07_NO3 <- read.csv("Storms/POKE_storm22a_09_07_NO3.csv", row.names = 1)
POKE_storm22a_09_07_fDOM <- read.csv("Storms/POKE_storm22a_09_07_fDOM.csv", row.names = 1)

POKE_storm22b_09_09 <- read.csv("Storms/POKE_storm22b_09_09.csv", row.names = 1)
POKE_storm22b_09_09_Q <- read.csv("Storms/POKE_storm22b_09_09_Q.csv", row.names = 1)
POKE_storm22b_09_09_NO3 <- read.csv("Storms/POKE_storm22b_09_09_NO3.csv", row.names = 1)
POKE_storm22b_09_09_fDOM <- read.csv("Storms/POKE_storm22b_09_09_fDOM.csv", row.names = 1)
######################################## 2018 ##############################################################################

# FRCH #
 #fxn: plot hysteresis loop #
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
  dat.p = ggplot(data = dat_Q, 
                 aes(x=(dat_Q$datavalue), 
                     y=(dat_response$datavalue), 
                     color = as.numeric(dat_Q$valuedatetime))) +
    geom_point() +
    scale_colour_gradientn(colors = rainbow(3)) +
    theme_bw() +
    theme(legend.position="none") + 
    theme(axis.text=element_text(size=12),
          axis.title=element_text(size=14,face="bold")) +
    ylab(paste(site, response_var))+
    xlab("Normalized Discharge") +
    ggtitle(paste("Storm", storm_num))
  return(dat.p)
}

# plot FRCH loops #
# NO3
FRCH_storm1_06_21_NO3.p = hyst_plot(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_NO3, "FRCH", "NO3", "0621")
FRCH_storm2a_06_29_NO3.p = hyst_plot(FRCH_storm2a_06_29_Q, FRCH_storm2a_06_29_NO3, "FRCH", "NO3", "0629")
FRCH_storm2b_07_04_NO3.p = hyst_plot(FRCH_storm2b_07_04_Q, FRCH_storm2b_07_04_NO3, "FRCH", "NO3", "0704")
FRCH_storm3_07_10_NO3.p = hyst_plot(FRCH_storm3_07_10_Q, FRCH_storm3_07_10_NO3, "FRCH", "NO3", "0710")
FRCH_storm4a_07_15_NO3.p = hyst_plot(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_NO3, "FRCH", "NO3", "0715a")
FRCH_storm4b_07_16_NO3.p = hyst_plot(FRCH_storm4b_07_16_Q, FRCH_storm4b_07_16_NO3, "FRCH", "NO3", "0716b")
FRCH_storm5_08_04_NO3.p = hyst_plot(FRCH_storm5_08_04_Q, FRCH_storm5_08_04_NO3, "FRCH", "NO3", "0804")
FRCH_storm6_08_13_NO3.p = hyst_plot(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_NO3, "FRCH", "NO3", "0813")
FRCH_storm7_08_23_NO3.p = hyst_plot(FRCH_storm7_08_23_Q, FRCH_storm7_08_23_NO3, "FRCH", "NO3", "0823")
FRCH_storm8a_08_26_NO3.p = hyst_plot(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_NO3, "FRCH", "NO3", "0826a")
FRCH_storm8b_08_27_NO3.p = hyst_plot(FRCH_storm8b_08_27_Q, FRCH_storm8b_08_27_NO3, "FRCH", "NO3", "0827b")
FRCH_storm9_08_29_NO3.p = hyst_plot(FRCH_storm9_08_29_Q, FRCH_storm9_08_29_NO3, "FRCH", "NO3", "0829")
FRCH_storm10a_09_01_NO3.p = hyst_plot(FRCH_storm10a_09_01_Q, FRCH_storm10a_09_01_NO3, "FRCH", "NO3", "0901a")
FRCH_storm10b_09_04_NO3.p = hyst_plot(FRCH_storm10b_09_04_Q, FRCH_storm10b_09_04_NO3, "FRCH", "NO3", "0904b")
FRCH_storm11a_09_22_NO3.p = hyst_plot(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_NO3, "FRCH", "NO3", "0922a")
FRCH_storm11b_09_24_NO3.p = hyst_plot(FRCH_storm11b_09_24_Q, FRCH_storm11b_09_24_NO3, "FRCH", "NO3", "0924b")

# fDOM #
FRCH_storm1_06_21_fDOM.p = hyst_plot(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_fDOM, "FRCH", "fDOM", "0621")
FRCH_storm2a_06_29_fDOM.p = hyst_plot(FRCH_storm2a_06_29_Q, FRCH_storm2a_06_29_fDOM, "FRCH", "fDOM", "0629")
FRCH_storm2b_07_04_fDOM.p = hyst_plot(FRCH_storm2b_07_04_Q, FRCH_storm2b_07_04_fDOM, "FRCH", "fDOM", "0704")
FRCH_storm3_07_10_fDOM.p = hyst_plot(FRCH_storm3_07_10_Q, FRCH_storm3_07_10_fDOM, "FRCH", "fDOM", "0710")
FRCH_storm4a_07_15_fDOM.p = hyst_plot(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_fDOM, "FRCH", "fDOM", "0715a")
FRCH_storm4b_07_16_fDOM.p = hyst_plot(FRCH_storm4b_07_16_Q, FRCH_storm4b_07_16_fDOM, "FRCH", "fDOM", "0716b")
FRCH_storm5_08_04_fDOM.p = hyst_plot(FRCH_storm5_08_04_Q, FRCH_storm5_08_04_fDOM, "FRCH", "fDOM", "0804")
FRCH_storm6_08_13_fDOM.p = hyst_plot(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_fDOM, "FRCH", "fDOM", "0813")
FRCH_storm7_08_23_fDOM.p = hyst_plot(FRCH_storm7_08_23_Q, FRCH_storm7_08_23_fDOM, "FRCH", "fDOM", "0823")
FRCH_storm8a_08_26_fDOM.p = hyst_plot(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_fDOM, "FRCH", "fDOM", "0826a")
FRCH_storm8b_08_27_fDOM.p = hyst_plot(FRCH_storm8b_08_27_Q, FRCH_storm8b_08_27_fDOM, "FRCH", "fDOM", "0827b")
FRCH_storm9_08_29_fDOM.p = hyst_plot(FRCH_storm9_08_29_Q, FRCH_storm9_08_29_fDOM, "FRCH", "fDOM", "0829")
FRCH_storm10a_09_01_fDOM.p = hyst_plot(FRCH_storm10a_09_01_Q, FRCH_storm10a_09_01_fDOM, "FRCH", "fDOM", "0901a")
FRCH_storm10b_09_04_fDOM.p = hyst_plot(FRCH_storm10b_09_04_Q, FRCH_storm10b_09_04_fDOM, "FRCH", "fDOM", "0904b")
FRCH_storm11a_09_22_fDOM.p = hyst_plot(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_fDOM, "FRCH", "fDOM", "0922a")
FRCH_storm11b_09_24_fDOM.p = hyst_plot(FRCH_storm11b_09_24_Q, FRCH_storm11b_09_24_fDOM, "FRCH", "fDOM", "0924b")

# SPC #
FRCH_storm1_06_21_SPC.p = hyst_plot(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_SPC, "FRCH", "SPC", "0621")
FRCH_storm2a_06_29_SPC.p = hyst_plot(FRCH_storm2a_06_29_Q, FRCH_storm2a_06_29_SPC, "FRCH", "SPC", "0629")
FRCH_storm2b_07_04_SPC.p = hyst_plot(FRCH_storm2b_07_04_Q, FRCH_storm2b_07_04_SPC, "FRCH", "SPC", "0704")
FRCH_storm3_07_10_SPC.p = hyst_plot(FRCH_storm3_07_10_Q, FRCH_storm3_07_10_SPC, "FRCH", "SPC", "0710")
FRCH_storm4a_07_15_SPC.p = hyst_plot(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_SPC, "FRCH", "SPC", "0715a")
FRCH_storm4b_07_16_SPC.p = hyst_plot(FRCH_storm4b_07_16_Q, FRCH_storm4b_07_16_SPC, "FRCH", "SPC", "0716b")
FRCH_storm5_08_04_SPC.p = hyst_plot(FRCH_storm5_08_04_Q, FRCH_storm5_08_04_SPC, "FRCH", "SPC", "0804")
FRCH_storm6_08_13_SPC.p = hyst_plot(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_SPC, "FRCH", "SPC", "0813")
FRCH_storm7_08_23_SPC.p = hyst_plot(FRCH_storm7_08_23_Q, FRCH_storm7_08_23_SPC, "FRCH", "SPC", "0823")
FRCH_storm8a_08_26_SPC.p = hyst_plot(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_SPC, "FRCH", "SPC", "0826a")
FRCH_storm8b_08_27_SPC.p = hyst_plot(FRCH_storm8b_08_27_Q, FRCH_storm8b_08_27_SPC, "FRCH", "SPC", "0827b")
FRCH_storm9_08_29_SPC.p = hyst_plot(FRCH_storm9_08_29_Q, FRCH_storm9_08_29_SPC, "FRCH", "SPC", "0829")
FRCH_storm10a_09_01_SPC.p = hyst_plot(FRCH_storm10a_09_01_Q, FRCH_storm10a_09_01_SPC, "FRCH", "SPC", "0901a")
FRCH_storm10b_09_04_SPC.p = hyst_plot(FRCH_storm10b_09_04_Q, FRCH_storm10b_09_04_SPC, "FRCH", "SPC", "0904b")
FRCH_storm11a_09_22_SPC.p = hyst_plot(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_SPC, "FRCH", "SPC", "0922a")
FRCH_storm11b_09_24_SPC.p = hyst_plot(FRCH_storm11b_09_24_Q, FRCH_storm11b_09_24_SPC, "FRCH", "SPC", "0924b")

# turb
FRCH_storm1_06_21_turb.p = hyst_plot(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_turb, "FRCH", "turb", "0621")
FRCH_storm2a_06_29_turb.p = hyst_plot(FRCH_storm2a_06_29_Q, FRCH_storm2a_06_29_turb, "FRCH", "turb", "0629")
FRCH_storm2b_07_04_turb.p = hyst_plot(FRCH_storm2b_07_04_Q, FRCH_storm2b_07_04_turb, "FRCH", "turb", "0704")
FRCH_storm3_07_10_turb.p = hyst_plot(FRCH_storm3_07_10_Q, FRCH_storm3_07_10_turb, "FRCH", "turb", "0710")
FRCH_storm4a_07_15_turb.p = hyst_plot(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_turb, "FRCH", "turb", "0715a")
FRCH_storm4b_07_16_turb.p = hyst_plot(FRCH_storm4b_07_16_Q, FRCH_storm4b_07_16_turb, "FRCH", "turb", "0716b")
FRCH_storm5_08_04_turb.p = hyst_plot(FRCH_storm5_08_04_Q, FRCH_storm5_08_04_turb, "FRCH", "turb", "0804")
FRCH_storm6_08_13_turb.p = hyst_plot(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_turb, "FRCH", "turb", "0813")
FRCH_storm7_08_23_turb.p = hyst_plot(FRCH_storm7_08_23_Q, FRCH_storm7_08_23_turb, "FRCH", "turb", "0823")
FRCH_storm8a_08_26_turb.p = hyst_plot(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_fDOM, "FRCH", "turb", "0826a")
FRCH_storm8b_08_27_turb.p = hyst_plot(FRCH_storm8b_08_27_Q, FRCH_storm8b_08_27_turb, "FRCH", "turb", "0827b")
FRCH_storm9_08_29_turb.p = hyst_plot(FRCH_storm9_08_29_Q, FRCH_storm9_08_29_turb, "FRCH", "turb", "0829")
FRCH_storm10a_09_01_turb.p = hyst_plot(FRCH_storm10a_09_01_Q, FRCH_storm10a_09_01_turh, "FRCH", "turb", "0901a")
FRCH_storm10b_09_04_turb.p = hyst_plot(FRCH_storm10b_09_04_Q, FRCH_storm10b_09_04_turb, "FRCH", "turb", "0904b")
FRCH_storm11a_09_22_turb.p = hyst_plot(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_turb, "FRCH", "turb", "0922a")
FRCH_storm11b_09_24_turb.p = hyst_plot(FRCH_storm11b_09_24_Q, FRCH_storm11b_09_24_turb, "FRCH", "turb", "0924b")

# Multiplots of FRCH storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

multiplot(FRCH_storm1_06_21_NO3.p, FRCH_storm1_06_21_fDOM.p, FRCH_storm1_06_21_SPC.p, FRCH_storm1_06_21_turb.p) # works 
multiplot(FRCH_storm2a_06_29_NO3.p, FRCH_storm2a_06_29_fDOM.p, FRCH_storm2a_06_29_SPC.p, FRCH_storm2a_06_29_turb.p) # works 
multiplot(FRCH_storm2b_07_04_NO3.p, FRCH_storm2b_07_04_fDOM.p, FRCH_storm2b_07_04_SPC.p, FRCH_storm2b_07_04_turb.p) # works 
multiplot(FRCH_storm3_07_10_NO3.p, FRCH_storm3_07_10_fDOM.p, FRCH_storm3_07_10_SPC.p, FRCH_storm3_07_10_turb.p) # works 
multiplot(FRCH_storm4a_07_15_NO3.p, FRCH_storm4a_07_15_fDOM.p, FRCH_storm4a_07_15_SPC.p, FRCH_storm4a_07_15_turb.p) # works 
multiplot(FRCH_storm4b_07_16_NO3.p, FRCH_storm4b_07_16_fDOM.p, FRCH_storm4b_07_16_SPC.p, FRCH_storm4b_07_16_turb.p) # works 
multiplot(FRCH_storm5_08_04_NO3.p, FRCH_storm5_08_04_fDOM.p, FRCH_storm5_08_04_SPC.p, FRCH_storm5_08_04_turb.p) # works 
multiplot(FRCH_storm6_08_13_NO3.p, FRCH_storm6_08_13_fDOM.p, FRCH_storm6_08_13_SPC.p, FRCH_storm6_08_13_turb.p) # works 
multiplot(FRCH_storm7_08_23_NO3.p, FRCH_storm7_08_23_fDOM.p, FRCH_storm7_08_23_SPC.p, FRCH_storm7_08_23_turb.p) # works 
multiplot(FRCH_storm8a_08_26_NO3.p, FRCH_storm8a_08_26_fDOM.p, FRCH_storm8a_08_26_SPC.p, FRCH_storm8a_08_26_turb.p) # works 
multiplot(FRCH_storm8b_08_27_NO3.p, FRCH_storm8b_08_27_fDOM.p, FRCH_storm8b_08_27_SPC.p, FRCH_storm8b_08_27_turb.p) # works 
multiplot(FRCH_storm9_08_29_NO3.p, FRCH_storm9_08_29_fDOM.p, FRCH_storm9_08_29_SPC.p, FRCH_storm9_08_29_turb.p) # works 
multiplot(FRCH_storm10a_09_01_NO3.p, FRCH_storm10a_09_01_fDOM.p, FRCH_storm10a_09_01_SPC.p) # works 
multiplot(FRCH_storm10b_09_04_NO3.p, FRCH_storm10b_09_04_fDOM.p, FRCH_storm10b_09_04_SPC.p, FRCH_storm10b_09_04_turb.p) # works 
multiplot(FRCH_storm11a_09_22_NO3.p, FRCH_storm11a_09_22_fDOM.p, FRCH_storm11a_09_22_SPC.p, FRCH_storm11a_09_22_turb.p) # works 
multiplot(FRCH_storm11b_09_24_NO3.p, FRCH_storm11b_09_24_fDOM.p, FRCH_storm11b_09_24_SPC.p, FRCH_storm11b_09_24_turb.p) # works 


multiplot(FRCH_storm1_06_21_NO3.p, FRCH_storm1_06_21_fDOM.p, FRCH_storm1_06_21_SPC.p, FRCH_storm1_06_21_turb.p,
          FRCH_storm2a_06_29_NO3.p, FRCH_storm2a_06_29_fDOM.p, FRCH_storm2a_06_29_SPC.p, FRCH_storm2a_06_29_turb.p,
          FRCH_storm2b_07_04_NO3.p, FRCH_storm2b_07_04_fDOM.p, FRCH_storm2b_07_04_SPC.p, FRCH_storm2b_07_04_turb.p,
          FRCH_storm3_07_10_NO3.p, FRCH_storm3_07_10_fDOM.p, FRCH_storm3_07_10_SPC.p, FRCH_storm3_07_10_turb.p,
          FRCH_storm4a_07_15_NO3.p, FRCH_storm4a_07_15_fDOM.p, FRCH_storm4a_07_15_SPC.p, FRCH_storm4a_07_15_turb.p,
          FRCH_storm4b_07_16_NO3.p, FRCH_storm4b_07_16_fDOM.p, FRCH_storm4b_07_16_SPC.p, FRCH_storm4b_07_16_turb.p,
          FRCH_storm6_08_13_NO3.p, FRCH_storm6_08_13_fDOM.p, FRCH_storm6_08_13_SPC.p, FRCH_storm6_08_13_turb.p,
          FRCH_storm7_08_23_NO3.p, FRCH_storm7_08_23_fDOM.p, FRCH_storm7_08_23_SPC.p, FRCH_storm7_08_23_turb.p,
          FRCH_storm8a_08_26_NO3.p, FRCH_storm8a_08_26_fDOM.p, FRCH_storm8a_08_26_SPC.p, FRCH_storm8a_08_26_turb.p,
          FRCH_storm8b_08_27_NO3.p, FRCH_storm8b_08_27_fDOM.p, FRCH_storm8b_08_27_SPC.p, FRCH_storm8b_08_27_turb.p,
          FRCH_storm9_08_29_NO3.p, FRCH_storm9_08_29_fDOM.p, FRCH_storm9_08_29_SPC.p, FRCH_storm9_08_29_turb.p,
          FRCH_storm10a_09_01_NO3.p, FRCH_storm10a_09_01_fDOM.p, FRCH_storm10a_09_01_SPC.p,
          FRCH_storm10b_09_04_NO3.p, FRCH_storm10b_09_04_fDOM.p, FRCH_storm10b_09_04_SPC.p, FRCH_storm10b_09_04_turb.p,
          FRCH_storm11a_09_22_NO3.p, FRCH_storm11a_09_22_fDOM.p, FRCH_storm11a_09_22_SPC.p, FRCH_storm11a_09_22_turb.p,
          FRCH_storm11b_09_24_NO3.p, FRCH_storm11b_09_24_fDOM.p, FRCH_storm11b_09_24_SPC.p, FRCH_storm11b_09_24_turb.p,
          cols = 7)

# export pdf 20 x 30

# MOOS #
# fxn: plot hysteresis loop #
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
  dat.p = ggplot(data = dat_Q, 
                 aes(x=(dat_Q$datavalue), 
                     y=(dat_response$datavalue), 
                     color = as.numeric(dat_Q$valuedatetime))) +
    geom_point() +
    scale_colour_gradientn(colors = rainbow(3)) +
    theme_bw() +
    theme(legend.position="none") + 
    theme(axis.text=element_text(size=12),
          axis.title=element_text(size=14,face="bold")) +
    ylab(paste(site, response_var))+
    xlab("Normalized Discharge") +
    ggtitle(paste("Storm", storm_num))
  return(dat.p)
}

# plot MOOS loops #
# NO3
MOOS_storm1_06_21_NO3.p = hyst_plot(MOOS_storm1_06_21_Q, MOOS_storm1_06_21_NO3, "MOOS", "NO3", "0621")
MOOS_storm2a_06_29_NO3.p = hyst_plot(MOOS_storm2a_06_29_Q, MOOS_storm2a_06_29_NO3, "MOOS", "NO3", "0629a")
MOOS_storm2b_07_01_NO3.p = hyst_plot(MOOS_storm2b_07_01_Q, MOOS_storm2b_07_01_NO3, "MOOS", "NO3", "0701b")
MOOS_storm2c_07_04_NO3.p = hyst_plot(MOOS_storm2c_07_04_Q, MOOS_storm2c_07_04_NO3, "MOOS", "NO3", "0704c")
MOOS_storm3_07_09_NO3.p = hyst_plot(MOOS_storm3_07_09_Q, MOOS_storm3_07_09_NO3, "MOOS", "NO3", "0709")
MOOS_storm4_07_15_NO3.p = hyst_plot(MOOS_storm4_07_15_Q, MOOS_storm4_07_15_NO3, "MOOS", "NO3", "0715")
MOOS_storm5_08_04_NO3.p = hyst_plot(MOOS_storm5_08_04_Q, MOOS_storm5_08_04_NO3, "MOOS", "NO3", "0804")
MOOS_storm6_08_13_NO3.p = hyst_plot(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_NO3, "MOOS", "NO3", "0813")
MOOS_storm7_08_23_NO3.p = hyst_plot(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_NO3, "MOOS", "NO3", "0823")
MOOS_storm8_08_26_NO3.p = hyst_plot(MOOS_storm8_08_26_Q, MOOS_storm8_08_26_NO3, "MOOS", "NO3", "0826")
MOOS_storm9_08_29_NO3.p = hyst_plot(MOOS_storm9_08_29_Q, MOOS_storm9_08_29_NO3, "MOOS", "NO3", "0829")
MOOS_storm10_09_01_NO3.p = hyst_plot(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_NO3, "MOOS", "NO3", "0901")
MOOS_storm11_09_22_NO3.p = hyst_plot(MOOS_storm11_09_22_Q, MOOS_storm11_09_22_NO3, "MOOS", "NO3", "0922")
MOOS_storm12_09_24_NO3.p = hyst_plot(MOOS_storm12_09_24_Q, MOOS_storm12_09_24_NO3, "MOOS", "NO3", "0924")

# fDOM #
MOOS_storm1_06_21_fDOM.p = hyst_plot(MOOS_storm1_06_21_Q, MOOS_storm1_06_21_fDOM, "MOOS", "fDOM", "0621")
MOOS_storm2a_06_29_fDOM.p = hyst_plot(MOOS_storm2a_06_29_Q, MOOS_storm2a_06_29_fDOM, "MOOS", "fDOM", "0629a")
MOOS_storm2b_07_01_fDOM.p = hyst_plot(MOOS_storm2b_07_01_Q, MOOS_storm2b_07_01_fDOM, "MOOS", "fDOM", "0701b")
MOOS_storm2c_07_04_fDOM.p = hyst_plot(MOOS_storm2c_07_04_Q, MOOS_storm2c_07_04_fDOM, "MOOS", "fDOM", "0704c")
MOOS_storm3_07_09_fDOM.p = hyst_plot(MOOS_storm3_07_09_Q, MOOS_storm3_07_09_fDOM, "MOOS", "fDOM", "0709")
MOOS_storm4_07_15_fDOM.p = hyst_plot(MOOS_storm4_07_15_Q, MOOS_storm4_07_15_fDOM, "MOOS", "fDOM", "0715")
MOOS_storm5_08_04_fDOM.p = hyst_plot(MOOS_storm5_08_04_Q, MOOS_storm5_08_04_fDOM, "MOOS", "fDOM", "0804")
MOOS_storm6_08_13_fDOM.p = hyst_plot(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_fDOM, "MOOS", "fDOM", "0813")
MOOS_storm7_08_23_fDOM.p = hyst_plot(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_fDOM, "MOOS", "fDOM", "0823")
MOOS_storm8_08_26_fDOM.p = hyst_plot(MOOS_storm8_08_26_Q, MOOS_storm8_08_26_fDOM, "MOOS", "fDOM", "0826")
MOOS_storm9_08_29_fDOM.p = hyst_plot(MOOS_storm9_08_29_Q, MOOS_storm9_08_29_fDOM, "MOOS", "fDOM", "0829")
MOOS_storm10_09_01_fDOM.p = hyst_plot(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_fDOM, "MOOS", "fDOM", "0901")
MOOS_storm11_09_22_fDOM.p = hyst_plot(MOOS_storm11_09_22_Q, MOOS_storm11_09_22_fDOM, "MOOS", "fDOM", "0922")
MOOS_storm12_09_24_fDOM.p = hyst_plot(MOOS_storm12_09_24_Q, MOOS_storm12_09_24_fDOM, "MOOS", "fDOM", "0924")

# SPC #
MOOS_storm1_06_21_SPC.p = hyst_plot(MOOS_storm1_06_21_Q, MOOS_storm1_06_21_SPC, "MOOS", "SPC", "0621")
MOOS_storm2a_06_29_SPC.p = hyst_plot(MOOS_storm2a_06_29_Q, MOOS_storm2a_06_29_SPC, "MOOS", "SPC", "0629a")
MOOS_storm2b_07_01_SPC.p = hyst_plot(MOOS_storm2b_07_01_Q, MOOS_storm2b_07_01_SPC, "MOOS", "SPC", "0701b")
MOOS_storm2c_07_04_SPC.p = hyst_plot(MOOS_storm2c_07_04_Q, MOOS_storm2c_07_04_SPC, "MOOS", "SPC", "0704c")
MOOS_storm3_07_09_SPC.p = hyst_plot(MOOS_storm3_07_09_Q, MOOS_storm3_07_09_SPC, "MOOS", "SPC", "0709")
MOOS_storm4_07_15_SPC.p = hyst_plot(MOOS_storm4_07_15_Q, MOOS_storm4_07_15_SPC, "MOOS", "SPC", "0715")
MOOS_storm5_08_04_SPC.p = hyst_plot(MOOS_storm5_08_04_Q, MOOS_storm5_08_04_SPC, "MOOS", "SPC", "0804")
MOOS_storm6_08_13_SPC.p = hyst_plot(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_SPC, "MOOS", "SPC", "0813")
MOOS_storm7_08_23_SPC.p = hyst_plot(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_SPC, "MOOS", "SPC", "0823")
MOOS_storm8_08_26_SPC.p = hyst_plot(MOOS_storm8_08_26_Q, MOOS_storm8_08_26_SPC, "MOOS", "SPC", "0826")
MOOS_storm9_08_29_SPC.p = hyst_plot(MOOS_storm9_08_29_Q, MOOS_storm9_08_29_SPC, "MOOS", "SPC", "0829")
MOOS_storm10_09_01_SPC.p = hyst_plot(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_SPC, "MOOS", "SPC", "0901")
MOOS_storm11_09_22_SPC.p = hyst_plot(MOOS_storm11_09_22_Q, MOOS_storm11_09_22_SPC, "MOOS", "SPC", "0922")
MOOS_storm12_09_24_SPC.p = hyst_plot(MOOS_storm12_09_24_Q, MOOS_storm12_09_24_SPC, "MOOS", "SPC", "0924")

# turb
MOOS_storm1_06_21_turb.p = hyst_plot(MOOS_storm1_06_21_Q, MOOS_storm1_06_21_turb, "MOOS", "turb", "0621")
MOOS_storm2a_06_29_turb.p = hyst_plot(MOOS_storm2a_06_29_Q, MOOS_storm2a_06_29_turb, "MOOS", "turb", "0629a")
MOOS_storm2b_07_01_turb.p = hyst_plot(MOOS_storm2b_07_01_Q, MOOS_storm2b_07_01_turb, "MOOS", "turb", "0701b")
MOOS_storm2c_07_04_turb.p = hyst_plot(MOOS_storm2c_07_04_Q, MOOS_storm2c_07_04_turb, "MOOS", "turb", "0704c")
MOOS_storm3_07_09_turb.p = hyst_plot(MOOS_storm3_07_09_Q, MOOS_storm3_07_09_turb, "MOOS", "turb", "0709")
MOOS_storm4_07_15_turb.p = hyst_plot(MOOS_storm4_07_15_Q, MOOS_storm4_07_15_turb, "MOOS", "turb", "0715")
MOOS_storm5_08_04_turb.p = hyst_plot(MOOS_storm5_08_04_Q, MOOS_storm5_08_04_turb, "MOOS", "turb", "0804")
MOOS_storm6_08_13_turb.p = hyst_plot(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_turb, "MOOS", "turb", "0813")
MOOS_storm7_08_23_turb.p = hyst_plot(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_turb, "MOOS", "turb", "0823")
MOOS_storm8_08_26_turb.p = hyst_plot(MOOS_storm8_08_26_Q, MOOS_storm8_08_26_turb, "MOOS", "turb", "0826")
MOOS_storm9_08_29_turb.p = hyst_plot(MOOS_storm9_08_29_Q, MOOS_storm9_08_29_turb, "MOOS", "turb", "0829")
MOOS_storm10_09_01_turb.p = hyst_plot(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_turb, "MOOS", "turb", "0901")
MOOS_storm11_09_22_turb.p = hyst_plot(MOOS_storm11_09_22_Q, MOOS_storm11_09_22_turb, "MOOS", "turb", "0922")
MOOS_storm12_09_24_turb.p = hyst_plot(MOOS_storm12_09_24_Q, MOOS_storm12_09_24_turb, "MOOS", "turb", "0924")

# Multiplots of MOOS storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

multiplot(MOOS_storm1_06_21_NO3.p, MOOS_storm1_06_21_fDOM.p, MOOS_storm1_06_21_SPC.p, MOOS_storm1_06_21_turb.p) # works 
multiplot(MOOS_storm2a_06_29_NO3.p, MOOS_storm2a_06_29_fDOM.p, MOOS_storm2a_06_29_SPC.p, MOOS_storm2a_06_29_turb.p) # works/ empty
multiplot(MOOS_storm2b_07_01_NO3.p, MOOS_storm2b_07_01_fDOM.p, MOOS_storm2b_07_01_SPC.p, MOOS_storm2b_07_01_turb.p) # works/empty
multiplot(MOOS_storm2c_07_04_NO3.p, MOOS_storm2c_07_04_fDOM.p, MOOS_storm2c_07_04_SPC.p, MOOS_storm2c_07_04_turb.p) # works/empty
multiplot(MOOS_storm3_07_09_NO3.p, MOOS_storm3_07_09_fDOM.p, MOOS_storm3_07_09_SPC.p, MOOS_storm3_07_09_turb.p) # works 
multiplot(MOOS_storm4_07_15_NO3.p, MOOS_storm4_07_15_fDOM.p, MOOS_storm4_07_15_SPC.p, MOOS_storm4_07_15_turb.p) # works 
multiplot(MOOS_storm5_08_04_NO3.p, MOOS_storm5_08_04_fDOM.p, MOOS_storm5_08_04_SPC.p, MOOS_storm5_08_04_turb.p) # works 
multiplot(MOOS_storm6_08_13_NO3.p, MOOS_storm6_08_13_fDOM.p, MOOS_storm6_08_13_SPC.p, MOOS_storm6_08_13_turb.p) # works 
multiplot(MOOS_storm7_08_23_NO3.p, MOOS_storm7_08_23_fDOM.p, MOOS_storm7_08_23_SPC.p, MOOS_storm7_08_23_turb.p) # works 
multiplot(MOOS_storm8_08_26_NO3.p, MOOS_storm8_08_26_fDOM.p, MOOS_storm8_08_26_SPC.p, MOOS_storm8_08_26_turb.p) # works 
multiplot(MOOS_storm9_08_29_NO3.p, MOOS_storm9_08_29_fDOM.p, MOOS_storm9_08_29_SPC.p, MOOS_storm9_08_29_turb.p) # works 
multiplot(MOOS_storm10_09_01_NO3.p, MOOS_storm10_09_01_fDOM.p, MOOS_storm10_09_01_SPC.p, MOOS_storm10_09_01_turb.p) # works 
multiplot(MOOS_storm11_09_22_NO3.p, MOOS_storm11_09_22_fDOM.p, MOOS_storm11_09_22_SPC.p, MOOS_storm11_09_22_turb.p) # works 
multiplot(MOOS_storm12_09_24_NO3.p, MOOS_storm12_09_24_fDOM.p, MOOS_storm12_09_24_SPC.p, MOOS_storm12_09_24_turb.p) # works 


multiplot(MOOS_storm1_06_21_NO3.p, MOOS_storm1_06_21_fDOM.p, MOOS_storm1_06_21_SPC.p, MOOS_storm1_06_21_turb.p,
          MOOS_storm2a_06_29_NO3.p, MOOS_storm2a_06_29_fDOM.p, MOOS_storm2a_06_29_SPC.p, MOOS_storm2a_06_29_turb.p,
          MOOS_storm2b_07_01_NO3.p, MOOS_storm2b_07_01_fDOM.p, MOOS_storm2b_07_01_SPC.p, MOOS_storm2b_07_01_turb.p,
          MOOS_storm2c_07_04_NO3.p, MOOS_storm2c_07_04_fDOM.p, MOOS_storm2c_07_04_SPC.p, MOOS_storm2c_07_04_turb.p,
          MOOS_storm3_07_09_NO3.p, MOOS_storm3_07_09_fDOM.p, MOOS_storm3_07_09_SPC.p, MOOS_storm3_07_09_turb.p,
          MOOS_storm4_07_15_NO3.p, MOOS_storm4_07_15_fDOM.p, MOOS_storm4_07_15_SPC.p, MOOS_storm4_07_15_turb.p,
          MOOS_storm5_08_04_NO3.p, MOOS_storm5_08_04_fDOM.p, MOOS_storm5_08_04_SPC.p, MOOS_storm5_08_04_turb.p,
          MOOS_storm6_08_13_NO3.p, MOOS_storm6_08_13_fDOM.p, MOOS_storm6_08_13_SPC.p, MOOS_storm6_08_13_turb.p,
          MOOS_storm7_08_23_NO3.p, MOOS_storm7_08_23_fDOM.p, MOOS_storm7_08_23_SPC.p, MOOS_storm7_08_23_turb.p,
          MOOS_storm8_08_26_NO3.p, MOOS_storm8_08_26_fDOM.p, MOOS_storm8_08_26_SPC.p, MOOS_storm8_08_26_turb.p,
          MOOS_storm9_08_29_NO3.p, MOOS_storm9_08_29_fDOM.p, MOOS_storm9_08_29_SPC.p, MOOS_storm9_08_29_turb.p,
          MOOS_storm10_09_01_NO3.p, MOOS_storm10_09_01_fDOM.p, MOOS_storm10_09_01_SPC.p, MOOS_storm10_09_01_turb.p,
          MOOS_storm11_09_22_NO3.p, MOOS_storm11_09_22_fDOM.p, MOOS_storm11_09_22_SPC.p, MOOS_storm11_09_22_turb.p,
          MOOS_storm12_09_24_NO3.p, MOOS_storm12_09_24_fDOM.p, MOOS_storm12_09_24_SPC.p, MOOS_storm12_09_24_turb.p,
          cols = 7
          )
############################################### 2019 ##############################################
# plot on normalized scale # 
#### load data #####
STRT_storm1a_06_19 <- read.csv("Storms/STRT_storm1a_06_19.csv")
STRT_storm1a_06_19_Q <- read.csv("Storms/STRT_storm1a_06_19_Q.csv")
STRT_storm1a_06_19_NO3 <- read.csv("Storms/STRT_storm1a_06_19_NO3.csv")
STRT_storm1a_06_19_fDOM <- read.csv("Storms/STRT_storm1a_06_19_fDOM.csv")

STRT_storm1b_06_20 <- read.csv("Storms/STRT_storm1b_06_20.csv")
STRT_storm1b_06_20_Q <- read.csv("Storms/STRT_storm1b_06_20_Q.csv")
STRT_storm1b_06_20_NO3 <- read.csv("Storms/STRT_storm1b_06_20_NO3.csv")
STRT_storm1b_06_20_fDOM <- read.csv("Storms/STRT_storm1b_06_20_fDOM.csv")

STRT_storm1c_06_22 <- read.csv("Storms/STRT_storm1c_06_22.csv")
STRT_storm1c_06_22_Q <- read.csv("Storms/STRT_storm1c_06_22_Q.csv")
STRT_storm1c_06_22_NO3 <- read.csv("Storms/STRT_storm1c_06_22_NO3.csv")
STRT_storm1c_06_22_fDOM <- read.csv("Storms/STRT_storm1c_06_22_fDOM.csv")

STRT_storm1d_06_23 <- read.csv("Storms/STRT_storm1d_06_23.csv")
STRT_storm1d_06_23_Q <- read.csv("Storms/STRT_storm1d_06_23_Q.csv")
STRT_storm1d_06_23_NO3 <- read.csv("Storms/STRT_storm1d_06_23_NO3.csv")
STRT_storm1d_06_23_fDOM <- read.csv("Storms/STRT_storm1d_06_23_fDOM.csv")

STRT_storm1e_06_24 <- read.csv("Storms/STRT_storm1e_06_24.csv")
STRT_storm1e_06_24_Q <- read.csv("Storms/STRT_storm1e_06_24_Q.csv")
STRT_storm1e_06_24_NO3 <- read.csv("Storms/STRT_storm1e_06_24_NO3.csv")
STRT_storm1e_06_24_fDOM <- read.csv("Storms/STRT_storm1e_06_24_fDOM.csv")

STRT_storm2_07_09 <- read.csv("Storms/STRT_storm2_07_09.csv")
STRT_storm2_07_09_Q <- read.csv("Storms/STRT_storm2_07_09_Q.csv")
STRT_storm2_07_09_NO3 <- read.csv("Storms/STRT_storm2_07_09_NO3.csv")
STRT_storm2_07_09_fDOM <- read.csv("Storms/STRT_storm2_07_09_fDOM.csv")

STRT_storm3_07_21 <- read.csv("Storms/STRT_storm3_07_21.csv")
STRT_storm3_07_21_Q <- read.csv("Storms/STRT_storm3_07_21_Q.csv")
STRT_storm3_07_21_NO3 <- read.csv("Storms/STRT_storm3_07_21_NO3.csv")
STRT_storm3_07_21_fDOM <- read.csv("Storms/STRT_storm3_07_21_fDOM.csv")

STRT_storm4a_08_01 <- read.csv("Storms/STRT_storm4a_08_01.csv")
STRT_storm4a_08_01_Q <- read.csv("Storms/STRT_storm4a_08_01_Q.csv")
STRT_storm4a_08_01_NO3 <- read.csv("Storms/STRT_storm4a_08_01_NO3.csv")
STRT_storm4a_08_01_fDOM <- read.csv("Storms/STRT_storm4a_08_01_fDOM.csv")

STRT_storm4b_08_03 <- read.csv("Storms/STRT_storm4b_08_03.csv")
STRT_storm4b_08_03_Q <- read.csv("Storms/STRT_storm4b_08_03_Q.csv")
STRT_storm4b_08_03_NO3 <- read.csv("Storms/STRT_storm4b_08_03_NO3.csv")
STRT_storm4b_08_03_fDOM <- read.csv("Storms/STRT_storm4b_08_03_fDOM.csv")

STRT_storm5_08_09 <- read.csv("Storms/STRT_storm5_08_09.csv")
STRT_storm5_08_09_Q <- read.csv("Storms/STRT_storm5_08_09_Q.csv")
STRT_storm5_08_09_NO3 <- read.csv("Storms/STRT_storm5_08_09_NO3.csv")
STRT_storm5_08_09_fDOM <- read.csv("Storms/STRT_storm5_08_09_fDOM.csv")

STRT_storm6_08_12 <- read.csv("Storms/STRT_storm6_08_12.csv")
STRT_storm6_08_12_Q <- read.csv("Storms/STRT_storm6_08_12_Q.csv")
STRT_storm6_08_12_NO3 <- read.csv("Storms/STRT_storm6_08_12_NO3.csv")
STRT_storm6_08_12_fDOM <- read.csv("Storms/STRT_storm6_08_12_fDOM.csv")

STRT_storm7a_08_20 <- read.csv("Storms/STRT_storm7a_08_20.csv")
STRT_storm7a_08_20_Q <- read.csv("Storms/STRT_storm7a_08_20_Q.csv")
STRT_storm7a_08_20_NO3 <- read.csv("Storms/STRT_storm7a_08_20_NO3.csv")
STRT_storm7a_08_20_fDOM <- read.csv("Storms/STRT_storm7a_08_20_fDOM.csv")

STRT_storm7b_08_21 <- read.csv("Storms/STRT_storm7b_08_21.csv")
STRT_storm7b_08_21_Q <- read.csv("Storms/STRT_storm7b_08_21_Q.csv",)
STRT_storm7b_08_21_NO3 <- read.csv("Storms/STRT_storm7b_08_21_NO3.csv")
STRT_storm7b_08_21_fDOM <- read.csv("Storms/STRT_storm7b_08_21_fDOM.csv")

STRT_storm8_08_28 <- read.csv("Storms/STRT_storm8_08_28.csv")
STRT_storm8_08_28_Q <- read.csv("Storms/STRT_storm8_08_28_Q.csv")
STRT_storm8_08_28_NO3 <- read.csv("Storms/STRT_storm8_08_28_NO3.csv")
STRT_storm8_08_28_fDOM <- read.csv("Storms/STRT_storm8_08_28_fDOM.csv")

STRT_storm9a_09_03 <- read.csv("Storms/STRT_storm9a_09_03.csv")
STRT_storm9a_09_03_Q <- read.csv("Storms/STRT_storm9a_09_03_Q.csv")
STRT_storm9a_09_03_NO3 <- read.csv("Storms/STRT_storm9a_09_03_NO3.csv")
STRT_storm9a_09_03_fDOM <- read.csv("Storms/STRT_storm9a_09_03_fDOM.csv")

STRT_storm9b_09_06 <- read.csv("Storms/STRT_storm9b_09_06.csv")
STRT_storm9b_09_06_Q <- read.csv("Storms/STRT_storm9b_09_06_Q.csv")
STRT_storm9b_09_06_NO3 <- read.csv("Storms/STRT_storm9b_09_06_NO3.csv")
STRT_storm9b_09_06_fDOM <- read.csv("Storms/STRT_storm9b_09_06_fDOM.csv")

STRT_storm9c_09_09 <- read.csv("Storms/STRT_storm9c_09_09.csv")
STRT_storm9c_09_09_Q <- read.csv("Storms/STRT_storm9c_09_09_Q.csv")
STRT_storm9c_09_09_NO3 <- read.csv("Storms/STRT_storm9c_09_09_NO3.csv")
STRT_storm9c_09_09_fDOM <- read.csv("Storms/STRT_storm9c_09_09_fDOM.csv")

STRT_storm10_09_23 <- read.csv("Storms/STRT_storm10_09_23.csv")
STRT_storm10_09_23_Q <- read.csv("Storms/STRT_storm10_09_23_Q.csv")
STRT_storm10_09_23_NO3 <- read.csv("Storms/STRT_storm10_09_23_NO3.csv")
STRT_storm10_09_23_fDOM <- read.csv("Storms/STRT_storm10_09_23_fDOM.csv")

# MOOS #
MOOS_storm1_06_21 <- read.csv("Storms/MOOS_storm1_06_21.csv", row.names = 1)
MOOS_storm1_06_21_Q <- read.csv("Storms/MOOS_storm1_06_21_Q.csv", row.names = 1)
MOOS_storm1_06_21_NO3 <- read.csv("Storms/MOOS_storm1_06_21_NO3.csv", row.names = 1)
MOOS_storm1_06_21_fDOM <- read.csv("Storms/MOOS_storm1_06_21_fDOM.csv", row.names = 1)

MOOS_storm2_06_28 <- read.csv("Storms/MOOS_storm2_06_28.csv", row.names = 1)
MOOS_storm2_06_28_Q <- read.csv("Storms/MOOS_storm2_06_28_Q.csv", row.names = 1)
MOOS_storm2_06_28_NO3 <- read.csv("Storms/MOOS_storm2_06_28_NO3.csv", row.names = 1)
MOOS_storm2_06_28_fDOM <- read.csv("Storms/MOOS_storm2_06_28_fDOM.csv", row.names = 1)

MOOS_storm3_07_18 <- read.csv("Storms/MOOS_storm3_07_18.csv", row.names = 1)
MOOS_storm3_07_18_Q <- read.csv("Storms/MOOS_storm3_07_18_Q.csv", row.names = 1)
MOOS_storm3_07_18_NO3 <- read.csv("Storms/MOOS_storm3_07_18_NO3.csv", row.names = 1)
MOOS_storm3_07_18_fDOM <- read.csv("Storms/MOOS_storm3_07_18_fDOM.csv", row.names = 1)

MOOS_storm4_07_20 <- read.csv("Storms/MOOS_storm4_07_20.csv", row.names = 1)
MOOS_storm4_07_20_Q <- read.csv("Storms/MOOS_storm4_07_20_Q.csv", row.names = 1)
MOOS_storm4_07_20_NO3 <- read.csv("Storms/MOOS_storm4_07_20_NO3.csv", row.names = 1)
MOOS_storm4_07_20_fDOM <- read.csv("Storms/MOOS_storm4_07_20_fDOM.csv", row.names = 1)

MOOS_storm5_07_27 <- read.csv("Storms/MOOS_storm5_07_27.csv", row.names = 1)
MOOS_storm5_07_27_Q <- read.csv("Storms/MOOS_storm5_07_27_Q.csv", row.names = 1)
MOOS_storm5_07_27_NO3 <- read.csv("Storms/MOOS_storm5_07_27_NO3.csv", row.names = 1)
MOOS_storm5_07_27_fDOM <- read.csv("Storms/MOOS_storm5_07_27_fDOM.csv", row.names = 1)

MOOS_storm6a_08_01 <- read.csv("Storms/MOOS_storm6a_08_01.csv", row.names = 1)
MOOS_storm6a_08_01_Q <- read.csv("Storms/MOOS_storm6a_08_01_Q.csv", row.names = 1)
MOOS_storm6a_08_01_NO3 <- read.csv("Storms/MOOS_storm6a_08_01_NO3.csv", row.names = 1)
MOOS_storm6a_08_01_fDOM <- read.csv("Storms/MOOS_storm6a_08_01_fDOM.csv", row.names = 1)

MOOS_storm6b_08_03 <- read.csv("Storms/MOOS_storm6b_08_03.csv", row.names = 1)
MOOS_storm6b_08_03_Q <- read.csv("Storms/MOOS_storm6b_08_03_Q.csv", row.names = 1)
MOOS_storm6b_08_03_NO3 <- read.csv("Storms/MOOS_storm6b_08_03_NO3.csv", row.names = 1)
MOOS_storm6b_08_03_fDOM <- read.csv("Storms/MOOS_storm6b_08_03_fDOM.csv", row.names = 1)

MOOS_storm7a_08_09 <- read.csv("Storms/MOOS_storm7a_08_09.csv", row.names = 1)
MOOS_storm7a_08_09_Q <- read.csv("Storms/MOOS_storm7a_08_09_Q.csv", row.names = 1)
MOOS_storm7a_08_09_NO3 <- read.csv("Storms/MOOS_storm7a_08_09_NO3.csv", row.names = 1)
MOOS_storm7a_08_09_fDOM <- read.csv("Storms/MOOS_storm7a_08_09_fDOM.csv", row.names = 1)

MOOS_storm7b_08_12 <- read.csv("Storms/MOOS_storm7b_08_12.csv", row.names = 1)
MOOS_storm7b_08_12_Q <- read.csv("Storms/MOOS_storm7b_08_12_Q.csv", row.names = 1)
MOOS_storm7b_08_12_NO3 <- read.csv("Storms/MOOS_storm7b_08_12_NO3.csv", row.names = 1)
MOOS_storm7b_08_12_fDOM <- read.csv("Storms/MOOS_storm7b_08_12_fDOM.csv", row.names = 1)

MOOS_storm8_09_03 <- read.csv("Storms/MOOS_storm8_09_03.csv", row.names = 1)
MOOS_storm8_09_03_Q <- read.csv("Storms/MOOS_storm8_09_03_Q.csv", row.names = 1)
MOOS_storm8_09_03_NO3 <- read.csv("Storms/MOOS_storm8_09_03_NO3.csv", row.names = 1)
MOOS_storm8_09_03_fDOM <- read.csv("Storms/MOOS_storm8_09_03_fDOM.csv", row.names = 1)

MOOS_storm9_09_09 <- read.csv("Storms/MOOS_storm9_09_09.csv", row.names = 1)
MOOS_storm9_09_09_Q <- read.csv("Storms/MOOS_storm9_09_09_Q.csv", row.names = 1)
MOOS_storm9_09_09_NO3 <- read.csv("Storms/MOOS_storm9_09_09_NO3.csv", row.names = 1)
MOOS_storm9_09_09_fDOM <- read.csv("Storms/MOOS_storm9_09_09_fDOM.csv", row.names = 1)

# FRCH #
FRCH_storm1_06_13 <- read.csv("Storms/FRCH_storm1_06_13.csv", row.names = 1)
FRCH_storm1_06_13_Q <- read.csv("Storms/FRCH_storm1_06_13_Q.csv", row.names = 1)
FRCH_storm1_06_13_NO3 <- read.csv("Storms/FRCH_storm1_06_13_NO3.csv", row.names = 1)
FRCH_storm1_06_13_fDOM <- read.csv("Storms/FRCH_storm1_06_13_fDOM.csv", row.names = 1)

FRCH_storm2_06_19 <- read.csv("Storms/FRCH_storm2_06_19.csv", row.names = 1)
FRCH_storm2_06_19_Q <- read.csv("Storms/FRCH_storm2_06_19_Q.csv", row.names = 1)
FRCH_storm2_06_19_NO3 <- read.csv("Storms/FRCH_storm2_06_19_NO3.csv", row.names = 1)
FRCH_storm2_06_19_fDOM <- read.csv("Storms/FRCH_storm2_06_19_fDOM.csv", row.names = 1)

FRCH_storm3a_06_20 <- read.csv("Storms/FRCH_storm3a_06_20.csv", row.names = 1)
FRCH_storm3a_06_20_Q <- read.csv("Storms/FRCH_storm3a_06_20_Q.csv", row.names = 1)
FRCH_storm3a_06_20_NO3 <- read.csv("Storms/FRCH_storm3a_06_20_NO3.csv", row.names = 1)
FRCH_storm3a_06_20_fDOM <- read.csv("Storms/FRCH_storm3a_06_20_fDOM.csv", row.names = 1)

FRCH_storm3b_06_22 <- read.csv("Storms/FRCH_storm3b_06_22.csv", row.names = 1)
FRCH_storm3b_06_22_Q <- read.csv("Storms/FRCH_storm3b_06_22_Q.csv", row.names = 1)
FRCH_storm3b_06_22_NO3 <- read.csv("Storms/FRCH_storm3b_06_22_NO3.csv", row.names = 1)
FRCH_storm3b_06_22_fDOM <- read.csv("Storms/FRCH_storm3b_06_22_fDOM.csv", row.names = 1)

FRCH_storm3c_06_28 <- read.csv("Storms/FRCH_storm3c_06_28.csv", row.names = 1)
FRCH_storm3c_06_28_Q <- read.csv("Storms/FRCH_storm3c_06_28_Q.csv", row.names = 1)
FRCH_storm3c_06_28_NO3 <- read.csv("Storms/FRCH_storm3c_06_28_NO3.csv", row.names = 1)
FRCH_storm3c_06_28_fDOM <- read.csv("Storms/FRCH_storm3c_06_28_fDOM.csv", row.names = 1)

FRCH_storm4a_07_07 <- read.csv("Storms/FRCH_storm4a_07_07.csv", row.names = 1)
FRCH_storm4a_07_07_Q <- read.csv("Storms/FRCH_storm4a_07_07_Q.csv", row.names = 1)
FRCH_storm4a_07_07_NO3 <- read.csv("Storms/FRCH_storm4a_07_07_NO3.csv", row.names = 1)
FRCH_storm4a_07_07_fDOM <- read.csv("Storms/FRCH_storm4a_07_07_fDOM.csv", row.names = 1)

FRCH_storm4b_07_09 <- read.csv("Storms/FRCH_storm4b_07_09.csv", row.names = 1)
FRCH_storm4b_07_09_Q <- read.csv("Storms/FRCH_storm4b_07_09_Q.csv", row.names = 1)
FRCH_storm4b_07_09_NO3 <- read.csv("Storms/FRCH_storm4b_07_09_NO3.csv", row.names = 1)
FRCH_storm4b_07_09_fDOM <- read.csv("Storms/FRCH_storm4b_07_09_fDOM.csv", row.names = 1)

FRCH_storm5_07_16 <- read.csv("Storms/FRCH_storm5_07_16.csv", row.names = 1)
FRCH_storm5_07_16_Q <- read.csv("Storms/FRCH_storm5_07_16_Q.csv", row.names = 1)
FRCH_storm5_07_16_NO3 <- read.csv("Storms/FRCH_storm5_07_16_NO3.csv", row.names = 1)
FRCH_storm5_07_16_fDOM <- read.csv("Storms/FRCH_storm5_07_16_fDOM.csv", row.names = 1)

FRCH_storm6_07_17 <- read.csv("Storms/FRCH_storm6_07_17.csv", row.names = 1)
FRCH_storm6_07_17_Q <- read.csv("Storms/FRCH_storm6_07_17_Q.csv", row.names = 1)
FRCH_storm6_07_17_NO3 <- read.csv("Storms/FRCH_storm6_07_17_NO3.csv", row.names = 1)
FRCH_storm6_07_17_fDOM <- read.csv("Storms/FRCH_storm6_07_17_fDOM.csv", row.names = 1)

FRCH_storm7_07_20 <- read.csv("Storms/FRCH_storm7_07_20.csv", row.names = 1)
FRCH_storm7_07_20_Q <- read.csv("Storms/FRCH_storm7_07_20_Q.csv", row.names = 1)
FRCH_storm7_07_20_NO3 <- read.csv("Storms/FRCH_storm7_07_20_NO3.csv", row.names = 1)
FRCH_storm7_07_20_fDOM <- read.csv("Storms/FRCH_storm7_07_20_fDOM.csv", row.names = 1)

FRCH_storm8_07_26 <- read.csv("Storms/FRCH_storm8_07_26.csv", row.names = 1)
FRCH_storm8_07_26_Q <- read.csv("Storms/FRCH_storm8_07_26_Q.csv", row.names = 1)
FRCH_storm8_07_26_NO3 <- read.csv("Storms/FRCH_storm8_07_26_NO3.csv", row.names = 1)
FRCH_storm8_07_26_fDOM <- read.csv("Storms/FRCH_storm8_07_26_fDOM.csv", row.names = 1)

FRCH_storm9a_08_01 <- read.csv("Storms/FRCH_storm9a_08_01.csv", row.names = 1)
FRCH_storm9a_08_01_Q <- read.csv("Storms/FRCH_storm9a_08_01_Q.csv", row.names = 1)
FRCH_storm9a_08_01_NO3 <- read.csv("Storms/FRCH_storm9a_08_01_NO3.csv", row.names = 1)
FRCH_storm9a_08_01_fDOM <- read.csv("Storms/FRCH_storm9a_08_01_fDOM.csv", row.names = 1)

FRCH_storm9b_08_02 <- read.csv("Storms/FRCH_storm9b_08_02.csv", row.names = 1)
FRCH_storm9b_08_02_Q <- read.csv("Storms/FRCH_storm9b_08_02_Q.csv", row.names = 1)
FRCH_storm9b_08_02_NO3 <- read.csv("Storms/FRCH_storm9b_08_02_NO3.csv", row.names = 1)
FRCH_storm9b_08_02_fDOM <- read.csv("Storms/FRCH_storm9b_08_02_fDOM.csv", row.names = 1)

# VAUL # 
VAUL_storm1a_06_19 <- read.csv("Storms/VAUL_storm1a_06_19.csv", row.names = 1)
VAUL_storm1a_06_19_Q <- read.csv("Storms/VAUL_storm1a_06_19_Q.csv", row.names = 1)
VAUL_storm1a_06_19_NO3 <- read.csv("Storms/VAUL_storm1a_06_19_NO3.csv", row.names = 1)
VAUL_storm1a_06_19_fDOM <- read.csv("Storms/VAUL_storm1a_06_19_fDOM.csv", row.names = 1)

VAUL_storm1b_06_20 <- read.csv("Storms/VAUL_storm1b_06_20.csv", row.names = 1)
VAUL_storm1b_06_20_Q <- read.csv("Storms/VAUL_storm1b_06_20_Q.csv", row.names = 1)
VAUL_storm1b_06_20_NO3 <- read.csv("Storms/VAUL_storm1b_06_20_NO3.csv", row.names = 1)
VAUL_storm1b_06_20_fDOM <- read.csv("Storms/VAUL_storm1b_06_20_fDOM.csv", row.names = 1)

VAUL_storm1c_06_22 <- read.csv("Storms/VAUL_storm1c_06_22.csv", row.names = 1)
VAUL_storm1c_06_22_Q <- read.csv("Storms/VAUL_storm1c_06_22_Q.csv", row.names = 1)
VAUL_storm1c_06_22_NO3 <- read.csv("Storms/VAUL_storm1c_06_22_NO3.csv", row.names = 1)
VAUL_storm1c_06_22_fDOM <- read.csv("Storms/VAUL_storm1c_06_22_fDOM.csv", row.names = 1)

VAUL_storm2_06_28 <- read.csv("Storms/VAUL_storm2_06_28.csv", row.names = 1)
VAUL_storm2_06_28_Q <- read.csv("Storms/VAUL_storm2_06_28_Q.csv", row.names = 1)
VAUL_storm2_06_28_NO3 <- read.csv("Storms/VAUL_storm2_06_28_NO3.csv", row.names = 1)
VAUL_storm2_06_28_fDOM <- read.csv("Storms/VAUL_storm2_06_28_fDOM.csv", row.names = 1)

VAUL_storm3_07_09 <- read.csv("Storms/VAUL_storm3_07_09.csv", row.names = 1)
VAUL_storm3_07_09_Q <- read.csv("Storms/VAUL_storm3_07_09_Q.csv", row.names = 1)
VAUL_storm3_07_09_NO3 <- read.csv("Storms/VAUL_storm3_07_09_NO3.csv", row.names = 1)
VAUL_storm3_07_09_fDOM <- read.csv("Storms/VAUL_storm3_07_09_fDOM.csv", row.names = 1)

VAUL_storm4_07_12 <- read.csv("Storms/VAUL_storm4_07_12.csv", row.names = 1)
VAUL_storm4_07_12_Q <- read.csv("Storms/VAUL_storm4_07_12_Q.csv", row.names = 1)
VAUL_storm4_07_12_NO3 <- read.csv("Storms/VAUL_storm4_07_12_NO3.csv", row.names = 1)
VAUL_storm4_07_12_fDOM <- read.csv("Storms/VAUL_storm4_07_12_fDOM.csv", row.names = 1)

VAUL_storm5_07_27 <- read.csv("Storms/VAUL_storm5_07_27.csv", row.names = 1)
VAUL_storm5_07_27_Q <- read.csv("Storms/VAUL_storm5_07_27_Q.csv", row.names = 1)
VAUL_storm5_07_27_NO3 <- read.csv("Storms/VAUL_storm5_07_27_NO3.csv", row.names = 1)
VAUL_storm5_07_27_fDOM <- read.csv("Storms/VAUL_storm5_07_27_fDOM.csv", row.names = 1)

VAUL_storm6a_08_01 <- read.csv("Storms/VAUL_storm6a_08_01.csv", row.names = 1)
VAUL_storm6a_08_01_Q <- read.csv("Storms/VAUL_storm6a_08_01_Q.csv", row.names = 1)
VAUL_storm6a_08_01_NO3 <- read.csv("Storms/VAUL_storm6a_08_01_NO3.csv", row.names = 1)
VAUL_storm6a_08_01_fDOM <- read.csv("Storms/VAUL_storm6a_08_01_fDOM.csv", row.names = 1)

VAUL_storm6b_08_02 <- read.csv("Storms/VAUL_storm6b_08_02.csv", row.names = 1)
VAUL_storm6b_08_02_Q <- read.csv("Storms/VAUL_storm6b_08_02_Q.csv", row.names = 1)
VAUL_storm6b_08_02_NO3 <- read.csv("Storms/VAUL_storm6b_08_02_NO3.csv", row.names = 1)
VAUL_storm6b_08_02_fDOM <- read.csv("Storms/VAUL_storm6b_08_02_fDOM.csv", row.names = 1)

VAUL_storm7_08_08 <- read.csv("Storms/VAUL_storm7_08_08.csv", row.names = 1)
VAUL_storm7_08_08_Q <- read.csv("Storms/VAUL_storm7_08_08_Q.csv", row.names = 1)
VAUL_storm7_08_08_NO3 <- read.csv("Storms/VAUL_storm7_08_08_NO3.csv", row.names = 1)
VAUL_storm7_08_08_fDOM <- read.csv("Storms/VAUL_storm7_08_08_fDOM.csv", row.names = 1)

VAUL_storm8_08_11 <- read.csv("Storms/VAUL_storm8_08_11.csv", row.names = 1)
VAUL_storm8_08_11_Q <- read.csv("Storms/VAUL_storm8_08_11_Q.csv", row.names = 1)
VAUL_storm8_08_11_NO3 <- read.csv("Storms/VAUL_storm8_08_11_NO3.csv", row.names = 1)
VAUL_storm8_08_11_fDOM <- read.csv("Storms/VAUL_storm8_08_11_fDOM.csv", row.names = 1)

VAUL_storm9_08_12 <- read.csv("Storms/VAUL_storm9_08_12.csv", row.names = 1)
VAUL_storm9_08_12_Q <- read.csv("Storms/VAUL_storm9_08_12_Q.csv", row.names = 1)
VAUL_storm9_08_12_NO3 <- read.csv("Storms/VAUL_storm9_08_12_NO3.csv", row.names = 1)
VAUL_storm9_08_12_fDOM <- read.csv("Storms/VAUL_storm9_08_12_fDOM.csv", row.names = 1)

VAUL_storm10_08_25 <- read.csv("Storms/VAUL_storm10_08_25.csv", row.names = 1)
VAUL_storm10_08_25_Q <- read.csv("Storms/VAUL_storm10_08_25_Q.csv", row.names = 1)
VAUL_storm10_08_25_NO3 <- read.csv("Storms/VAUL_storm10_08_25_NO3.csv", row.names = 1)
VAUL_storm10_08_25_fDOM <- read.csv("Storms/VAUL_storm10_08_25_fDOM.csv", row.names = 1)

VAUL_storm11_08_27 <- read.csv("Storms/VAUL_storm11_08_27.csv", row.names = 1)
VAUL_storm11_08_27_Q <- read.csv("Storms/VAUL_storm11_08_27_Q.csv", row.names = 1)
VAUL_storm11_08_27_NO3 <- read.csv("Storms/VAUL_storm11_08_27_NO3.csv", row.names = 1)
VAUL_storm11_08_27_fDOM <- read.csv("Storms/VAUL_storm11_08_27_fDOM.csv", row.names = 1)

VAUL_storm12_09_01 <- read.csv("Storms/VAUL_storm12_09_01.csv", row.names = 1)
VAUL_storm12_09_01_Q <- read.csv("Storms/VAUL_storm12_09_01_Q.csv", row.names = 1)
VAUL_storm12_09_01_NO3 <- read.csv("Storms/VAUL_storm12_09_01_NO3.csv", row.names = 1)
VAUL_storm12_09_01_fDOM <- read.csv("Storms/VAUL_storm12_09_01_fDOM.csv", row.names = 1)

VAUL_storm13_09_03 <- read.csv("Storms/VAUL_storm13_09_03.csv", row.names = 1)
VAUL_storm13_09_03_Q <- read.csv("Storms/VAUL_storm13_09_03_Q.csv", row.names = 1)
VAUL_storm13_09_03_NO3 <- read.csv("Storms/VAUL_storm13_09_03_NO3.csv", row.names = 1)
VAUL_storm13_09_03_fDOM <- read.csv("Storms/VAUL_storm13_09_03_fDOM.csv", row.names = 1)

VAUL_storm14_09_06 <- read.csv("Storms/VAUL_storm14_09_06.csv", row.names = 1)
VAUL_storm14_09_06_Q <- read.csv("Storms/VAUL_storm14_09_06_Q.csv", row.names = 1)
VAUL_storm14_09_06_NO3 <- read.csv("Storms/VAUL_storm14_09_06_NO3.csv", row.names = 1)
VAUL_storm14_09_06_fDOM <- read.csv("Storms/VAUL_storm14_09_06_fDOM.csv", row.names = 1)

POKE_storm1_06_09 <- read.csv("Storms/POKE_storm1_06_09.csv", row.names = 1)
POKE_storm1_06_09_Q <- read.csv("Storms/POKE_storm1_06_09_Q.csv", row.names = 1)
POKE_storm1_06_09_NO3 <- read.csv("Storms/POKE_storm1_06_09_NO3.csv", row.names = 1)
POKE_storm1_06_09_fDOM <- read.csv("Storms/POKE_storm1_06_09_fDOM.csv", row.names = 1)

POKE_storm2_06_12 <- read.csv("Storms/POKE_storm2_06_12.csv", row.names = 1)
POKE_storm2_06_12_Q <- read.csv("Storms/POKE_storm2_06_12_Q.csv", row.names = 1)
POKE_storm2_06_12_NO3 <- read.csv("Storms/POKE_storm2_06_12_NO3.csv", row.names = 1)
POKE_storm2_06_12_fDOM <- read.csv("Storms/POKE_storm2_06_12_fDOM.csv", row.names = 1)

POKE_storm3_06_15 <- read.csv("Storms/POKE_storm3_06_15.csv", row.names = 1)
POKE_storm3_06_15_Q <- read.csv("Storms/POKE_storm3_06_15_Q.csv", row.names = 1)
POKE_storm3_06_15_NO3 <- read.csv("Storms/POKE_storm3_06_15_NO3.csv", row.names = 1)
POKE_storm3_06_15_fDOM <- read.csv("Storms/POKE_storm3_06_15_fDOM.csv", row.names = 1)

POKE_storm4a_06_19 <- read.csv("Storms/POKE_storm4a_06_19.csv", row.names = 1)
POKE_storm4a_06_19_Q <- read.csv("Storms/POKE_storm4a_06_19_Q.csv", row.names = 1)
POKE_storm4a_06_19_NO3 <- read.csv("Storms/POKE_storm4a_06_19_NO3.csv", row.names = 1)
POKE_storm4a_06_19_fDOM <- read.csv("Storms/POKE_storm4a_06_19_fDOM.csv", row.names = 1)

POKE_storm4b_06_20 <- read.csv("Storms/POKE_storm4b_06_20.csv", row.names = 1)
POKE_storm4b_06_20_Q <- read.csv("Storms/POKE_storm4b_06_20_Q.csv", row.names = 1)
POKE_storm4b_06_20_NO3 <- read.csv("Storms/POKE_storm4b_06_20_NO3.csv", row.names = 1)
POKE_storm4b_06_20_fDOM <- read.csv("Storms/POKE_storm4b_06_20_fDOM.csv", row.names = 1)

POKE_storm4c_06_21 <- read.csv("Storms/POKE_storm4c_06_21.csv", row.names = 1)
POKE_storm4c_06_21_Q <- read.csv("Storms/POKE_storm4c_06_21_Q.csv", row.names = 1)
POKE_storm4c_06_21_NO3 <- read.csv("Storms/POKE_storm4c_06_21_NO3.csv", row.names = 1)
POKE_storm4c_06_21_fDOM <- read.csv("Storms/POKE_storm4c_06_21_fDOM.csv", row.names = 1)

POKE_storm5_06_22 <- read.csv("Storms/POKE_storm5_06_22.csv", row.names = 1)
POKE_storm5_06_22_Q <- read.csv("Storms/POKE_storm5_06_22_Q.csv", row.names = 1)
POKE_storm5_06_22_NO3 <- read.csv("Storms/POKE_storm5_06_22_NO3.csv", row.names = 1)
POKE_storm5_06_22_fDOM <- read.csv("Storms/POKE_storm5_06_22_fDOM.csv", row.names = 1)

POKE_storm6_06_29 <- read.csv("Storms/POKE_storm6_06_29.csv", row.names = 1)
POKE_storm6_06_29_Q <- read.csv("Storms/POKE_storm6_06_29_Q.csv", row.names = 1)
POKE_storm6_06_29_NO3 <- read.csv("Storms/POKE_storm6_06_29_NO3.csv", row.names = 1)
POKE_storm6_06_29_fDOM <- read.csv("Storms/POKE_storm6_06_29_fDOM.csv", row.names = 1)

POKE_storm7_07_04 <- read.csv("Storms/POKE_storm7_07_04.csv", row.names = 1)
POKE_storm7_07_04_Q <- read.csv("Storms/POKE_storm7_07_04_Q.csv", row.names = 1)
POKE_storm7_07_04_NO3 <- read.csv("Storms/POKE_storm7_07_04_NO3.csv", row.names = 1)
POKE_storm7_07_04_fDOM <- read.csv("Storms/POKE_storm7_07_04_fDOM.csv", row.names = 1)

POKE_storm8_07_09 <- read.csv("Storms/POKE_storm8_07_09.csv", row.names = 1)
POKE_storm8_07_09_Q <- read.csv("Storms/POKE_storm8_07_09_Q.csv", row.names = 1)
POKE_storm8_07_09_NO3 <- read.csv("Storms/POKE_storm8_07_09_NO3.csv", row.names = 1)
POKE_storm8_07_09_fDOM <- read.csv("Storms/POKE_storm8_07_09_fDOM.csv", row.names = 1)

POKE_storm9_07_12 <- read.csv("Storms/POKE_storm9_07_12.csv", row.names = 1)
POKE_storm9_07_12_Q <- read.csv("Storms/POKE_storm9_07_12_Q.csv", row.names = 1)
POKE_storm9_07_12_NO3 <- read.csv("Storms/POKE_storm9_07_12_NO3.csv", row.names = 1)
POKE_storm9_07_12_fDOM <- read.csv("Storms/POKE_storm9_07_12_fDOM.csv", row.names = 1)

POKE_storm10_07_16 <- read.csv("Storms/POKE_storm10_07_16.csv", row.names = 1)
POKE_storm10_07_16_Q <- read.csv("Storms/POKE_storm10_07_16_Q.csv", row.names = 1)
POKE_storm10_07_16_NO3 <- read.csv("Storms/POKE_storm10_07_16_NO3.csv", row.names = 1)
POKE_storm10_07_16_fDOM <- read.csv("Storms/POKE_storm10_07_16_fDOM.csv", row.names = 1)

POKE_storm11_07_18 <- read.csv("Storms/POKE_storm11_07_18.csv", row.names = 1)
POKE_storm11_07_18_Q <- read.csv("Storms/POKE_storm11_07_18_Q.csv", row.names = 1)
POKE_storm11_07_18_NO3 <- read.csv("Storms/POKE_storm11_07_18_NO3.csv", row.names = 1)
POKE_storm11_07_18_fDOM <- read.csv("Storms/POKE_storm11_07_18_fDOM.csv", row.names = 1)

POKE_storm12_07_20 <- read.csv("Storms/POKE_storm12_07_20.csv", row.names = 1)
POKE_storm12_07_20_Q <- read.csv("Storms/POKE_storm12_07_20_Q.csv", row.names = 1)
POKE_storm12_07_20_NO3 <- read.csv("Storms/POKE_storm12_07_20_NO3.csv", row.names = 1)
POKE_storm12_07_20_fDOM <- read.csv("Storms/POKE_storm12_07_20_fDOM.csv", row.names = 1)

POKE_storm13_07_24 <- read.csv("Storms/POKE_storm13_07_24.csv", row.names = 1)
POKE_storm13_07_24_Q <- read.csv("Storms/POKE_storm13_07_24_Q.csv", row.names = 1)
POKE_storm13_07_24_NO3 <- read.csv("Storms/POKE_storm13_07_24_NO3.csv", row.names = 1)
POKE_storm13_07_24_fDOM <- read.csv("Storms/POKE_storm13_07_24_fDOM.csv", row.names = 1)

POKE_storm14_07_26 <- read.csv("Storms/POKE_storm14_07_26.csv", row.names = 1)
POKE_storm14_07_26_Q <- read.csv("Storms/POKE_storm14_07_26_Q.csv", row.names = 1)
POKE_storm14_07_26_NO3 <- read.csv("Storms/POKE_storm14_07_26_NO3.csv", row.names = 1)
POKE_storm14_07_26_fDOM <- read.csv("Storms/POKE_storm14_07_26_fDOM.csv", row.names = 1)

POKE_storm15_08_02 <- read.csv("Storms/POKE_storm15_08_02.csv", row.names = 1)
POKE_storm15_08_02_Q <- read.csv("Storms/POKE_storm15_08_02_Q.csv", row.names = 1)
POKE_storm15_08_02_NO3 <- read.csv("Storms/POKE_storm15_08_02_NO3.csv", row.names = 1)
POKE_storm15_08_02_fDOM <- read.csv("Storms/POKE_storm15_08_02_fDOM.csv", row.names = 1)

POKE_storm16_08_12 <- read.csv("Storms/POKE_storm16_08_12.csv", row.names = 1)
POKE_storm16_08_12_Q <- read.csv("Storms/POKE_storm16_08_12_Q.csv", row.names = 1)
POKE_storm16_08_12_NO3 <- read.csv("Storms/POKE_storm16_08_12_NO3.csv", row.names = 1)
POKE_storm16_08_12_fDOM <- read.csv("Storms/POKE_storm16_08_12_fDOM.csv", row.names = 1)

POKE_storm17_08_24 <- read.csv("Storms/POKE_storm17_08_24.csv", row.names = 1)
POKE_storm17_08_24_Q <- read.csv("Storms/POKE_storm17_08_24_Q.csv", row.names = 1)
POKE_storm17_08_24_NO3 <- read.csv("Storms/POKE_storm17_08_24_NO3.csv", row.names = 1)
POKE_storm17_08_24_fDOM <- read.csv("Storms/POKE_storm17_08_24_fDOM.csv", row.names = 1)

POKE_storm18_08_25 <- read.csv("Storms/POKE_storm18_08_25.csv", row.names = 1)
POKE_storm18_08_25_Q <- read.csv("Storms/POKE_storm18_08_25_Q.csv", row.names = 1)
POKE_storm18_08_25_NO3 <- read.csv("Storms/POKE_storm18_08_25_NO3.csv", row.names = 1)
POKE_storm18_08_25_fDOM <- read.csv("Storms/POKE_storm18_08_25_fDOM.csv", row.names = 1)

POKE_storm19_08_27 <- read.csv("Storms/POKE_storm19_08_27.csv", row.names = 1)
POKE_storm19_08_27_Q <- read.csv("Storms/POKE_storm19_08_27_Q.csv", row.names = 1)
POKE_storm19_08_27_NO3 <- read.csv("Storms/POKE_storm19_08_27_NO3.csv", row.names = 1)
POKE_storm19_08_27_fDOM <- read.csv("Storms/POKE_storm19_08_27_fDOM.csv", row.names = 1)

POKE_storm20_09_01 <- read.csv("Storms/POKE_storm20_09_01.csv", row.names = 1)
POKE_storm20_09_01_Q <- read.csv("Storms/POKE_storm20_09_01_Q.csv", row.names = 1)
POKE_storm20_09_01_NO3 <- read.csv("Storms/POKE_storm20_09_01_NO3.csv", row.names = 1)
POKE_storm20_09_01_fDOM <- read.csv("Storms/POKE_storm20_09_01_fDOM.csv", row.names = 1)

POKE_storm21_09_03 <- read.csv("Storms/POKE_storm21_09_03.csv", row.names = 1)
POKE_storm21_09_03_Q <- read.csv("Storms/POKE_storm21_09_03_Q.csv", row.names = 1)
POKE_storm21_09_03_NO3 <- read.csv("Storms/POKE_storm21_09_03_NO3.csv", row.names = 1)
POKE_storm21_09_03_fDOM <- read.csv("Storms/POKE_storm21_09_03_fDOM.csv", row.names = 1)

POKE_storm22a_09_07 <- read.csv("Storms/POKE_storm22a_09_07.csv", row.names = 1)
POKE_storm22a_09_07_Q <- read.csv("Storms/POKE_storm22a_09_07_Q.csv", row.names = 1)
POKE_storm22a_09_07_NO3 <- read.csv("Storms/POKE_storm22a_09_07_NO3.csv", row.names = 1)
POKE_storm22a_09_07_fDOM <- read.csv("Storms/POKE_storm22a_09_07_fDOM.csv", row.names = 1)

POKE_storm22b_09_09 <- read.csv("Storms/POKE_storm22b_09_09.csv", row.names = 1)
POKE_storm22b_09_09_Q <- read.csv("Storms/POKE_storm22b_09_09_Q.csv", row.names = 1)
POKE_storm22b_09_09_NO3 <- read.csv("Storms/POKE_storm22b_09_09_NO3.csv", row.names = 1)
POKE_storm22b_09_09_fDOM <- read.csv("Storms/POKE_storm22b_09_09_fDOM.csv", row.names = 1)

# normalize data #
dfList <- Filter(function(x) is(x, "data.frame"), mget(ls()))

for(i in 1:length(dfList)) {
  dfList[[i]][["datavalue"]] = 
    (dfList[[i]][["datavalue"]] - min(dfList[[i]][["datavalue"]], na.rm=T)) / (max(dfList[[i]][["datavalue"]], na.rm=T) - min(dfList[[i]][["datavalue"]], na.rm=T))
}
list2env(dfList ,.GlobalEnv)

#### fxn: plot hysteresis loop ####
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
  dat.p = ggplot(data = dat_Q, 
                 aes(x=(dat_Q$datavalue), 
                     y=(dat_response$datavalue), 
                     color = as.numeric(dat_Q$valuedatetime))) +
    geom_point() +
    scale_colour_gradientn(colors = rainbow(3)) +
    theme_bw() +
    theme(legend.position="none") + 
    theme(axis.text=element_text(size=12),
          axis.title=element_text(size=14,face="bold")) +
    ylab(paste(site, response_var))+
    xlab("Normalized Discharge") +
    ggtitle(paste("Storm", storm_num))
  return(dat.p)
}

# plot STRT loops #
# NO3
STRT_storm1_05_31_NO3.p = hyst_plot(STRT_storm1_05_31_Q, STRT_storm1_05_31_NO3, "STRT", "NO3", "0531")
STRT_storm2_07_12_NO3.p = hyst_plot(STRT_storm2_07_12_Q, STRT_storm2_07_12_NO3, "STRT", "NO3", "0712")
STRT_storm3a_07_25_NO3.p = hyst_plot(STRT_storm3a_07_25_Q, STRT_storm3a_07_25_NO3, "STRT", "NO3", "0725a")
STRT_storm3b_08_05_NO3.p = hyst_plot(STRT_storm3b_08_05_Q, STRT_storm3b_08_05_NO3, "STRT", "NO3", "0805b")
STRT_storm3c_08_12_NO3.p = hyst_plot(STRT_storm3c_08_12_Q, STRT_storm3c_08_12_NO3, "STRT", "NO3", "0812c")
STRT_storm4_08_15_NO3.p = hyst_plot(STRT_storm4_08_15_Q, STRT_storm4_08_15_NO3, "STRT", "NO3", "0815")
STRT_storm5_08_20_NO3.p = hyst_plot(STRT_storm5_08_20_Q, STRT_storm5_08_20_NO3, "STRT", "NO3", "0820")
STRT_storm6_09_20_NO3.p = hyst_plot(STRT_storm6_09_20_Q, STRT_storm6_09_20_NO3, "STRT", "NO3", "0920")
STRT_storm7_10_01_NO3.p = hyst_plot(STRT_storm7_10_01_Q, STRT_storm7_10_01_NO3, "STRT", "NO3", "1001a")
STRT_storm7b_10_04_NO3.p = hyst_plot(STRT_storm7b_10_04_Q, STRT_storm7b_10_04_NO3, "STRT", "NO3", "1004b")

# fDOM #
STRT_storm1_05_31_fDOM.p = hyst_plot(STRT_storm1_05_31_Q, STRT_storm1_05_31_fDOM, "STRT", "fDOM", "0531")
STRT_storm2_07_12_fDOM.p = hyst_plot(STRT_storm2_07_12_Q, STRT_storm2_07_12_fDOM, "STRT", "fDOM", "0712")
STRT_storm3a_07_25_fDOM.p = hyst_plot(STRT_storm3a_07_25_Q, STRT_storm3a_07_25_fDOM, "STRT", "fDOM", "0725a")
STRT_storm3b_08_05_fDOM.p = hyst_plot(STRT_storm3b_08_05_Q, STRT_storm3b_08_05_fDOM, "STRT", "fDOM", "0805b")
STRT_storm3c_08_12_fDOM.p = hyst_plot(STRT_storm3c_08_12_Q, STRT_storm3c_08_12_fDOM, "STRT", "fDOM", "0812c")
STRT_storm4_08_15_fDOM.p = hyst_plot(STRT_storm4_08_15_Q, STRT_storm4_08_15_fDOM, "STRT", "fDOM", "0815")
STRT_storm5_08_20_fDOM.p = hyst_plot(STRT_storm5_08_20_Q, STRT_storm5_08_20_fDOM, "STRT", "fDOM", "0820")
STRT_storm6_09_20_fDOM.p = hyst_plot(STRT_storm6_09_20_Q, STRT_storm6_09_20_fDOM, "STRT", "fDOM", "0920")
STRT_storm7_10_01_fDOM.p = hyst_plot(STRT_storm7_10_01_Q, STRT_storm7_10_01_fDOM, "STRT", "fDOM", "1001a")
STRT_storm7b_10_04_fDOM.p = hyst_plot(STRT_storm7b_10_04_Q, STRT_storm7b_10_04_fDOM, "STRT", "fDOM", "1004b")

# SPC #
STRT_storm1_05_31_SPC.p = hyst_plot(STRT_storm1_05_31_Q, STRT_storm1_05_31_SPC, "STRT", "SPC", "0531")
STRT_storm2_07_12_SPC.p = hyst_plot(STRT_storm2_07_12_Q, STRT_storm2_07_12_SPC, "STRT", "SPC", "0712")
STRT_storm3a_07_25_SPC.p = hyst_plot(STRT_storm3a_07_25_Q, STRT_storm3a_07_25_SPC, "STRT", "SPC", "0725a")
STRT_storm3b_08_05_SPC.p = hyst_plot(STRT_storm3b_08_05_Q, STRT_storm3b_08_05_SPC, "STRT", "SPC", "0805b")
STRT_storm3c_08_12_SPC.p = hyst_plot(STRT_storm3c_08_12_Q, STRT_storm3c_08_12_SPC, "STRT", "SPC", "0812c")
STRT_storm4_08_15_SPC.p = hyst_plot(STRT_storm4_08_15_Q, STRT_storm4_08_15_SPC, "STRT", "SPC", "0815")
STRT_storm5_08_20_SPC.p = hyst_plot(STRT_storm5_08_20_Q, STRT_storm5_08_20_SPC, "STRT", "SPC", "0820")
STRT_storm6_09_20_SPC.p = hyst_plot(STRT_storm6_09_20_Q, STRT_storm6_09_20_SPC, "STRT", "SPC", "0920")
STRT_storm7_10_01_SPC.p = hyst_plot(STRT_storm7_10_01_Q, STRT_storm7_10_01_SPC, "STRT", "SPC", "1001a")
STRT_storm7b_10_04_SPC.p = hyst_plot(STRT_storm7b_10_04_Q, STRT_storm7b_10_04_SPC, "STRT", "SPC", "1004b")

# turb
STRT_storm1_05_31_turb.p = hyst_plot(STRT_storm1_05_31_Q, STRT_storm1_05_31_turb, "STRT", "turb", "0531")
STRT_storm2_07_12_turb.p = hyst_plot(STRT_storm2_07_12_Q, STRT_storm2_07_12_turb, "STRT", "turb", "0712")
STRT_storm3a_07_25_turb.p = hyst_plot(STRT_storm3a_07_25_Q, STRT_storm3a_07_25_turb, "STRT", "turb", "0725a")
STRT_storm3b_08_05_turb.p = hyst_plot(STRT_storm3b_08_05_Q, STRT_storm3b_08_05_turb, "STRT", "turb", "0805b")
STRT_storm3c_08_12_turb.p = hyst_plot(STRT_storm3c_08_12_Q, STRT_storm3c_08_12_turb, "STRT", "turb", "0812c")
STRT_storm4_08_15_turb.p = hyst_plot(STRT_storm4_08_15_Q, STRT_storm4_08_15_turb, "STRT", "turb", "0815")
STRT_storm5_08_20_turb.p = hyst_plot(STRT_storm5_08_20_Q, STRT_storm5_08_20_turb, "STRT", "turb", "0820")
STRT_storm6_09_20_turb.p = hyst_plot(STRT_storm6_09_20_Q, STRT_storm6_09_20_turb, "STRT", "turb", "0920")
STRT_storm7_10_01_turb.p = hyst_plot(STRT_storm7_10_01_Q, STRT_storm7_10_01_turb, "STRT", "turb", "1001a")
STRT_storm7b_10_04_turb.p = hyst_plot(STRT_storm7b_10_04_Q, STRT_storm7b_10_04_turb, "STRT", "turb", "1004b")

# Multiplots of STRT storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

multiplot(STRT_storm1_05_31_NO3.p, STRT_storm1_05_31_fDOM.p,
          STRT_storm1_05_31_SPC.p, STRT_storm1_05_31_turb.p)  #works 
multiplot(STRT_storm2_07_12_NO3.p, STRT_storm2_07_12_fDOM.p,
          STRT_storm2_07_12_SPC.p, STRT_storm2_07_12_turb.p)  # works 
multiplot(STRT_storm3a_07_25_NO3.p, STRT_storm3a_07_25_fDOM.p,
          STRT_storm3a_07_25_SPC.p, STRT_storm3a_07_25_turb.p)  # works 
multiplot(STRT_storm3b_08_05_NO3.p, STRT_storm3b_08_05_fDOM.p,
          STRT_storm3b_08_05_SPC.p, STRT_storm3b_08_05_turb.p)  # works 
multiplot(STRT_storm3c_08_12_NO3.p, STRT_storm3c_08_12_fDOM.p,
          STRT_storm3c_08_12_SPC.p, STRT_storm3c_08_12_turb.p)  # works 
multiplot(STRT_storm4_08_15_NO3.p, STRT_storm4_08_15_fDOM.p,
          STRT_storm4_08_15_SPC.p, STRT_storm4_08_15_turb.p)  # works 
multiplot(STRT_storm5_08_20_NO3.p, STRT_storm5_08_20_fDOM.p,
          STRT_storm5_08_20_SPC.p, STRT_storm5_08_20_turb.p)  # works 
multiplot(STRT_storm6_09_20_NO3.p, STRT_storm6_09_20_fDOM.p,
          STRT_storm6_09_20_SPC.p, STRT_storm6_09_20_turb.p)  # works 
multiplot(STRT_storm7_10_01_NO3.p, STRT_storm7_10_01_fDOM.p,
          STRT_storm7_10_01_SPC.p, STRT_storm7_10_01_turb.p)  # works 
multiplot(STRT_storm7b_10_04_NO3.p, STRT_storm7b_10_04_fDOM.p,
          STRT_storm7b_10_04_SPC.p, STRT_storm7b_10_04_turb.p)  # works 


multiplot(STRT_storm1_05_31_NO3.p, STRT_storm1_05_31_fDOM.p, STRT_storm1_05_31_SPC.p, STRT_storm1_05_31_turb.p,
          STRT_storm2_07_12_NO3.p, STRT_storm2_07_12_fDOM.p, STRT_storm2_07_12_SPC.p, STRT_storm2_07_12_turb.p,
          STRT_storm3a_07_25_NO3.p, STRT_storm3a_07_25_fDOM.p, STRT_storm3a_07_25_SPC.p, STRT_storm3a_07_25_turb.p,
          STRT_storm3b_08_05_NO3.p, STRT_storm3b_08_05_fDOM.p,  STRT_storm3b_08_05_SPC.p, STRT_storm3b_08_05_turb.p,
          STRT_storm3c_08_12_NO3.p, STRT_storm3c_08_12_fDOM.p, STRT_storm3c_08_12_SPC.p, STRT_storm3c_08_12_turb.p,
          STRT_storm4_08_15_NO3.p, STRT_storm4_08_15_fDOM.p, STRT_storm4_08_15_SPC.p, STRT_storm4_08_15_turb.p,
          STRT_storm5_08_20_NO3.p, STRT_storm5_08_20_fDOM.p, STRT_storm5_08_20_SPC.p, STRT_storm5_08_20_turb.p,
          STRT_storm6_09_20_NO3.p, STRT_storm6_09_20_fDOM.p, STRT_storm6_09_20_SPC.p, STRT_storm6_09_20_turb.p,
          STRT_storm7_10_01_NO3.p, STRT_storm7_10_01_fDOM.p, STRT_storm7_10_01_SPC.p, STRT_storm7_10_01_turb.p,
          STRT_storm7b_10_04_NO3.p, STRT_storm7b_10_04_fDOM.p, STRT_storm7b_10_04_SPC.p, STRT_storm7b_10_04_turb.p,
          cols = 7)

# export pdf 20 x 30

# Make MOOS loops #
# NO3
MOOS_storm1_06_01_NO3.p = hyst_plot(MOOS_storm1_06_01_Q, MOOS_storm1_06_01_NO3, "MOOS", "NO3", "0601")
MOOS_storm3_07_12_NO3.p = hyst_plot(MOOS_storm3_07_12_Q, MOOS_storm3_07_12_NO3, "MOOS", "NO3", "0712")
MOOS_storm4_07_25_NO3.p = hyst_plot(MOOS_storm4_07_25_Q, MOOS_storm4_07_25_NO3, "MOOS", "NO3", "0725")
MOOS_storm5_07_29_NO3.p = hyst_plot(MOOS_storm5_07_29_Q, MOOS_storm5_07_29_NO3, "MOOS", "NO3", "0729")
MOOS_storm6a_08_01_NO3.p = hyst_plot(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_NO3, "MOOS", "NO3", "0801a")
MOOS_storm6b_08_02_NO3.p = hyst_plot(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_NO3, "MOOS", "NO3", "0802b")
MOOS_storm6c_08_03_NO3.p = hyst_plot(MOOS_storm6c_08_03_Q, MOOS_storm6c_08_03_NO3, "MOOS", "NO3", "0803c")
MOOS_storm6d_08_05_NO3.p = hyst_plot(MOOS_storm6d_08_05_Q, MOOS_storm6d_08_05_NO3, "MOOS", "NO3", "0805d")
MOOS_storm7a_08_13_NO3.p = hyst_plot(MOOS_storm7a_08_13_Q, MOOS_storm7a_08_13_NO3, "MOOS", "NO3", "0813a")
MOOS_storm7b_08_14_NO3.p = hyst_plot(MOOS_storm7b_08_14_Q, MOOS_storm7b_08_14_NO3, "MOOS", "NO3", "0814b")
MOOS_storm7c_08_15_NO3.p = hyst_plot(MOOS_storm7c_08_15_Q, MOOS_storm7c_08_15_NO3, "MOOS", "NO3", "0815c")
MOOS_storm8_09_21_NO3.p = hyst_plot(MOOS_storm8_09_21_Q, MOOS_storm8_09_21_NO3, "MOOS", "NO3", "0921")
MOOS_storm9_10_02_NO3.p = hyst_plot(MOOS_storm9_10_02_Q, MOOS_storm9_10_02_NO3, "MOOS", "NO3", "1002")

# fDOM
MOOS_storm1_06_01_fDOM.p = hyst_plot(MOOS_storm1_06_01_Q, MOOS_storm1_06_01_fDOM, "MOOS", "fDOM", "0601")
MOOS_storm3_07_12_fDOM.p = hyst_plot(MOOS_storm3_07_12_Q, MOOS_storm3_07_12_fDOM, "MOOS", "fDOM", "0712")
MOOS_storm4_07_25_fDOM.p = hyst_plot(MOOS_storm4_07_25_Q, MOOS_storm4_07_25_fDOM, "MOOS", "fDOM", "0725")
MOOS_storm5_07_29_fDOM.p = hyst_plot(MOOS_storm5_07_29_Q, MOOS_storm5_07_29_fDOM, "MOOS", "fDOM", "0729")
MOOS_storm6a_08_01_fDOM.p = hyst_plot(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_fDOM, "MOOS", "fDOM", "0801a")
MOOS_storm6b_08_02_fDOM.p = hyst_plot(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_fDOM, "MOOS", "fDOM", "0802b")
MOOS_storm6c_08_03_fDOM.p = hyst_plot(MOOS_storm6c_08_03_Q, MOOS_storm6c_08_03_fDOM, "MOOS", "fDOM", "0803c")
MOOS_storm6d_08_05_fDOM.p = hyst_plot(MOOS_storm6d_08_05_Q, MOOS_storm6d_08_05_fDOM, "MOOS", "fDOM", "0805d")
MOOS_storm7a_08_13_fDOM.p = hyst_plot(MOOS_storm7a_08_13_Q, MOOS_storm7a_08_13_fDOM, "MOOS", "fDOM", "0813a")
MOOS_storm7b_08_14_fDOM.p = hyst_plot(MOOS_storm7b_08_14_Q, MOOS_storm7b_08_14_fDOM, "MOOS", "fDOM", "0814b")
MOOS_storm7c_08_15_fDOM.p = hyst_plot(MOOS_storm7c_08_15_Q, MOOS_storm7c_08_15_fDOM, "MOOS", "fDOM", "0815c")
MOOS_storm8_09_21_fDOM.p = hyst_plot(MOOS_storm8_09_21_Q, MOOS_storm8_09_21_fDOM, "MOOS", "fDOM", "0921")
MOOS_storm9_10_02_fDOM.p = hyst_plot(MOOS_storm9_10_02_Q, MOOS_storm9_10_02_fDOM, "MOOS", "fDOM", "1002")

# SPC
MOOS_storm1_06_01_SPC.p = hyst_plot(MOOS_storm1_06_01_Q, MOOS_storm1_06_01_SPC, "MOOS", "SPC", "0601")
MOOS_storm3_07_12_SPC.p = hyst_plot(MOOS_storm3_07_12_Q, MOOS_storm3_07_12_SPC, "MOOS", "SPC", "0712")
MOOS_storm4_07_25_SPC.p = hyst_plot(MOOS_storm4_07_25_Q, MOOS_storm4_07_25_SPC, "MOOS", "SPC", "0725")
MOOS_storm5_07_29_SPC.p = hyst_plot(MOOS_storm5_07_29_Q, MOOS_storm5_07_29_SPC, "MOOS", "SPC", "0729")
MOOS_storm6a_08_01_SPC.p = hyst_plot(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_SPC, "MOOS", "SPC", "0801a")
MOOS_storm6b_08_02_SPC.p = hyst_plot(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_SPC, "MOOS", "SPC", "0802b")
MOOS_storm6c_08_03_SPC.p = hyst_plot(MOOS_storm6c_08_03_Q, MOOS_storm6c_08_03_SPC, "MOOS", "SPC", "0803c")
MOOS_storm6d_08_05_SPC.p = hyst_plot(MOOS_storm6d_08_05_Q, MOOS_storm6d_08_05_SPC, "MOOS", "SPC", "0805d")
MOOS_storm7a_08_13_SPC.p = hyst_plot(MOOS_storm7a_08_13_Q, MOOS_storm7a_08_13_SPC, "MOOS", "SPC", "0813a")
MOOS_storm7b_08_14_SPC.p = hyst_plot(MOOS_storm7b_08_14_Q, MOOS_storm7b_08_14_SPC, "MOOS", "SPC", "0814b")
MOOS_storm7c_08_15_SPC.p = hyst_plot(MOOS_storm7c_08_15_Q, MOOS_storm7c_08_15_SPC, "MOOS", "SPC", "0815c")
MOOS_storm8_09_21_SPC.p = hyst_plot(MOOS_storm8_09_21_Q, MOOS_storm8_09_21_SPC, "MOOS", "SPC", "0921")
MOOS_storm9_10_02_SPC.p = hyst_plot(MOOS_storm9_10_02_Q, MOOS_storm9_10_02_SPC, "MOOS", "SPC", "1002")

# turb
MOOS_storm1_06_01_turb.p = hyst_plot(MOOS_storm1_06_01_Q, MOOS_storm1_06_01_turb, "MOOS", "turb", "0601")
MOOS_storm3_07_12_turb.p = hyst_plot(MOOS_storm3_07_12_Q, MOOS_storm3_07_12_turb, "MOOS", "turb", "0712")
MOOS_storm4_07_25_turb.p = hyst_plot(MOOS_storm4_07_25_Q, MOOS_storm4_07_25_turb, "MOOS", "turb", "0725")
MOOS_storm5_07_29_turb.p = hyst_plot(MOOS_storm5_07_29_Q, MOOS_storm5_07_29_turb, "MOOS", "turb", "0729")
MOOS_storm6a_08_01_turb.p = hyst_plot(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_turb, "MOOS", "turb", "0801a")
MOOS_storm6b_08_02_turb.p = hyst_plot(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_turb, "MOOS", "turb", "0802b")
MOOS_storm6c_08_03_turb.p = hyst_plot(MOOS_storm6c_08_03_Q, MOOS_storm6c_08_03_turb, "MOOS", "turb", "0803c")
MOOS_storm6d_08_05_turb.p = hyst_plot(MOOS_storm6d_08_05_Q, MOOS_storm6d_08_05_turb, "MOOS", "turb", "0805d")
MOOS_storm7a_08_13_turb.p = hyst_plot(MOOS_storm7a_08_13_Q, MOOS_storm7a_08_13_turb, "MOOS", "turb", "0813a")
MOOS_storm7b_08_14_turb.p = hyst_plot(MOOS_storm7b_08_14_Q, MOOS_storm7b_08_14_turb, "MOOS", "turb", "0814b")
MOOS_storm7c_08_15_turb.p = hyst_plot(MOOS_storm7c_08_15_Q, MOOS_storm7c_08_15_turb, "MOOS", "turb", "0815c")
MOOS_storm8_09_21_turb.p = hyst_plot(MOOS_storm8_09_21_Q, MOOS_storm8_09_21_turb, "MOOS", "turb", "0921")
MOOS_storm9_10_02_turb.p = hyst_plot(MOOS_storm9_10_02_Q, MOOS_storm9_10_02_turb, "MOOS", "turb", "1002")

# Multiplots of MOOS storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

multiplot(MOOS_storm1_06_01_NO3.p, MOOS_storm1_06_01_fDOM.p,MOOS_storm1_06_01_SPC.p, MOOS_storm1_06_01_turb.p)  #works 
multiplot(MOOS_storm3_07_12_NO3.p, MOOS_storm3_07_12_fDOM.p,MOOS_storm3_07_12_SPC.p, MOOS_storm3_07_12_turb.p)  #works 
multiplot(MOOS_storm4_07_25_NO3.p, MOOS_storm4_07_25_fDOM.p,MOOS_storm4_07_25_SPC.p, MOOS_storm4_07_25_turb.p)  # no NO3 but works 
multiplot(MOOS_storm5_07_29_NO3.p, MOOS_storm5_07_29_fDOM.p,MOOS_storm5_07_29_SPC.p, MOOS_storm5_07_29_turb.p)  #works 
multiplot(MOOS_storm6a_08_01_NO3.p, MOOS_storm6a_08_01_fDOM.p,MOOS_storm6a_08_01_SPC.p, MOOS_storm6a_08_01_turb.p)  #works 
multiplot(MOOS_storm6b_08_02_NO3.p, MOOS_storm6b_08_02_fDOM.p,MOOS_storm6b_08_02_SPC.p, MOOS_storm6b_08_02_turb.p)  #works 
multiplot(MOOS_storm6c_08_03_NO3.p, MOOS_storm6c_08_03_fDOM.p,MOOS_storm6c_08_03_SPC.p, MOOS_storm6c_08_03_turb.p)  #works 
multiplot(MOOS_storm6d_08_05_NO3.p, MOOS_storm6d_08_05_fDOM.p,MOOS_storm6d_08_05_SPC.p, MOOS_storm6d_08_05_turb.p)  #works 
multiplot(MOOS_storm7a_08_13_NO3.p, MOOS_storm7a_08_13_fDOM.p,MOOS_storm7a_08_13_SPC.p, MOOS_storm7a_08_13_turb.p)  #works 
multiplot(MOOS_storm7b_08_14_NO3.p, MOOS_storm7b_08_14_fDOM.p,MOOS_storm7b_08_14_SPC.p, MOOS_storm7b_08_14_turb.p)  #works 
multiplot(MOOS_storm7c_08_15_NO3.p, MOOS_storm7c_08_15_fDOM.p,MOOS_storm7c_08_15_SPC.p, MOOS_storm7c_08_15_turb.p)  #works 
multiplot(MOOS_storm8_09_21_NO3.p, MOOS_storm8_09_21_fDOM.p,MOOS_storm8_09_21_SPC.p, MOOS_storm8_09_21_turb.p)  #works 
multiplot(MOOS_storm9_10_02_NO3.p, MOOS_storm9_10_02_fDOM.p,MOOS_storm9_10_02_SPC.p, MOOS_storm9_10_02_turb.p)  #works 

multiplot(MOOS_storm1_06_01_NO3.p, MOOS_storm1_06_01_fDOM.p, MOOS_storm1_06_01_SPC.p, MOOS_storm1_06_01_turb.p,
          MOOS_storm3_07_12_NO3.p, MOOS_storm3_07_12_fDOM.p,MOOS_storm3_07_12_SPC.p, MOOS_storm3_07_12_turb.p,
          MOOS_storm4_07_25_NO3.p, MOOS_storm4_07_25_fDOM.p,MOOS_storm4_07_25_SPC.p, MOOS_storm4_07_25_turb.p,
          MOOS_storm5_07_29_NO3.p, MOOS_storm5_07_29_fDOM.p,MOOS_storm5_07_29_SPC.p, MOOS_storm5_07_29_turb.p,
          MOOS_storm6a_08_01_NO3.p, MOOS_storm6a_08_01_fDOM.p,MOOS_storm6a_08_01_SPC.p, MOOS_storm6a_08_01_turb.p,
          MOOS_storm6b_08_02_NO3.p, MOOS_storm6b_08_02_fDOM.p,MOOS_storm6b_08_02_SPC.p, MOOS_storm6b_08_02_turb.p,
          MOOS_storm6c_08_03_NO3.p, MOOS_storm6c_08_03_fDOM.p,MOOS_storm6c_08_03_SPC.p, MOOS_storm6c_08_03_turb.p,
          MOOS_storm6d_08_05_NO3.p, MOOS_storm6d_08_05_fDOM.p,MOOS_storm6d_08_05_SPC.p, MOOS_storm6d_08_05_turb.p,
          MOOS_storm7a_08_13_NO3.p, MOOS_storm7a_08_13_fDOM.p,MOOS_storm7a_08_13_SPC.p, MOOS_storm7a_08_13_turb.p,
          MOOS_storm7b_08_14_NO3.p, MOOS_storm7b_08_14_fDOM.p,MOOS_storm7b_08_14_SPC.p, MOOS_storm7b_08_14_turb.p,
          MOOS_storm7c_08_15_NO3.p, MOOS_storm7c_08_15_fDOM.p,MOOS_storm7c_08_15_SPC.p, MOOS_storm7c_08_15_turb.p,
          MOOS_storm8_09_21_NO3.p, MOOS_storm8_09_21_fDOM.p,MOOS_storm8_09_21_SPC.p, MOOS_storm8_09_21_turb.p,
          MOOS_storm9_10_02_NO3.p, MOOS_storm9_10_02_fDOM.p,MOOS_storm9_10_02_SPC.p, MOOS_storm9_10_02_turb.p,
          cols = 7)
# export pdf 20 x 30

# Make FRCH loops #
# NO3
FRCH_storm1_05_31_NO3.p = hyst_plot(FRCH_storm1_05_31_Q, FRCH_storm1_05_31_NO3, "FRCH", "NO3", "0531")
FRCH_storm2_06_15_NO3.p = hyst_plot(FRCH_storm2_06_15_Q, FRCH_storm2_06_15_NO3, "FRCH", "NO3", "0615")
FRCH_storm3_06_18_NO3.p = hyst_plot(FRCH_storm3_06_18_Q, FRCH_storm3_06_18_NO3, "FRCH", "NO3", "0618")
FRCH_storm4_06_20_NO3.p = hyst_plot(FRCH_storm4_06_20_Q, FRCH_storm4_06_20_NO3, "FRCH", "NO3", "0620")
FRCH_storm5_06_22_NO3.p = hyst_plot(FRCH_storm5_06_22_Q, FRCH_storm5_06_22_NO3, "FRCH", "NO3", "0622")
FRCH_storm6_07_12_NO3.p = hyst_plot(FRCH_storm6_07_12_Q, FRCH_storm6_07_12_NO3, "FRCH", "NO3", "0712")
FRCH_storm7_07_25_NO3.p = hyst_plot(FRCH_storm7_07_25_Q, FRCH_storm7_07_25_NO3, "FRCH", "NO3", "0725")
FRCH_storm8_07_28_NO3.p = hyst_plot(FRCH_storm8_07_28_Q, FRCH_storm8_07_28_NO3, "FRCH", "NO3", "0728")
FRCH_storm9a_07_29_NO3.p = hyst_plot(FRCH_storm9a_07_29_Q, FRCH_storm9a_07_29_NO3, "FRCH", "NO3", "0729a")
FRCH_storm9b_07_30_NO3.p = hyst_plot(FRCH_storm9b_07_30_Q, FRCH_storm9b_07_30_NO3, "FRCH", "NO3", "0730b")
FRCH_storm10a_08_01_NO3.p = hyst_plot(FRCH_storm10a_08_01_Q, FRCH_storm10a_08_01_NO3, "FRCH", "NO3", "0801a")
FRCH_storm10b_08_02_NO3.p = hyst_plot(FRCH_storm10b_08_02_Q, FRCH_storm10b_08_02_NO3, "FRCH", "NO3", "0802b")
FRCH_storm10c_08_03_NO3.p = hyst_plot(FRCH_storm10c_08_03_Q, FRCH_storm10c_08_03_NO3, "FRCH", "NO3", "0803c")
FRCH_storm11_08_05_NO3.p = hyst_plot(FRCH_storm11_08_05_Q, FRCH_storm11_08_05_NO3, "FRCH", "NO3", "0805")
FRCH_storm12a_08_12_NO3.p = hyst_plot(FRCH_storm12a_08_12_Q, FRCH_storm12a_08_12_NO3, "FRCH", "NO3", "0812a")
FRCH_storm12b_08_14_NO3.p = hyst_plot(FRCH_storm12b_08_14_Q, FRCH_storm12b_08_14_NO3, "FRCH", "NO3", "0814b")
FRCH_storm12c_08_15_NO3.p = hyst_plot(FRCH_storm12c_08_15_Q, FRCH_storm12c_08_15_NO3, "FRCH", "NO3", "0815c")
FRCH_storm12d_08_21_NO3.p = hyst_plot(FRCH_storm12d_08_21_Q, FRCH_storm12d_08_21_NO3, "FRCH", "NO3", "0821d")
FRCH_storm13_09_20_NO3.p = hyst_plot(FRCH_storm13_09_20_Q, FRCH_storm13_09_20_NO3, "FRCH", "NO3", "0920")
FRCH_storm14_10_01_NO3.p = hyst_plot(FRCH_storm14_10_01_Q, FRCH_storm14_10_01_NO3, "FRCH", "NO3", "1001")

# fDOM
FRCH_storm1_05_31_fDOM.p = hyst_plot(FRCH_storm1_05_31_Q, FRCH_storm1_05_31_fDOM, "FRCH", "fDOM", "0531")
FRCH_storm2_06_15_fDOM.p = hyst_plot(FRCH_storm2_06_15_Q, FRCH_storm2_06_15_fDOM, "FRCH", "fDOM", "0615")
FRCH_storm3_06_18_fDOM.p = hyst_plot(FRCH_storm3_06_18_Q, FRCH_storm3_06_18_fDOM, "FRCH", "fDOM", "0618")
FRCH_storm4_06_20_fDOM.p = hyst_plot(FRCH_storm4_06_20_Q, FRCH_storm4_06_20_fDOM, "FRCH", "fDOM", "0620")
FRCH_storm5_06_22_fDOM.p = hyst_plot(FRCH_storm5_06_22_Q, FRCH_storm5_06_22_fDOM, "FRCH", "fDOM", "0622")
FRCH_storm6_07_12_fDOM.p = hyst_plot(FRCH_storm6_07_12_Q, FRCH_storm6_07_12_fDOM, "FRCH", "fDOM", "0712")
FRCH_storm7_07_25_fDOM.p = hyst_plot(FRCH_storm7_07_25_Q, FRCH_storm7_07_25_fDOM, "FRCH", "fDOM", "0725")
FRCH_storm8_07_28_fDOM.p = hyst_plot(FRCH_storm8_07_28_Q, FRCH_storm8_07_28_fDOM, "FRCH", "fDOM", "0728")
FRCH_storm9a_07_29_fDOM.p = hyst_plot(FRCH_storm9a_07_29_Q, FRCH_storm9a_07_29_fDOM, "FRCH", "fDOM", "0729a")
FRCH_storm9b_07_30_fDOM.p = hyst_plot(FRCH_storm9b_07_30_Q, FRCH_storm9b_07_30_fDOM, "FRCH", "fDOM", "0730b")
FRCH_storm10a_08_01_fDOM.p = hyst_plot(FRCH_storm10a_08_01_Q, FRCH_storm10a_08_01_fDOM, "FRCH", "fDOM", "0801a")
FRCH_storm10b_08_02_fDOM.p = hyst_plot(FRCH_storm10b_08_02_Q, FRCH_storm10b_08_02_fDOM, "FRCH", "fDOM", "0802b")
FRCH_storm10c_08_03_fDOM.p = hyst_plot(FRCH_storm10c_08_03_Q, FRCH_storm10c_08_03_fDOM, "FRCH", "fDOM", "0803c")
FRCH_storm11_08_05_fDOM.p = hyst_plot(FRCH_storm11_08_05_Q, FRCH_storm11_08_05_fDOM, "FRCH", "fDOM", "0805")
FRCH_storm12a_08_12_fDOM.p = hyst_plot(FRCH_storm12a_08_12_Q, FRCH_storm12a_08_12_fDOM, "FRCH", "fDOM", "0812a")
FRCH_storm12b_08_14_fDOM.p = hyst_plot(FRCH_storm12b_08_14_Q, FRCH_storm12b_08_14_fDOM, "FRCH", "fDOM", "0814b")
FRCH_storm12c_08_15_fDOM.p = hyst_plot(FRCH_storm12c_08_15_Q, FRCH_storm12c_08_15_fDOM, "FRCH", "fDOM", "0815c")
FRCH_storm12d_08_21_fDOM.p = hyst_plot(FRCH_storm12d_08_21_Q, FRCH_storm12d_08_21_fDOM, "FRCH", "fDOM", "0821d")
FRCH_storm13_09_20_fDOM.p = hyst_plot(FRCH_storm13_09_20_Q, FRCH_storm13_09_20_fDOM, "FRCH", "fDOM", "0920")
FRCH_storm14_10_01_fDOM.p = hyst_plot(FRCH_storm14_10_01_Q, FRCH_storm14_10_01_fDOM, "FRCH", "fDOM", "1001")

# SPC
FRCH_storm1_05_31_SPC.p = hyst_plot(FRCH_storm1_05_31_Q, FRCH_storm1_05_31_SPC, "FRCH", "SPC", "0531")
FRCH_storm2_06_15_SPC.p = hyst_plot(FRCH_storm2_06_15_Q, FRCH_storm2_06_15_SPC, "FRCH", "SPC", "0615")
FRCH_storm3_06_18_SPC.p = hyst_plot(FRCH_storm3_06_18_Q, FRCH_storm3_06_18_SPC, "FRCH", "SPC", "0618")
FRCH_storm4_06_20_SPC.p = hyst_plot(FRCH_storm4_06_20_Q, FRCH_storm4_06_20_SPC, "FRCH", "SPC", "0620")
FRCH_storm5_06_22_SPC.p = hyst_plot(FRCH_storm5_06_22_Q, FRCH_storm5_06_22_SPC, "FRCH", "SPC", "0622")
FRCH_storm6_07_12_SPC.p = hyst_plot(FRCH_storm6_07_12_Q, FRCH_storm6_07_12_SPC, "FRCH", "SPC", "0712")
FRCH_storm7_07_25_SPC.p = hyst_plot(FRCH_storm7_07_25_Q, FRCH_storm7_07_25_SPC, "FRCH", "SPC", "0725")
FRCH_storm8_07_28_SPC.p = hyst_plot(FRCH_storm8_07_28_Q, FRCH_storm8_07_28_SPC, "FRCH", "SPC", "0728")
FRCH_storm9a_07_29_SPC.p = hyst_plot(FRCH_storm9a_07_29_Q, FRCH_storm9a_07_29_SPC, "FRCH", "SPC", "0729a")
FRCH_storm9b_07_30_SPC.p = hyst_plot(FRCH_storm9b_07_30_Q, FRCH_storm9b_07_30_SPC, "FRCH", "SPC", "0730b")
FRCH_storm10a_08_01_SPC.p = hyst_plot(FRCH_storm10a_08_01_Q, FRCH_storm10a_08_01_SPC, "FRCH", "SPC", "0801a")
FRCH_storm10b_08_02_SPC.p = hyst_plot(FRCH_storm10b_08_02_Q, FRCH_storm10b_08_02_SPC, "FRCH", "SPC", "0802b")
FRCH_storm10c_08_03_SPC.p = hyst_plot(FRCH_storm10c_08_03_Q, FRCH_storm10c_08_03_SPC, "FRCH", "SPC", "0803c")
FRCH_storm11_08_05_SPC.p = hyst_plot(FRCH_storm11_08_05_Q, FRCH_storm11_08_05_SPC, "FRCH", "SPC", "0805")
FRCH_storm12a_08_12_SPC.p = hyst_plot(FRCH_storm12a_08_12_Q, FRCH_storm12a_08_12_SPC, "FRCH", "SPC", "0812a")
FRCH_storm12b_08_14_SPC.p = hyst_plot(FRCH_storm12b_08_14_Q, FRCH_storm12b_08_14_SPC, "FRCH", "SPC", "0814b")
FRCH_storm12c_08_15_SPC.p = hyst_plot(FRCH_storm12c_08_15_Q, FRCH_storm12c_08_15_SPC, "FRCH", "SPC", "0815c")
FRCH_storm12d_08_21_SPC.p = hyst_plot(FRCH_storm12d_08_21_Q, FRCH_storm12d_08_21_SPC, "FRCH", "SPC", "0821d")
FRCH_storm13_09_20_SPC.p = hyst_plot(FRCH_storm13_09_20_Q, FRCH_storm13_09_20_SPC, "FRCH", "SPC", "0920")
FRCH_storm14_10_01_SPC.p = hyst_plot(FRCH_storm14_10_01_Q, FRCH_storm14_10_01_SPC, "FRCH", "SPC", "1001")

# turb
FRCH_storm1_05_31_turb.p = hyst_plot(FRCH_storm1_05_31_Q, FRCH_storm1_05_31_turb, "FRCH", "turb", "0531")
FRCH_storm2_06_15_turb.p = hyst_plot(FRCH_storm2_06_15_Q, FRCH_storm2_06_15_turb, "FRCH", "turb", "0615")
FRCH_storm3_06_18_turb.p = hyst_plot(FRCH_storm3_06_18_Q, FRCH_storm3_06_18_turb, "FRCH", "turb", "0618")
FRCH_storm4_06_20_turb.p = hyst_plot(FRCH_storm4_06_20_Q, FRCH_storm4_06_20_turb, "FRCH", "turb", "0620")
FRCH_storm5_06_22_turb.p = hyst_plot(FRCH_storm5_06_22_Q, FRCH_storm5_06_22_turb, "FRCH", "turb", "0622")
FRCH_storm6_07_12_turb.p = hyst_plot(FRCH_storm6_07_12_Q, FRCH_storm6_07_12_turb, "FRCH", "turb", "0712")
FRCH_storm7_07_25_turb.p = hyst_plot(FRCH_storm7_07_25_Q, FRCH_storm7_07_25_turb, "FRCH", "turb", "0725")
FRCH_storm8_07_28_turb.p = hyst_plot(FRCH_storm8_07_28_Q, FRCH_storm8_07_28_turb, "FRCH", "turb", "0728")
FRCH_storm9a_07_29_turb.p = hyst_plot(FRCH_storm9a_07_29_Q, FRCH_storm9a_07_29_turb, "FRCH", "turb", "0729a")
FRCH_storm9b_07_30_turb.p = hyst_plot(FRCH_storm9b_07_30_Q, FRCH_storm9b_07_30_turb, "FRCH", "turb", "0730b")
FRCH_storm10a_08_01_turb.p = hyst_plot(FRCH_storm10a_08_01_Q, FRCH_storm10a_08_01_turb, "FRCH", "turb", "0801a")
FRCH_storm10b_08_02_turb.p = hyst_plot(FRCH_storm10b_08_02_Q, FRCH_storm10b_08_02_turb, "FRCH", "turb", "0802b")
FRCH_storm10c_08_03_turb.p = hyst_plot(FRCH_storm10c_08_03_Q, FRCH_storm10c_08_03_turb, "FRCH", "turb", "0803c")
FRCH_storm11_08_05_turb.p = hyst_plot(FRCH_storm11_08_05_Q, FRCH_storm11_08_05_turb, "FRCH", "turb", "0805")
FRCH_storm12a_08_12_turb.p = hyst_plot(FRCH_storm12a_08_12_Q, FRCH_storm12a_08_12_turb, "FRCH", "turb", "0812a")
FRCH_storm12b_08_14_turb.p = hyst_plot(FRCH_storm12b_08_14_Q, FRCH_storm12b_08_14_turb, "FRCH", "turb", "0814b")
FRCH_storm12c_08_15_turb.p = hyst_plot(FRCH_storm12c_08_15_Q, FRCH_storm12c_08_15_turb, "FRCH", "turb", "0815c")
FRCH_storm12d_08_21_turb.p = hyst_plot(FRCH_storm12d_08_21_Q, FRCH_storm12d_08_21_turb, "FRCH", "turb", "0821d")
FRCH_storm13_09_20_turb.p = hyst_plot(FRCH_storm13_09_20_Q, FRCH_storm13_09_20_turb, "FRCH", "turb", "0920")
FRCH_storm14_10_01_turb.p = hyst_plot(FRCH_storm14_10_01_Q, FRCH_storm14_10_01_turb, "FRCH", "turb", "1001")

# Multiplots of FRCH storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

multiplot(FRCH_storm1_05_31_NO3.p, FRCH_storm1_05_31_fDOM.p,FRCH_storm1_05_31_SPC.p, FRCH_storm1_05_31_turb.p)  #works 
multiplot(FRCH_storm2_06_15_NO3.p, FRCH_storm2_06_15_fDOM.p,FRCH_storm2_06_15_SPC.p, FRCH_storm2_06_15_turb.p)  #works 
multiplot(FRCH_storm3_06_18_NO3.p, FRCH_storm3_06_18_fDOM.p,FRCH_storm3_06_18_SPC.p, FRCH_storm3_06_18_turb.p)  #works 
multiplot(FRCH_storm4_06_20_NO3.p, FRCH_storm4_06_20_fDOM.p,FRCH_storm4_06_20_SPC.p, FRCH_storm4_06_20_turb.p)  #works 
multiplot(FRCH_storm5_06_22_NO3.p, FRCH_storm5_06_22_fDOM.p,FRCH_storm5_06_22_SPC.p, FRCH_storm5_06_22_turb.p)  #works 
multiplot(FRCH_storm6_07_12_NO3.p, FRCH_storm6_07_12_fDOM.p,FRCH_storm6_07_12_SPC.p, FRCH_storm6_07_12_turb.p)  #works 
multiplot(FRCH_storm7_07_25_NO3.p, FRCH_storm7_07_25_fDOM.p,FRCH_storm7_07_25_SPC.p, FRCH_storm7_07_25_turb.p)  #works 
multiplot(FRCH_storm8_07_28_NO3.p, FRCH_storm8_07_28_fDOM.p,FRCH_storm8_07_28_SPC.p, FRCH_storm8_07_28_turb.p)  #works 
multiplot(FRCH_storm9a_07_29_NO3.p, FRCH_storm9a_07_29_fDOM.p,FRCH_storm9a_07_29_SPC.p, FRCH_storm9a_07_29_turb.p)  #works 
multiplot(FRCH_storm9b_07_30_NO3.p, FRCH_storm9b_07_30_fDOM.p,FRCH_storm9b_07_30_SPC.p, FRCH_storm9b_07_30_turb.p)  #works 
multiplot(FRCH_storm10a_08_01_NO3.p, FRCH_storm10a_08_01_fDOM.p,FRCH_storm10a_08_01_SPC.p, FRCH_storm10a_08_01_turb.p)  #works 
multiplot(FRCH_storm10b_08_02_NO3.p, FRCH_storm10b_08_02_fDOM.p,FRCH_storm10b_08_02_SPC.p, FRCH_storm10b_08_02_turb.p)  #works 
multiplot(FRCH_storm10c_08_03_NO3.p, FRCH_storm10c_08_03_fDOM.p,FRCH_storm10c_08_03_SPC.p, FRCH_storm10c_08_03_turb.p)  #works 
multiplot(FRCH_storm11_08_05_NO3.p, FRCH_storm11_08_05_fDOM.p,FRCH_storm11_08_05_SPC.p, FRCH_storm11_08_05_turb.p)  #works 
multiplot(FRCH_storm12a_08_12_NO3.p, FRCH_storm12a_08_12_fDOM.p,FRCH_storm12a_08_12_SPC.p, FRCH_storm12a_08_12_turb.p)  #works 
multiplot(FRCH_storm12b_08_14_NO3.p, FRCH_storm12b_08_14_fDOM.p,FRCH_storm12b_08_14_SPC.p, FRCH_storm12b_08_14_turb.p)  #works 
multiplot(FRCH_storm12c_08_15_NO3.p, FRCH_storm12c_08_15_fDOM.p,FRCH_storm12c_08_15_SPC.p, FRCH_storm12c_08_15_turb.p)  #works 
multiplot(FRCH_storm12d_08_21_NO3.p, FRCH_storm12d_08_21_fDOM.p,FRCH_storm12d_08_21_SPC.p, FRCH_storm12d_08_21_turb.p)  #works 
multiplot(FRCH_storm13_09_20_NO3.p, FRCH_storm13_09_20_fDOM.p,FRCH_storm13_09_20_SPC.p, FRCH_storm13_09_20_turb.p)  #works 
multiplot(FRCH_storm14_10_01_NO3.p, FRCH_storm14_10_01_fDOM.p,FRCH_storm14_10_01_SPC.p, FRCH_storm14_10_01_turb.p)  #works 

multiplot(FRCH_storm1_05_31_NO3.p, FRCH_storm1_05_31_fDOM.p,FRCH_storm1_05_31_SPC.p, FRCH_storm1_05_31_turb.p,
          FRCH_storm2_06_15_NO3.p, FRCH_storm2_06_15_fDOM.p,FRCH_storm2_06_15_SPC.p, FRCH_storm2_06_15_turb.p,
          FRCH_storm3_06_18_NO3.p, FRCH_storm3_06_18_fDOM.p,FRCH_storm3_06_18_SPC.p, FRCH_storm3_06_18_turb.p,
          FRCH_storm5_06_22_NO3.p, FRCH_storm5_06_22_fDOM.p,FRCH_storm5_06_22_SPC.p, FRCH_storm5_06_22_turb.p,
          FRCH_storm6_07_12_NO3.p, FRCH_storm6_07_12_fDOM.p,FRCH_storm6_07_12_SPC.p, FRCH_storm6_07_12_turb.p,
          FRCH_storm7_07_25_NO3.p, FRCH_storm7_07_25_fDOM.p,FRCH_storm7_07_25_SPC.p, FRCH_storm7_07_25_turb.p,
          FRCH_storm8_07_28_NO3.p, FRCH_storm8_07_28_fDOM.p,FRCH_storm8_07_28_SPC.p, FRCH_storm8_07_28_turb.p,
          FRCH_storm9a_07_29_NO3.p, FRCH_storm9a_07_29_fDOM.p,FRCH_storm9a_07_29_SPC.p, FRCH_storm9a_07_29_turb.p,
          FRCH_storm9b_07_30_NO3.p, FRCH_storm9b_07_30_fDOM.p,FRCH_storm9b_07_30_SPC.p, FRCH_storm9b_07_30_turb.p,
          FRCH_storm10a_08_01_NO3.p, FRCH_storm10a_08_01_fDOM.p,FRCH_storm10a_08_01_SPC.p, FRCH_storm10a_08_01_turb.p,
          FRCH_storm10b_08_02_NO3.p, FRCH_storm10b_08_02_fDOM.p,FRCH_storm10b_08_02_SPC.p, FRCH_storm10b_08_02_turb.p,
          FRCH_storm10c_08_03_NO3.p, FRCH_storm10c_08_03_fDOM.p,FRCH_storm10c_08_03_SPC.p, FRCH_storm10c_08_03_turb.p,
          FRCH_storm11_08_05_NO3.p, FRCH_storm11_08_05_fDOM.p,FRCH_storm11_08_05_SPC.p, FRCH_storm11_08_05_turb.p,
          FRCH_storm12a_08_12_NO3.p, FRCH_storm12a_08_12_fDOM.p,FRCH_storm12a_08_12_SPC.p, FRCH_storm12a_08_12_turb.p,
          FRCH_storm12b_08_14_NO3.p, FRCH_storm12b_08_14_fDOM.p,FRCH_storm12b_08_14_SPC.p, FRCH_storm12b_08_14_turb.p,
          FRCH_storm12c_08_15_NO3.p, FRCH_storm12c_08_15_fDOM.p,FRCH_storm12c_08_15_SPC.p, FRCH_storm12c_08_15_turb.p,
          FRCH_storm12d_08_21_NO3.p, FRCH_storm12d_08_21_fDOM.p,FRCH_storm12d_08_21_SPC.p, FRCH_storm12d_08_21_turb.p,
          FRCH_storm13_09_20_NO3.p, FRCH_storm13_09_20_fDOM.p,FRCH_storm13_09_20_SPC.p, FRCH_storm13_09_20_turb.p,
          FRCH_storm14_10_01_NO3.p, FRCH_storm14_10_01_fDOM.p,FRCH_storm14_10_01_SPC.p, FRCH_storm14_10_01_turb.p,
          cols = 7)
# export pdf 20 x 30   

# Make VAUL loops #
# NO3
VAUL_storm1_07_13_NO3.p = hyst_plot(VAUL_storm1_07_13_Q, VAUL_storm1_07_13_NO3, "VAUL", "NO3", "0713")
VAUL_storm2_07_26_NO3.p = hyst_plot(VAUL_storm2_07_26_Q, VAUL_storm2_07_26_NO3, "VAUL", "NO3", "0726")
VAUL_storm3_07_29_NO3.p = hyst_plot(VAUL_storm3_07_29_Q, VAUL_storm3_07_29_NO3, "VAUL", "NO3", "0729")
VAUL_storm4a_08_02_NO3.p = hyst_plot(VAUL_storm4a_08_02_Q, VAUL_storm4a_08_02_NO3, "VAUL", "NO3", "0802a")
VAUL_storm4b_08_03_NO3.p = hyst_plot(VAUL_storm4b_08_03_Q, VAUL_storm4b_08_03_NO3, "VAUL", "NO3", "0803b")
VAUL_storm4c_08_05_NO3.p = hyst_plot(VAUL_storm4c_08_05_Q, VAUL_storm4c_08_05_NO3, "VAUL", "NO3", "0805c")
VAUL_storm5_08_12_NO3.p = hyst_plot(VAUL_storm5_08_12_Q, VAUL_storm5_08_12_NO3, "VAUL", "NO3", "0812")
VAUL_storm6_08_15_NO3.p = hyst_plot(VAUL_storm6_08_15_Q, VAUL_storm6_08_15_NO3, "VAUL", "NO3", "0815")
VAUL_storm7_09_19_NO3.p = hyst_plot(VAUL_storm7_09_19_Q, VAUL_storm7_09_19_NO3, "VAUL", "NO3", "0919")
VAUL_storm8a_09_29_NO3.p = hyst_plot(VAUL_storm8a_09_29_Q, VAUL_storm8a_09_29_NO3, "VAUL", "NO3", "0929a")
VAUL_storm8b_10_01_NO3.p = hyst_plot(VAUL_storm8b_10_01_Q, VAUL_storm8b_10_01_NO3, "VAUL", "NO3", "1001b")
VAUL_storm8c_10_04_NO3.p = hyst_plot(VAUL_storm8c_10_04_Q, VAUL_storm8c_10_04_NO3, "VAUL", "NO3", "1004c")

# fDOM
VAUL_storm1_07_13_fDOM.p = hyst_plot(VAUL_storm1_07_13_Q, VAUL_storm1_07_13_fDOM, "VAUL", "fDOM", "0713")
VAUL_storm2_07_26_fDOM.p = hyst_plot(VAUL_storm2_07_26_Q, VAUL_storm2_07_26_fDOM, "VAUL", "fDOM", "0726")
VAUL_storm3_07_29_fDOM.p = hyst_plot(VAUL_storm3_07_29_Q, VAUL_storm3_07_29_fDOM, "VAUL", "fDOM", "0729")
VAUL_storm4a_08_02_fDOM.p = hyst_plot(VAUL_storm4a_08_02_Q, VAUL_storm4a_08_02_fDOM, "VAUL", "fDOM", "0802a")
VAUL_storm4b_08_03_fDOM.p = hyst_plot(VAUL_storm4b_08_03_Q, VAUL_storm4b_08_03_fDOM, "VAUL", "fDOM", "0803b")
VAUL_storm4c_08_05_fDOM.p = hyst_plot(VAUL_storm4c_08_05_Q, VAUL_storm4c_08_05_fDOM, "VAUL", "fDOM", "0805c")
VAUL_storm5_08_12_fDOM.p = hyst_plot(VAUL_storm5_08_12_Q, VAUL_storm5_08_12_fDOM, "VAUL", "fDOM", "0812")
VAUL_storm6_08_15_fDOM.p = hyst_plot(VAUL_storm6_08_15_Q, VAUL_storm6_08_15_fDOM, "VAUL", "fDOM", "0815")
VAUL_storm7_09_19_fDOM.p = hyst_plot(VAUL_storm7_09_19_Q, VAUL_storm7_09_19_fDOM, "VAUL", "fDOM", "0919")
VAUL_storm8a_09_29_fDOM.p = hyst_plot(VAUL_storm8a_09_29_Q, VAUL_storm8a_09_29_fDOM, "VAUL", "fDOM", "0929a")
VAUL_storm8b_10_01_fDOM.p = hyst_plot(VAUL_storm8b_10_01_Q, VAUL_storm8b_10_01_fDOM, "VAUL", "fDOM", "1001b")
VAUL_storm8c_10_04_fDOM.p = hyst_plot(VAUL_storm8c_10_04_Q, VAUL_storm8c_10_04_fDOM, "VAUL", "fDOM", "1004c")

# SPC
VAUL_storm1_07_13_SPC.p = hyst_plot(VAUL_storm1_07_13_Q, VAUL_storm1_07_13_SPC, "VAUL", "SPC", "0713")
VAUL_storm2_07_26_SPC.p = hyst_plot(VAUL_storm2_07_26_Q, VAUL_storm2_07_26_SPC, "VAUL", "SPC", "0726")
VAUL_storm3_07_29_SPC.p = hyst_plot(VAUL_storm3_07_29_Q, VAUL_storm3_07_29_SPC, "VAUL", "SPC", "0729")
VAUL_storm4a_08_02_SPC.p = hyst_plot(VAUL_storm4a_08_02_Q, VAUL_storm4a_08_02_SPC, "VAUL", "SPC", "0802a")
VAUL_storm4b_08_03_SPC.p = hyst_plot(VAUL_storm4b_08_03_Q, VAUL_storm4b_08_03_SPC, "VAUL", "SPC", "0803b")
VAUL_storm4c_08_05_SPC.p = hyst_plot(VAUL_storm4c_08_05_Q, VAUL_storm4c_08_05_SPC, "VAUL", "SPC", "0805c")
VAUL_storm5_08_12_SPC.p = hyst_plot(VAUL_storm5_08_12_Q, VAUL_storm5_08_12_SPC, "VAUL", "SPC", "0812")
VAUL_storm6_08_15_SPC.p = hyst_plot(VAUL_storm6_08_15_Q, VAUL_storm6_08_15_SPC, "VAUL", "SPC", "0815")
VAUL_storm7_09_19_SPC.p = hyst_plot(VAUL_storm7_09_19_Q, VAUL_storm7_09_19_SPC, "VAUL", "SPC", "0919")
VAUL_storm8a_09_29_SPC.p = hyst_plot(VAUL_storm8a_09_29_Q, VAUL_storm8a_09_29_SPC, "VAUL", "SPC", "0929a")
VAUL_storm8b_10_01_SPC.p = hyst_plot(VAUL_storm8b_10_01_Q, VAUL_storm8b_10_01_SPC, "VAUL", "SPC", "1001b")
VAUL_storm8c_10_04_SPC.p = hyst_plot(VAUL_storm8c_10_04_Q, VAUL_storm8c_10_04_SPC, "VAUL", "SPC", "1004c")

# turb 
VAUL_storm1_07_13_turb.p = hyst_plot(VAUL_storm1_07_13_Q, VAUL_storm1_07_13_turb, "VAUL", "turb", "0713")
VAUL_storm2_07_26_turb.p = hyst_plot(VAUL_storm2_07_26_Q, VAUL_storm2_07_26_turb, "VAUL", "turb", "0726")
VAUL_storm3_07_29_turb.p = hyst_plot(VAUL_storm3_07_29_Q, VAUL_storm3_07_29_turb, "VAUL", "turb", "0729")
VAUL_storm4a_08_02_turb.p = hyst_plot(VAUL_storm4a_08_02_Q, VAUL_storm4a_08_02_turb, "VAUL", "turb", "0802a")
VAUL_storm4b_08_03_turb.p = hyst_plot(VAUL_storm4b_08_03_Q, VAUL_storm4b_08_03_turb, "VAUL", "turb", "0803b")
VAUL_storm4c_08_05_turb.p = hyst_plot(VAUL_storm4c_08_05_Q, VAUL_storm4c_08_05_turb, "VAUL", "turb", "0805c")
VAUL_storm5_08_12_turb.p = hyst_plot(VAUL_storm5_08_12_Q, VAUL_storm5_08_12_turb, "VAUL", "turb", "0812")
VAUL_storm6_08_15_turb.p = hyst_plot(VAUL_storm6_08_15_Q, VAUL_storm6_08_15_turb, "VAUL", "turb", "0815")
VAUL_storm7_09_19_turb.p = hyst_plot(VAUL_storm7_09_19_Q, VAUL_storm7_09_19_turb, "VAUL", "turb", "0919")
VAUL_storm8a_09_29_turb.p = hyst_plot(VAUL_storm8a_09_29_Q, VAUL_storm8a_09_29_turb, "VAUL", "turb", "0929a")
VAUL_storm8b_10_01_turb.p = hyst_plot(VAUL_storm8b_10_01_Q, VAUL_storm8b_10_01_turb, "VAUL", "turb", "1001b")
VAUL_storm8c_10_04_turb.p = hyst_plot(VAUL_storm8c_10_04_Q, VAUL_storm8c_10_04_turb, "VAUL", "turb", "1004c")

# Multiplots of VAUL storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

multiplot(VAUL_storm1_07_13_NO3.p, VAUL_storm1_07_13_fDOM.p,VAUL_storm1_07_13_SPC.p, VAUL_storm1_07_13_turb.p)  #works 
multiplot(VAUL_storm2_07_26_NO3.p, VAUL_storm2_07_26_fDOM.p,VAUL_storm2_07_26_SPC.p, VAUL_storm2_07_26_turb.p)  #works 
multiplot(VAUL_storm3_07_29_NO3.p, VAUL_storm3_07_29_fDOM.p,VAUL_storm3_07_29_SPC.p, VAUL_storm3_07_29_turb.p)  #works 
multiplot(VAUL_storm4a_08_02_NO3.p, VAUL_storm4a_08_02_fDOM.p,VAUL_storm4a_08_02_SPC.p, VAUL_storm4a_08_02_turb.p)  #works 
multiplot(VAUL_storm4b_08_03_NO3.p, VAUL_storm4b_08_03_fDOM.p,VAUL_storm4b_08_03_SPC.p, VAUL_storm4b_08_03_turb.p)  #works 
multiplot(VAUL_storm4c_08_05_NO3.p, VAUL_storm4c_08_05_fDOM.p,VAUL_storm4c_08_05_SPC.p, VAUL_storm4c_08_05_turb.p)  #works 
multiplot(VAUL_storm5_08_12_NO3.p, VAUL_storm5_08_12_fDOM.p,VAUL_storm5_08_12_SPC.p, VAUL_storm5_08_12_turb.p)  #works 
multiplot(VAUL_storm6_08_15_NO3.p, VAUL_storm6_08_15_fDOM.p,VAUL_storm6_08_15_SPC.p, VAUL_storm6_08_15_turb.p)  #works 
multiplot(VAUL_storm7_09_19_NO3.p, VAUL_storm7_09_19_fDOM.p,VAUL_storm7_09_19_SPC.p, VAUL_storm7_09_19_turb.p)  #works 
multiplot(VAUL_storm8a_09_29_NO3.p, VAUL_storm8a_09_29_fDOM.p,VAUL_storm8a_09_29_SPC.p, VAUL_storm8a_09_29_turb.p)  #works 
multiplot(VAUL_storm8b_10_01_NO3.p, VAUL_storm8b_10_01_fDOM.p,VAUL_storm8b_10_01_SPC.p, VAUL_storm8b_10_01_turb.p)  #works 
multiplot(VAUL_storm8c_10_04_NO3.p, VAUL_storm8c_10_04_fDOM.p,VAUL_storm8c_10_04_SPC.p, VAUL_storm8c_10_04_turb.p)  #works 

multiplot(VAUL_storm1_07_13_NO3.p, VAUL_storm1_07_13_fDOM.p,VAUL_storm1_07_13_SPC.p, VAUL_storm1_07_13_turb.p,
          VAUL_storm2_07_26_NO3.p, VAUL_storm2_07_26_fDOM.p,VAUL_storm2_07_26_SPC.p, VAUL_storm2_07_26_turb.p,
          VAUL_storm3_07_29_NO3.p, VAUL_storm3_07_29_fDOM.p,VAUL_storm3_07_29_SPC.p, VAUL_storm3_07_29_turb.p,
          VAUL_storm4a_08_02_NO3.p, VAUL_storm4a_08_02_fDOM.p,VAUL_storm4a_08_02_SPC.p, VAUL_storm4a_08_02_turb.p,
          VAUL_storm4b_08_03_NO3.p, VAUL_storm4b_08_03_fDOM.p,VAUL_storm4b_08_03_SPC.p, VAUL_storm4b_08_03_turb.p,
          VAUL_storm4c_08_05_NO3.p, VAUL_storm4c_08_05_fDOM.p,VAUL_storm4c_08_05_SPC.p, VAUL_storm4c_08_05_turb.p,
          VAUL_storm5_08_12_NO3.p, VAUL_storm5_08_12_fDOM.p,VAUL_storm5_08_12_SPC.p, VAUL_storm5_08_12_turb.p,
          VAUL_storm6_08_15_NO3.p, VAUL_storm6_08_15_fDOM.p,VAUL_storm6_08_15_SPC.p, VAUL_storm6_08_15_turb.p,
          VAUL_storm7_09_19_NO3.p, VAUL_storm7_09_19_fDOM.p,VAUL_storm7_09_19_SPC.p, VAUL_storm7_09_19_turb.p,
          VAUL_storm8a_09_29_NO3.p, VAUL_storm8a_09_29_fDOM.p,VAUL_storm8a_09_29_SPC.p, VAUL_storm8a_09_29_turb.p,
          VAUL_storm8b_10_01_NO3.p, VAUL_storm8b_10_01_fDOM.p,VAUL_storm8b_10_01_SPC.p, VAUL_storm8b_10_01_turb.p,
          VAUL_storm8c_10_04_NO3.p, VAUL_storm8c_10_04_fDOM.p,VAUL_storm8c_10_04_SPC.p, VAUL_storm8c_10_04_turb.p,
          cols = 7)

# Make POKE loops #
# NO3
POKE_storm1_06_30_NO3.p = hyst_plot(POKE_storm1_06_30_Q, POKE_storm1_06_30_NO3, "POKE", "NO3", "0630")
POKE_storm2_07_12_NO3.p = hyst_plot(POKE_storm2_07_12_Q, POKE_storm2_07_12_NO3, "POKE", "NO3", "0712")
POKE_storm3_07_26_NO3.p = hyst_plot(POKE_storm3_07_26_Q, POKE_storm3_07_26_NO3, "POKE", "NO3", "0726")
POKE_storm4_07_31_NO3.p = hyst_plot(POKE_storm4_07_31_Q, POKE_storm4_07_31_NO3, "POKE", "NO3", "0731")
POKE_storm5a_08_02_NO3.p = hyst_plot(POKE_storm5a_08_02_Q, POKE_storm5a_08_02_NO3, "POKE", "NO3", "0802a")
POKE_storm5b_08_03_NO3.p = hyst_plot(POKE_storm5b_08_03_Q, POKE_storm5b_08_03_NO3, "POKE", "NO3", "0803b")
POKE_storm5c_08_05_NO3.p = hyst_plot(POKE_storm5c_08_05_Q, POKE_storm5c_08_05_NO3, "POKE", "NO3", "0805c")
POKE_storm5d_08_10_NO3.p = hyst_plot(POKE_storm5d_08_10_Q, POKE_storm5d_08_10_NO3, "POKE", "NO3", "0810d")
POKE_storm6a_08_12_NO3.p = hyst_plot(POKE_storm6a_08_12_Q, POKE_storm6a_08_12_NO3, "POKE", "NO3", "0812a")
POKE_storm6b_08_13_NO3.p = hyst_plot(POKE_storm6b_08_13_Q, POKE_storm6b_08_13_NO3, "POKE", "NO3", "0813b")
POKE_storm7_08_15_NO3.p = hyst_plot(POKE_storm7_08_15_Q, POKE_storm7_08_15_NO3, "POKE", "NO3", "0815")
POKE_storm8_09_29_NO3.p = hyst_plot(POKE_storm8_09_29_Q, POKE_storm8_09_29_NO3, "POKE", "NO3", "0929")
POKE_storm9_10_04_NO3.p = hyst_plot(POKE_storm9_10_04_Q, POKE_storm9_10_04_NO3, "POKE", "NO3", "1004")

#fDOM
POKE_storm1_06_30_fDOM.p = hyst_plot(POKE_storm1_06_30_Q, POKE_storm1_06_30_fDOM, "POKE", "fDOM", "0630")
POKE_storm2_07_12_fDOM.p = hyst_plot(POKE_storm2_07_12_Q, POKE_storm2_07_12_fDOM, "POKE", "fDOM", "0712")
POKE_storm3_07_26_fDOM.p = hyst_plot(POKE_storm3_07_26_Q, POKE_storm3_07_26_fDOM, "POKE", "fDOM", "0726")
POKE_storm4_07_31_fDOM.p = hyst_plot(POKE_storm4_07_31_Q, POKE_storm4_07_31_fDOM, "POKE", "fDOM", "0731")
POKE_storm5a_08_02_fDOM.p = hyst_plot(POKE_storm5a_08_02_Q, POKE_storm5a_08_02_fDOM, "POKE", "fDOM", "0802a")
POKE_storm5b_08_03_fDOM.p = hyst_plot(POKE_storm5b_08_03_Q, POKE_storm5b_08_03_fDOM, "POKE", "fDOM", "0803b")
POKE_storm5c_08_05_fDOM.p = hyst_plot(POKE_storm5c_08_05_Q, POKE_storm5c_08_05_fDOM, "POKE", "fDOM", "0805c")
POKE_storm5d_08_10_fDOM.p = hyst_plot(POKE_storm5d_08_10_Q, POKE_storm5d_08_10_fDOM, "POKE", "fDOM", "0810d")
POKE_storm6a_08_12_fDOM.p = hyst_plot(POKE_storm6a_08_12_Q, POKE_storm6a_08_12_fDOM, "POKE", "fDOM", "0812a")
POKE_storm6b_08_13_fDOM.p = hyst_plot(POKE_storm6b_08_13_Q, POKE_storm6b_08_13_fDOM, "POKE", "fDOM", "0813b")
POKE_storm7_08_15_fDOM.p = hyst_plot(POKE_storm7_08_15_Q, POKE_storm7_08_15_fDOM, "POKE", "fDOM", "0815")
POKE_storm8_09_29_fDOM.p = hyst_plot(POKE_storm8_09_29_Q, POKE_storm8_09_29_fDOM, "POKE", "fDOM", "0929")
POKE_storm9_10_04_fDOM.p = hyst_plot(POKE_storm9_10_04_Q, POKE_storm9_10_04_fDOM, "POKE", "fDOM", "1004")

#SPC
POKE_storm1_06_30_SPC.p = hyst_plot(POKE_storm1_06_30_Q, POKE_storm1_06_30_SPC, "POKE", "SPC", "0630")
POKE_storm2_07_12_SPC.p = hyst_plot(POKE_storm2_07_12_Q, POKE_storm2_07_12_SPC, "POKE", "SPC", "0712")
POKE_storm3_07_26_SPC.p = hyst_plot(POKE_storm3_07_26_Q, POKE_storm3_07_26_SPC, "POKE", "SPC", "0726")
POKE_storm4_07_31_SPC.p = hyst_plot(POKE_storm4_07_31_Q, POKE_storm4_07_31_SPC, "POKE", "SPC", "0731")
POKE_storm5a_08_02_SPC.p = hyst_plot(POKE_storm5a_08_02_Q, POKE_storm5a_08_02_SPC, "POKE", "SPC", "0802a")
POKE_storm5b_08_03_SPC.p = hyst_plot(POKE_storm5b_08_03_Q, POKE_storm5b_08_03_SPC, "POKE", "SPC", "0803b")
POKE_storm5c_08_05_SPC.p = hyst_plot(POKE_storm5c_08_05_Q, POKE_storm5c_08_05_SPC, "POKE", "SPC", "0805c")
POKE_storm5d_08_10_SPC.p = hyst_plot(POKE_storm5d_08_10_Q, POKE_storm5d_08_10_SPC, "POKE", "SPC", "0810d")
POKE_storm6a_08_12_SPC.p = hyst_plot(POKE_storm6a_08_12_Q, POKE_storm6a_08_12_SPC, "POKE", "SPC", "0812a")
POKE_storm6b_08_13_SPC.p = hyst_plot(POKE_storm6b_08_13_Q, POKE_storm6b_08_13_SPC, "POKE", "SPC", "0813b")
POKE_storm7_08_15_SPC.p = hyst_plot(POKE_storm7_08_15_Q, POKE_storm7_08_15_SPC, "POKE", "SPC", "0815")
POKE_storm8_09_29_SPC.p = hyst_plot(POKE_storm8_09_29_Q, POKE_storm8_09_29_SPC, "POKE", "SPC", "0929")
POKE_storm9_10_04_SPC.p = hyst_plot(POKE_storm9_10_04_Q, POKE_storm9_10_04_SPC, "POKE", "SPC", "1004")

#turb
POKE_storm1_06_30_turb.p = hyst_plot(POKE_storm1_06_30_Q, POKE_storm1_06_30_turb, "POKE", "turb", "0630")
POKE_storm2_07_12_turb.p = hyst_plot(POKE_storm2_07_12_Q, POKE_storm2_07_12_turb, "POKE", "turb", "0712")
POKE_storm3_07_26_turb.p = hyst_plot(POKE_storm3_07_26_Q, POKE_storm3_07_26_turb, "POKE", "turb", "0726")
POKE_storm4_07_31_turb.p = hyst_plot(POKE_storm4_07_31_Q, POKE_storm4_07_31_turb, "POKE", "turb", "0731")
POKE_storm5a_08_02_turb.p = hyst_plot(POKE_storm5a_08_02_Q, POKE_storm5a_08_02_turb, "POKE", "turb", "0802a")
POKE_storm5b_08_03_turb.p = hyst_plot(POKE_storm5b_08_03_Q, POKE_storm5b_08_03_turb, "POKE", "turb", "0803b")
POKE_storm5c_08_05_turb.p = hyst_plot(POKE_storm5c_08_05_Q, POKE_storm5c_08_05_turb, "POKE", "turb", "0805c")
POKE_storm5d_08_10_turb.p = hyst_plot(POKE_storm5d_08_10_Q, POKE_storm5d_08_10_turb, "POKE", "turb", "0810d")
POKE_storm6a_08_12_turb.p = hyst_plot(POKE_storm6a_08_12_Q, POKE_storm6a_08_12_turb, "POKE", "turb", "0812a")
POKE_storm6b_08_13_turb.p = hyst_plot(POKE_storm6b_08_13_Q, POKE_storm6b_08_13_turb, "POKE", "turb", "0813b")
POKE_storm7_08_15_turb.p = hyst_plot(POKE_storm7_08_15_Q, POKE_storm7_08_15_turb, "POKE", "turb", "0815")
POKE_storm8_09_29_turb.p = hyst_plot(POKE_storm8_09_29_Q, POKE_storm8_09_29_turb, "POKE", "turb", "0929")
POKE_storm9_10_04_turb.p = hyst_plot(POKE_storm9_10_04_Q, POKE_storm9_10_04_turb, "POKE", "turb", "1004")


# Multiplots of VAUL storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}
multiplot(POKE_storm6b_08_13_NO3.p, POKE_storm6b_08_13_fDOM.p,POKE_storm6b_08_13_SPC.p, POKE_storm6b_08_13_turb.p)
          

multiplot(POKE_storm1_06_30_NO3.p, POKE_storm1_06_30_fDOM.p,POKE_storm1_06_30_SPC.p, POKE_storm1_06_30_turb.p,
          POKE_storm2_07_12_NO3.p, POKE_storm2_07_12_fDOM.p,POKE_storm2_07_12_SPC.p, POKE_storm2_07_12_turb.p,
          POKE_storm3_07_26_NO3.p, POKE_storm3_07_26_fDOM.p,POKE_storm3_07_26_SPC.p, POKE_storm3_07_26_turb.p,
          POKE_storm4_07_31_NO3.p, POKE_storm4_07_31_fDOM.p,POKE_storm4_07_31_SPC.p, POKE_storm4_07_31_turb.p,
          POKE_storm5a_08_02_NO3.p, POKE_storm5a_08_02_fDOM.p,POKE_storm5a_08_02_SPC.p, POKE_storm5a_08_02_turb.p,
          POKE_storm5b_08_03_NO3.p, POKE_storm5b_08_03_fDOM.p,POKE_storm5b_08_03_SPC.p, POKE_storm5b_08_03_turb.p,
          POKE_storm5c_08_05_NO3.p, POKE_storm5c_08_05_fDOM.p,POKE_storm5c_08_05_SPC.p, POKE_storm5c_08_05_turb.p,
          POKE_storm5d_08_10_NO3.p, POKE_storm5d_08_10_fDOM.p,POKE_storm5d_08_10_SPC.p, POKE_storm5d_08_10_turb.p,
          POKE_storm6a_08_12_NO3.p, POKE_storm6a_08_12_fDOM.p,POKE_storm6a_08_12_SPC.p, POKE_storm6a_08_12_turb.p,
          POKE_storm7_08_15_NO3.p, POKE_storm7_08_15_fDOM.p,POKE_storm7_08_15_SPC.p, POKE_storm7_08_15_turb.p,
          POKE_storm8_09_29_NO3.p, POKE_storm8_09_29_fDOM.p,POKE_storm8_09_29_SPC.p, POKE_storm8_09_29_turb.p,
          POKE_storm9_10_04_NO3.p, POKE_storm9_10_04_fDOM.p,POKE_storm9_10_04_SPC.p, POKE_storm9_10_04_turb.p,
          cols = 7)

############################################### 2020 #############################################
# plot on normalized scale # 
#### load data #####
STRT_storm1a_06_19 <- read.csv("Storms/STRT_storm1a_06_19.csv")
STRT_storm1a_06_19_Q <- read.csv("Storms/STRT_storm1a_06_19_Q.csv")
STRT_storm1a_06_19_NO3 <- read.csv("Storms/STRT_storm1a_06_19_NO3.csv")
STRT_storm1a_06_19_fDOM <- read.csv("Storms/STRT_storm1a_06_19_fDOM.csv")

STRT_storm1b_06_20 <- read.csv("Storms/STRT_storm1b_06_20.csv")
STRT_storm1b_06_20_Q <- read.csv("Storms/STRT_storm1b_06_20_Q.csv")
STRT_storm1b_06_20_NO3 <- read.csv("Storms/STRT_storm1b_06_20_NO3.csv")
STRT_storm1b_06_20_fDOM <- read.csv("Storms/STRT_storm1b_06_20_fDOM.csv")

STRT_storm1c_06_22 <- read.csv("Storms/STRT_storm1c_06_22.csv")
STRT_storm1c_06_22_Q <- read.csv("Storms/STRT_storm1c_06_22_Q.csv")
STRT_storm1c_06_22_NO3 <- read.csv("Storms/STRT_storm1c_06_22_NO3.csv")
STRT_storm1c_06_22_fDOM <- read.csv("Storms/STRT_storm1c_06_22_fDOM.csv")

STRT_storm1d_06_23 <- read.csv("Storms/STRT_storm1d_06_23.csv")
STRT_storm1d_06_23_Q <- read.csv("Storms/STRT_storm1d_06_23_Q.csv")
STRT_storm1d_06_23_NO3 <- read.csv("Storms/STRT_storm1d_06_23_NO3.csv")
STRT_storm1d_06_23_fDOM <- read.csv("Storms/STRT_storm1d_06_23_fDOM.csv")

STRT_storm1e_06_24 <- read.csv("Storms/STRT_storm1e_06_24.csv")
STRT_storm1e_06_24_Q <- read.csv("Storms/STRT_storm1e_06_24_Q.csv")
STRT_storm1e_06_24_NO3 <- read.csv("Storms/STRT_storm1e_06_24_NO3.csv")
STRT_storm1e_06_24_fDOM <- read.csv("Storms/STRT_storm1e_06_24_fDOM.csv")

STRT_storm2_07_09 <- read.csv("Storms/STRT_storm2_07_09.csv")
STRT_storm2_07_09_Q <- read.csv("Storms/STRT_storm2_07_09_Q.csv")
STRT_storm2_07_09_NO3 <- read.csv("Storms/STRT_storm2_07_09_NO3.csv")
STRT_storm2_07_09_fDOM <- read.csv("Storms/STRT_storm2_07_09_fDOM.csv")

STRT_storm3_07_21 <- read.csv("Storms/STRT_storm3_07_21.csv")
STRT_storm3_07_21_Q <- read.csv("Storms/STRT_storm3_07_21_Q.csv")
STRT_storm3_07_21_NO3 <- read.csv("Storms/STRT_storm3_07_21_NO3.csv")
STRT_storm3_07_21_fDOM <- read.csv("Storms/STRT_storm3_07_21_fDOM.csv")

STRT_storm4a_08_01 <- read.csv("Storms/STRT_storm4a_08_01.csv")
STRT_storm4a_08_01_Q <- read.csv("Storms/STRT_storm4a_08_01_Q.csv")
STRT_storm4a_08_01_NO3 <- read.csv("Storms/STRT_storm4a_08_01_NO3.csv")
STRT_storm4a_08_01_fDOM <- read.csv("Storms/STRT_storm4a_08_01_fDOM.csv")

STRT_storm4b_08_03 <- read.csv("Storms/STRT_storm4b_08_03.csv")
STRT_storm4b_08_03_Q <- read.csv("Storms/STRT_storm4b_08_03_Q.csv")
STRT_storm4b_08_03_NO3 <- read.csv("Storms/STRT_storm4b_08_03_NO3.csv")
STRT_storm4b_08_03_fDOM <- read.csv("Storms/STRT_storm4b_08_03_fDOM.csv")

STRT_storm5_08_09 <- read.csv("Storms/STRT_storm5_08_09.csv")
STRT_storm5_08_09_Q <- read.csv("Storms/STRT_storm5_08_09_Q.csv")
STRT_storm5_08_09_NO3 <- read.csv("Storms/STRT_storm5_08_09_NO3.csv")
STRT_storm5_08_09_fDOM <- read.csv("Storms/STRT_storm5_08_09_fDOM.csv")

STRT_storm6_08_12 <- read.csv("Storms/STRT_storm6_08_12.csv")
STRT_storm6_08_12_Q <- read.csv("Storms/STRT_storm6_08_12_Q.csv")
STRT_storm6_08_12_NO3 <- read.csv("Storms/STRT_storm6_08_12_NO3.csv")
STRT_storm6_08_12_fDOM <- read.csv("Storms/STRT_storm6_08_12_fDOM.csv")

STRT_storm7a_08_20 <- read.csv("Storms/STRT_storm7a_08_20.csv")
STRT_storm7a_08_20_Q <- read.csv("Storms/STRT_storm7a_08_20_Q.csv")
STRT_storm7a_08_20_NO3 <- read.csv("Storms/STRT_storm7a_08_20_NO3.csv")
STRT_storm7a_08_20_fDOM <- read.csv("Storms/STRT_storm7a_08_20_fDOM.csv")

STRT_storm7b_08_21 <- read.csv("Storms/STRT_storm7b_08_21.csv")
STRT_storm7b_08_21_Q <- read.csv("Storms/STRT_storm7b_08_21_Q.csv",)
STRT_storm7b_08_21_NO3 <- read.csv("Storms/STRT_storm7b_08_21_NO3.csv")
STRT_storm7b_08_21_fDOM <- read.csv("Storms/STRT_storm7b_08_21_fDOM.csv")

STRT_storm8_08_28 <- read.csv("Storms/STRT_storm8_08_28.csv")
STRT_storm8_08_28_Q <- read.csv("Storms/STRT_storm8_08_28_Q.csv")
STRT_storm8_08_28_NO3 <- read.csv("Storms/STRT_storm8_08_28_NO3.csv")
STRT_storm8_08_28_fDOM <- read.csv("Storms/STRT_storm8_08_28_fDOM.csv")

STRT_storm9a_09_03 <- read.csv("Storms/STRT_storm9a_09_03.csv")
STRT_storm9a_09_03_Q <- read.csv("Storms/STRT_storm9a_09_03_Q.csv")
STRT_storm9a_09_03_NO3 <- read.csv("Storms/STRT_storm9a_09_03_NO3.csv")
STRT_storm9a_09_03_fDOM <- read.csv("Storms/STRT_storm9a_09_03_fDOM.csv")

STRT_storm9b_09_06 <- read.csv("Storms/STRT_storm9b_09_06.csv")
STRT_storm9b_09_06_Q <- read.csv("Storms/STRT_storm9b_09_06_Q.csv")
STRT_storm9b_09_06_NO3 <- read.csv("Storms/STRT_storm9b_09_06_NO3.csv")
STRT_storm9b_09_06_fDOM <- read.csv("Storms/STRT_storm9b_09_06_fDOM.csv")

STRT_storm9c_09_09 <- read.csv("Storms/STRT_storm9c_09_09.csv")
STRT_storm9c_09_09_Q <- read.csv("Storms/STRT_storm9c_09_09_Q.csv")
STRT_storm9c_09_09_NO3 <- read.csv("Storms/STRT_storm9c_09_09_NO3.csv")
STRT_storm9c_09_09_fDOM <- read.csv("Storms/STRT_storm9c_09_09_fDOM.csv")

STRT_storm10_09_23 <- read.csv("Storms/STRT_storm10_09_23.csv")
STRT_storm10_09_23_Q <- read.csv("Storms/STRT_storm10_09_23_Q.csv")
STRT_storm10_09_23_NO3 <- read.csv("Storms/STRT_storm10_09_23_NO3.csv")
STRT_storm10_09_23_fDOM <- read.csv("Storms/STRT_storm10_09_23_fDOM.csv")

# MOOS #
MOOS_storm1_06_21 <- read.csv("Storms/MOOS_storm1_06_21.csv", row.names = 1)
MOOS_storm1_06_21_Q <- read.csv("Storms/MOOS_storm1_06_21_Q.csv", row.names = 1)
MOOS_storm1_06_21_NO3 <- read.csv("Storms/MOOS_storm1_06_21_NO3.csv", row.names = 1)
MOOS_storm1_06_21_fDOM <- read.csv("Storms/MOOS_storm1_06_21_fDOM.csv", row.names = 1)

MOOS_storm2_06_28 <- read.csv("Storms/MOOS_storm2_06_28.csv", row.names = 1)
MOOS_storm2_06_28_Q <- read.csv("Storms/MOOS_storm2_06_28_Q.csv", row.names = 1)
MOOS_storm2_06_28_NO3 <- read.csv("Storms/MOOS_storm2_06_28_NO3.csv", row.names = 1)
MOOS_storm2_06_28_fDOM <- read.csv("Storms/MOOS_storm2_06_28_fDOM.csv", row.names = 1)

MOOS_storm3_07_18 <- read.csv("Storms/MOOS_storm3_07_18.csv", row.names = 1)
MOOS_storm3_07_18_Q <- read.csv("Storms/MOOS_storm3_07_18_Q.csv", row.names = 1)
MOOS_storm3_07_18_NO3 <- read.csv("Storms/MOOS_storm3_07_18_NO3.csv", row.names = 1)
MOOS_storm3_07_18_fDOM <- read.csv("Storms/MOOS_storm3_07_18_fDOM.csv", row.names = 1)

MOOS_storm4_07_20 <- read.csv("Storms/MOOS_storm4_07_20.csv", row.names = 1)
MOOS_storm4_07_20_Q <- read.csv("Storms/MOOS_storm4_07_20_Q.csv", row.names = 1)
MOOS_storm4_07_20_NO3 <- read.csv("Storms/MOOS_storm4_07_20_NO3.csv", row.names = 1)
MOOS_storm4_07_20_fDOM <- read.csv("Storms/MOOS_storm4_07_20_fDOM.csv", row.names = 1)

MOOS_storm5_07_27 <- read.csv("Storms/MOOS_storm5_07_27.csv", row.names = 1)
MOOS_storm5_07_27_Q <- read.csv("Storms/MOOS_storm5_07_27_Q.csv", row.names = 1)
MOOS_storm5_07_27_NO3 <- read.csv("Storms/MOOS_storm5_07_27_NO3.csv", row.names = 1)
MOOS_storm5_07_27_fDOM <- read.csv("Storms/MOOS_storm5_07_27_fDOM.csv", row.names = 1)

MOOS_storm6a_08_01 <- read.csv("Storms/MOOS_storm6a_08_01.csv", row.names = 1)
MOOS_storm6a_08_01_Q <- read.csv("Storms/MOOS_storm6a_08_01_Q.csv", row.names = 1)
MOOS_storm6a_08_01_NO3 <- read.csv("Storms/MOOS_storm6a_08_01_NO3.csv", row.names = 1)
MOOS_storm6a_08_01_fDOM <- read.csv("Storms/MOOS_storm6a_08_01_fDOM.csv", row.names = 1)

MOOS_storm6b_08_03 <- read.csv("Storms/MOOS_storm6b_08_03.csv", row.names = 1)
MOOS_storm6b_08_03_Q <- read.csv("Storms/MOOS_storm6b_08_03_Q.csv", row.names = 1)
MOOS_storm6b_08_03_NO3 <- read.csv("Storms/MOOS_storm6b_08_03_NO3.csv", row.names = 1)
MOOS_storm6b_08_03_fDOM <- read.csv("Storms/MOOS_storm6b_08_03_fDOM.csv", row.names = 1)

MOOS_storm7a_08_09 <- read.csv("Storms/MOOS_storm7a_08_09.csv", row.names = 1)
MOOS_storm7a_08_09_Q <- read.csv("Storms/MOOS_storm7a_08_09_Q.csv", row.names = 1)
MOOS_storm7a_08_09_NO3 <- read.csv("Storms/MOOS_storm7a_08_09_NO3.csv", row.names = 1)
MOOS_storm7a_08_09_fDOM <- read.csv("Storms/MOOS_storm7a_08_09_fDOM.csv", row.names = 1)

MOOS_storm7b_08_12 <- read.csv("Storms/MOOS_storm7b_08_12.csv", row.names = 1)
MOOS_storm7b_08_12_Q <- read.csv("Storms/MOOS_storm7b_08_12_Q.csv", row.names = 1)
MOOS_storm7b_08_12_NO3 <- read.csv("Storms/MOOS_storm7b_08_12_NO3.csv", row.names = 1)
MOOS_storm7b_08_12_fDOM <- read.csv("Storms/MOOS_storm7b_08_12_fDOM.csv", row.names = 1)

MOOS_storm8_09_03 <- read.csv("Storms/MOOS_storm8_09_03.csv", row.names = 1)
MOOS_storm8_09_03_Q <- read.csv("Storms/MOOS_storm8_09_03_Q.csv", row.names = 1)
MOOS_storm8_09_03_NO3 <- read.csv("Storms/MOOS_storm8_09_03_NO3.csv", row.names = 1)
MOOS_storm8_09_03_fDOM <- read.csv("Storms/MOOS_storm8_09_03_fDOM.csv", row.names = 1)

MOOS_storm9_09_09 <- read.csv("Storms/MOOS_storm9_09_09.csv", row.names = 1)
MOOS_storm9_09_09_Q <- read.csv("Storms/MOOS_storm9_09_09_Q.csv", row.names = 1)
MOOS_storm9_09_09_NO3 <- read.csv("Storms/MOOS_storm9_09_09_NO3.csv", row.names = 1)
MOOS_storm9_09_09_fDOM <- read.csv("Storms/MOOS_storm9_09_09_fDOM.csv", row.names = 1)

# FRCH #
FRCH_storm1_06_13 <- read.csv("Storms/FRCH_storm1_06_13.csv", row.names = 1)
FRCH_storm1_06_13_Q <- read.csv("Storms/FRCH_storm1_06_13_Q.csv", row.names = 1)
FRCH_storm1_06_13_NO3 <- read.csv("Storms/FRCH_storm1_06_13_NO3.csv", row.names = 1)
FRCH_storm1_06_13_fDOM <- read.csv("Storms/FRCH_storm1_06_13_fDOM.csv", row.names = 1)

FRCH_storm2_06_19 <- read.csv("Storms/FRCH_storm2_06_19.csv", row.names = 1)
FRCH_storm2_06_19_Q <- read.csv("Storms/FRCH_storm2_06_19_Q.csv", row.names = 1)
FRCH_storm2_06_19_NO3 <- read.csv("Storms/FRCH_storm2_06_19_NO3.csv", row.names = 1)
FRCH_storm2_06_19_fDOM <- read.csv("Storms/FRCH_storm2_06_19_fDOM.csv", row.names = 1)

FRCH_storm3a_06_20 <- read.csv("Storms/FRCH_storm3a_06_20.csv", row.names = 1)
FRCH_storm3a_06_20_Q <- read.csv("Storms/FRCH_storm3a_06_20_Q.csv", row.names = 1)
FRCH_storm3a_06_20_NO3 <- read.csv("Storms/FRCH_storm3a_06_20_NO3.csv", row.names = 1)
FRCH_storm3a_06_20_fDOM <- read.csv("Storms/FRCH_storm3a_06_20_fDOM.csv", row.names = 1)

FRCH_storm3b_06_22 <- read.csv("Storms/FRCH_storm3b_06_22.csv", row.names = 1)
FRCH_storm3b_06_22_Q <- read.csv("Storms/FRCH_storm3b_06_22_Q.csv", row.names = 1)
FRCH_storm3b_06_22_NO3 <- read.csv("Storms/FRCH_storm3b_06_22_NO3.csv", row.names = 1)
FRCH_storm3b_06_22_fDOM <- read.csv("Storms/FRCH_storm3b_06_22_fDOM.csv", row.names = 1)

FRCH_storm3c_06_28 <- read.csv("Storms/FRCH_storm3c_06_28.csv", row.names = 1)
FRCH_storm3c_06_28_Q <- read.csv("Storms/FRCH_storm3c_06_28_Q.csv", row.names = 1)
FRCH_storm3c_06_28_NO3 <- read.csv("Storms/FRCH_storm3c_06_28_NO3.csv", row.names = 1)
FRCH_storm3c_06_28_fDOM <- read.csv("Storms/FRCH_storm3c_06_28_fDOM.csv", row.names = 1)

FRCH_storm4a_07_07 <- read.csv("Storms/FRCH_storm4a_07_07.csv", row.names = 1)
FRCH_storm4a_07_07_Q <- read.csv("Storms/FRCH_storm4a_07_07_Q.csv", row.names = 1)
FRCH_storm4a_07_07_NO3 <- read.csv("Storms/FRCH_storm4a_07_07_NO3.csv", row.names = 1)
FRCH_storm4a_07_07_fDOM <- read.csv("Storms/FRCH_storm4a_07_07_fDOM.csv", row.names = 1)

FRCH_storm4b_07_09 <- read.csv("Storms/FRCH_storm4b_07_09.csv", row.names = 1)
FRCH_storm4b_07_09_Q <- read.csv("Storms/FRCH_storm4b_07_09_Q.csv", row.names = 1)
FRCH_storm4b_07_09_NO3 <- read.csv("Storms/FRCH_storm4b_07_09_NO3.csv", row.names = 1)
FRCH_storm4b_07_09_fDOM <- read.csv("Storms/FRCH_storm4b_07_09_fDOM.csv", row.names = 1)

FRCH_storm5_07_16 <- read.csv("Storms/FRCH_storm5_07_16.csv", row.names = 1)
FRCH_storm5_07_16_Q <- read.csv("Storms/FRCH_storm5_07_16_Q.csv", row.names = 1)
FRCH_storm5_07_16_NO3 <- read.csv("Storms/FRCH_storm5_07_16_NO3.csv", row.names = 1)
FRCH_storm5_07_16_fDOM <- read.csv("Storms/FRCH_storm5_07_16_fDOM.csv", row.names = 1)

FRCH_storm6_07_17 <- read.csv("Storms/FRCH_storm6_07_17.csv", row.names = 1)
FRCH_storm6_07_17_Q <- read.csv("Storms/FRCH_storm6_07_17_Q.csv", row.names = 1)
FRCH_storm6_07_17_NO3 <- read.csv("Storms/FRCH_storm6_07_17_NO3.csv", row.names = 1)
FRCH_storm6_07_17_fDOM <- read.csv("Storms/FRCH_storm6_07_17_fDOM.csv", row.names = 1)

FRCH_storm7_07_20 <- read.csv("Storms/FRCH_storm7_07_20.csv", row.names = 1)
FRCH_storm7_07_20_Q <- read.csv("Storms/FRCH_storm7_07_20_Q.csv", row.names = 1)
FRCH_storm7_07_20_NO3 <- read.csv("Storms/FRCH_storm7_07_20_NO3.csv", row.names = 1)
FRCH_storm7_07_20_fDOM <- read.csv("Storms/FRCH_storm7_07_20_fDOM.csv", row.names = 1)

FRCH_storm8_07_26 <- read.csv("Storms/FRCH_storm8_07_26.csv", row.names = 1)
FRCH_storm8_07_26_Q <- read.csv("Storms/FRCH_storm8_07_26_Q.csv", row.names = 1)
FRCH_storm8_07_26_NO3 <- read.csv("Storms/FRCH_storm8_07_26_NO3.csv", row.names = 1)
FRCH_storm8_07_26_fDOM <- read.csv("Storms/FRCH_storm8_07_26_fDOM.csv", row.names = 1)

FRCH_storm9a_08_01 <- read.csv("Storms/FRCH_storm9a_08_01.csv", row.names = 1)
FRCH_storm9a_08_01_Q <- read.csv("Storms/FRCH_storm9a_08_01_Q.csv", row.names = 1)
FRCH_storm9a_08_01_NO3 <- read.csv("Storms/FRCH_storm9a_08_01_NO3.csv", row.names = 1)
FRCH_storm9a_08_01_fDOM <- read.csv("Storms/FRCH_storm9a_08_01_fDOM.csv", row.names = 1)

FRCH_storm9b_08_02 <- read.csv("Storms/FRCH_storm9b_08_02.csv", row.names = 1)
FRCH_storm9b_08_02_Q <- read.csv("Storms/FRCH_storm9b_08_02_Q.csv", row.names = 1)
FRCH_storm9b_08_02_NO3 <- read.csv("Storms/FRCH_storm9b_08_02_NO3.csv", row.names = 1)
FRCH_storm9b_08_02_fDOM <- read.csv("Storms/FRCH_storm9b_08_02_fDOM.csv", row.names = 1)

# VAUL # 
VAUL_storm1a_06_19 <- read.csv("Storms/VAUL_storm1a_06_19.csv", row.names = 1)
VAUL_storm1a_06_19_Q <- read.csv("Storms/VAUL_storm1a_06_19_Q.csv", row.names = 1)
VAUL_storm1a_06_19_NO3 <- read.csv("Storms/VAUL_storm1a_06_19_NO3.csv", row.names = 1)
VAUL_storm1a_06_19_fDOM <- read.csv("Storms/VAUL_storm1a_06_19_fDOM.csv", row.names = 1)

VAUL_storm1b_06_20 <- read.csv("Storms/VAUL_storm1b_06_20.csv", row.names = 1)
VAUL_storm1b_06_20_Q <- read.csv("Storms/VAUL_storm1b_06_20_Q.csv", row.names = 1)
VAUL_storm1b_06_20_NO3 <- read.csv("Storms/VAUL_storm1b_06_20_NO3.csv", row.names = 1)
VAUL_storm1b_06_20_fDOM <- read.csv("Storms/VAUL_storm1b_06_20_fDOM.csv", row.names = 1)

VAUL_storm1c_06_22 <- read.csv("Storms/VAUL_storm1c_06_22.csv", row.names = 1)
VAUL_storm1c_06_22_Q <- read.csv("Storms/VAUL_storm1c_06_22_Q.csv", row.names = 1)
VAUL_storm1c_06_22_NO3 <- read.csv("Storms/VAUL_storm1c_06_22_NO3.csv", row.names = 1)
VAUL_storm1c_06_22_fDOM <- read.csv("Storms/VAUL_storm1c_06_22_fDOM.csv", row.names = 1)

VAUL_storm2_06_28 <- read.csv("Storms/VAUL_storm2_06_28.csv", row.names = 1)
VAUL_storm2_06_28_Q <- read.csv("Storms/VAUL_storm2_06_28_Q.csv", row.names = 1)
VAUL_storm2_06_28_NO3 <- read.csv("Storms/VAUL_storm2_06_28_NO3.csv", row.names = 1)
VAUL_storm2_06_28_fDOM <- read.csv("Storms/VAUL_storm2_06_28_fDOM.csv", row.names = 1)

VAUL_storm3_07_09 <- read.csv("Storms/VAUL_storm3_07_09.csv", row.names = 1)
VAUL_storm3_07_09_Q <- read.csv("Storms/VAUL_storm3_07_09_Q.csv", row.names = 1)
VAUL_storm3_07_09_NO3 <- read.csv("Storms/VAUL_storm3_07_09_NO3.csv", row.names = 1)
VAUL_storm3_07_09_fDOM <- read.csv("Storms/VAUL_storm3_07_09_fDOM.csv", row.names = 1)

VAUL_storm4_07_12 <- read.csv("Storms/VAUL_storm4_07_12.csv", row.names = 1)
VAUL_storm4_07_12_Q <- read.csv("Storms/VAUL_storm4_07_12_Q.csv", row.names = 1)
VAUL_storm4_07_12_NO3 <- read.csv("Storms/VAUL_storm4_07_12_NO3.csv", row.names = 1)
VAUL_storm4_07_12_fDOM <- read.csv("Storms/VAUL_storm4_07_12_fDOM.csv", row.names = 1)

VAUL_storm5_07_27 <- read.csv("Storms/VAUL_storm5_07_27.csv", row.names = 1)
VAUL_storm5_07_27_Q <- read.csv("Storms/VAUL_storm5_07_27_Q.csv", row.names = 1)
VAUL_storm5_07_27_NO3 <- read.csv("Storms/VAUL_storm5_07_27_NO3.csv", row.names = 1)
VAUL_storm5_07_27_fDOM <- read.csv("Storms/VAUL_storm5_07_27_fDOM.csv", row.names = 1)

VAUL_storm6a_08_01 <- read.csv("Storms/VAUL_storm6a_08_01.csv", row.names = 1)
VAUL_storm6a_08_01_Q <- read.csv("Storms/VAUL_storm6a_08_01_Q.csv", row.names = 1)
VAUL_storm6a_08_01_NO3 <- read.csv("Storms/VAUL_storm6a_08_01_NO3.csv", row.names = 1)
VAUL_storm6a_08_01_fDOM <- read.csv("Storms/VAUL_storm6a_08_01_fDOM.csv", row.names = 1)

VAUL_storm6b_08_02 <- read.csv("Storms/VAUL_storm6b_08_02.csv", row.names = 1)
VAUL_storm6b_08_02_Q <- read.csv("Storms/VAUL_storm6b_08_02_Q.csv", row.names = 1)
VAUL_storm6b_08_02_NO3 <- read.csv("Storms/VAUL_storm6b_08_02_NO3.csv", row.names = 1)
VAUL_storm6b_08_02_fDOM <- read.csv("Storms/VAUL_storm6b_08_02_fDOM.csv", row.names = 1)

VAUL_storm7_08_08 <- read.csv("Storms/VAUL_storm7_08_08.csv", row.names = 1)
VAUL_storm7_08_08_Q <- read.csv("Storms/VAUL_storm7_08_08_Q.csv", row.names = 1)
VAUL_storm7_08_08_NO3 <- read.csv("Storms/VAUL_storm7_08_08_NO3.csv", row.names = 1)
VAUL_storm7_08_08_fDOM <- read.csv("Storms/VAUL_storm7_08_08_fDOM.csv", row.names = 1)

VAUL_storm8_08_11 <- read.csv("Storms/VAUL_storm8_08_11.csv", row.names = 1)
VAUL_storm8_08_11_Q <- read.csv("Storms/VAUL_storm8_08_11_Q.csv", row.names = 1)
VAUL_storm8_08_11_NO3 <- read.csv("Storms/VAUL_storm8_08_11_NO3.csv", row.names = 1)
VAUL_storm8_08_11_fDOM <- read.csv("Storms/VAUL_storm8_08_11_fDOM.csv", row.names = 1)

VAUL_storm9_08_12 <- read.csv("Storms/VAUL_storm9_08_12.csv", row.names = 1)
VAUL_storm9_08_12_Q <- read.csv("Storms/VAUL_storm9_08_12_Q.csv", row.names = 1)
VAUL_storm9_08_12_NO3 <- read.csv("Storms/VAUL_storm9_08_12_NO3.csv", row.names = 1)
VAUL_storm9_08_12_fDOM <- read.csv("Storms/VAUL_storm9_08_12_fDOM.csv", row.names = 1)

VAUL_storm10_08_25 <- read.csv("Storms/VAUL_storm10_08_25.csv", row.names = 1)
VAUL_storm10_08_25_Q <- read.csv("Storms/VAUL_storm10_08_25_Q.csv", row.names = 1)
VAUL_storm10_08_25_NO3 <- read.csv("Storms/VAUL_storm10_08_25_NO3.csv", row.names = 1)
VAUL_storm10_08_25_fDOM <- read.csv("Storms/VAUL_storm10_08_25_fDOM.csv", row.names = 1)

VAUL_storm11_08_27 <- read.csv("Storms/VAUL_storm11_08_27.csv", row.names = 1)
VAUL_storm11_08_27_Q <- read.csv("Storms/VAUL_storm11_08_27_Q.csv", row.names = 1)
VAUL_storm11_08_27_NO3 <- read.csv("Storms/VAUL_storm11_08_27_NO3.csv", row.names = 1)
VAUL_storm11_08_27_fDOM <- read.csv("Storms/VAUL_storm11_08_27_fDOM.csv", row.names = 1)

VAUL_storm12_09_01 <- read.csv("Storms/VAUL_storm12_09_01.csv", row.names = 1)
VAUL_storm12_09_01_Q <- read.csv("Storms/VAUL_storm12_09_01_Q.csv", row.names = 1)
VAUL_storm12_09_01_NO3 <- read.csv("Storms/VAUL_storm12_09_01_NO3.csv", row.names = 1)
VAUL_storm12_09_01_fDOM <- read.csv("Storms/VAUL_storm12_09_01_fDOM.csv", row.names = 1)

VAUL_storm13_09_03 <- read.csv("Storms/VAUL_storm13_09_03.csv", row.names = 1)
VAUL_storm13_09_03_Q <- read.csv("Storms/VAUL_storm13_09_03_Q.csv", row.names = 1)
VAUL_storm13_09_03_NO3 <- read.csv("Storms/VAUL_storm13_09_03_NO3.csv", row.names = 1)
VAUL_storm13_09_03_fDOM <- read.csv("Storms/VAUL_storm13_09_03_fDOM.csv", row.names = 1)

VAUL_storm14_09_06 <- read.csv("Storms/VAUL_storm14_09_06.csv", row.names = 1)
VAUL_storm14_09_06_Q <- read.csv("Storms/VAUL_storm14_09_06_Q.csv", row.names = 1)
VAUL_storm14_09_06_NO3 <- read.csv("Storms/VAUL_storm14_09_06_NO3.csv", row.names = 1)
VAUL_storm14_09_06_fDOM <- read.csv("Storms/VAUL_storm14_09_06_fDOM.csv", row.names = 1)

POKE_storm1_06_09 <- read.csv("Storms/POKE_storm1_06_09.csv", row.names = 1)
POKE_storm1_06_09_Q <- read.csv("Storms/POKE_storm1_06_09_Q.csv", row.names = 1)
POKE_storm1_06_09_NO3 <- read.csv("Storms/POKE_storm1_06_09_NO3.csv", row.names = 1)
POKE_storm1_06_09_fDOM <- read.csv("Storms/POKE_storm1_06_09_fDOM.csv", row.names = 1)

POKE_storm2_06_12 <- read.csv("Storms/POKE_storm2_06_12.csv", row.names = 1)
POKE_storm2_06_12_Q <- read.csv("Storms/POKE_storm2_06_12_Q.csv", row.names = 1)
POKE_storm2_06_12_NO3 <- read.csv("Storms/POKE_storm2_06_12_NO3.csv", row.names = 1)
POKE_storm2_06_12_fDOM <- read.csv("Storms/POKE_storm2_06_12_fDOM.csv", row.names = 1)

POKE_storm3_06_15 <- read.csv("Storms/POKE_storm3_06_15.csv", row.names = 1)
POKE_storm3_06_15_Q <- read.csv("Storms/POKE_storm3_06_15_Q.csv", row.names = 1)
POKE_storm3_06_15_NO3 <- read.csv("Storms/POKE_storm3_06_15_NO3.csv", row.names = 1)
POKE_storm3_06_15_fDOM <- read.csv("Storms/POKE_storm3_06_15_fDOM.csv", row.names = 1)

POKE_storm4a_06_19 <- read.csv("Storms/POKE_storm4a_06_19.csv", row.names = 1)
POKE_storm4a_06_19_Q <- read.csv("Storms/POKE_storm4a_06_19_Q.csv", row.names = 1)
POKE_storm4a_06_19_NO3 <- read.csv("Storms/POKE_storm4a_06_19_NO3.csv", row.names = 1)
POKE_storm4a_06_19_fDOM <- read.csv("Storms/POKE_storm4a_06_19_fDOM.csv", row.names = 1)

POKE_storm4b_06_20 <- read.csv("Storms/POKE_storm4b_06_20.csv", row.names = 1)
POKE_storm4b_06_20_Q <- read.csv("Storms/POKE_storm4b_06_20_Q.csv", row.names = 1)
POKE_storm4b_06_20_NO3 <- read.csv("Storms/POKE_storm4b_06_20_NO3.csv", row.names = 1)
POKE_storm4b_06_20_fDOM <- read.csv("Storms/POKE_storm4b_06_20_fDOM.csv", row.names = 1)

POKE_storm4c_06_21 <- read.csv("Storms/POKE_storm4c_06_21.csv", row.names = 1)
POKE_storm4c_06_21_Q <- read.csv("Storms/POKE_storm4c_06_21_Q.csv", row.names = 1)
POKE_storm4c_06_21_NO3 <- read.csv("Storms/POKE_storm4c_06_21_NO3.csv", row.names = 1)
POKE_storm4c_06_21_fDOM <- read.csv("Storms/POKE_storm4c_06_21_fDOM.csv", row.names = 1)

POKE_storm5_06_22 <- read.csv("Storms/POKE_storm5_06_22.csv", row.names = 1)
POKE_storm5_06_22_Q <- read.csv("Storms/POKE_storm5_06_22_Q.csv", row.names = 1)
POKE_storm5_06_22_NO3 <- read.csv("Storms/POKE_storm5_06_22_NO3.csv", row.names = 1)
POKE_storm5_06_22_fDOM <- read.csv("Storms/POKE_storm5_06_22_fDOM.csv", row.names = 1)

POKE_storm6_06_29 <- read.csv("Storms/POKE_storm6_06_29.csv", row.names = 1)
POKE_storm6_06_29_Q <- read.csv("Storms/POKE_storm6_06_29_Q.csv", row.names = 1)
POKE_storm6_06_29_NO3 <- read.csv("Storms/POKE_storm6_06_29_NO3.csv", row.names = 1)
POKE_storm6_06_29_fDOM <- read.csv("Storms/POKE_storm6_06_29_fDOM.csv", row.names = 1)

POKE_storm7_07_04 <- read.csv("Storms/POKE_storm7_07_04.csv", row.names = 1)
POKE_storm7_07_04_Q <- read.csv("Storms/POKE_storm7_07_04_Q.csv", row.names = 1)
POKE_storm7_07_04_NO3 <- read.csv("Storms/POKE_storm7_07_04_NO3.csv", row.names = 1)
POKE_storm7_07_04_fDOM <- read.csv("Storms/POKE_storm7_07_04_fDOM.csv", row.names = 1)

POKE_storm8_07_09 <- read.csv("Storms/POKE_storm8_07_09.csv", row.names = 1)
POKE_storm8_07_09_Q <- read.csv("Storms/POKE_storm8_07_09_Q.csv", row.names = 1)
POKE_storm8_07_09_NO3 <- read.csv("Storms/POKE_storm8_07_09_NO3.csv", row.names = 1)
POKE_storm8_07_09_fDOM <- read.csv("Storms/POKE_storm8_07_09_fDOM.csv", row.names = 1)

POKE_storm9_07_12 <- read.csv("Storms/POKE_storm9_07_12.csv", row.names = 1)
POKE_storm9_07_12_Q <- read.csv("Storms/POKE_storm9_07_12_Q.csv", row.names = 1)
POKE_storm9_07_12_NO3 <- read.csv("Storms/POKE_storm9_07_12_NO3.csv", row.names = 1)
POKE_storm9_07_12_fDOM <- read.csv("Storms/POKE_storm9_07_12_fDOM.csv", row.names = 1)

POKE_storm10_07_16 <- read.csv("Storms/POKE_storm10_07_16.csv", row.names = 1)
POKE_storm10_07_16_Q <- read.csv("Storms/POKE_storm10_07_16_Q.csv", row.names = 1)
POKE_storm10_07_16_NO3 <- read.csv("Storms/POKE_storm10_07_16_NO3.csv", row.names = 1)
POKE_storm10_07_16_fDOM <- read.csv("Storms/POKE_storm10_07_16_fDOM.csv", row.names = 1)

POKE_storm11_07_18 <- read.csv("Storms/POKE_storm11_07_18.csv", row.names = 1)
POKE_storm11_07_18_Q <- read.csv("Storms/POKE_storm11_07_18_Q.csv", row.names = 1)
POKE_storm11_07_18_NO3 <- read.csv("Storms/POKE_storm11_07_18_NO3.csv", row.names = 1)
POKE_storm11_07_18_fDOM <- read.csv("Storms/POKE_storm11_07_18_fDOM.csv", row.names = 1)

POKE_storm12_07_20 <- read.csv("Storms/POKE_storm12_07_20.csv", row.names = 1)
POKE_storm12_07_20_Q <- read.csv("Storms/POKE_storm12_07_20_Q.csv", row.names = 1)
POKE_storm12_07_20_NO3 <- read.csv("Storms/POKE_storm12_07_20_NO3.csv", row.names = 1)
POKE_storm12_07_20_fDOM <- read.csv("Storms/POKE_storm12_07_20_fDOM.csv", row.names = 1)

POKE_storm13_07_24 <- read.csv("Storms/POKE_storm13_07_24.csv", row.names = 1)
POKE_storm13_07_24_Q <- read.csv("Storms/POKE_storm13_07_24_Q.csv", row.names = 1)
POKE_storm13_07_24_NO3 <- read.csv("Storms/POKE_storm13_07_24_NO3.csv", row.names = 1)
POKE_storm13_07_24_fDOM <- read.csv("Storms/POKE_storm13_07_24_fDOM.csv", row.names = 1)

POKE_storm14_07_26 <- read.csv("Storms/POKE_storm14_07_26.csv", row.names = 1)
POKE_storm14_07_26_Q <- read.csv("Storms/POKE_storm14_07_26_Q.csv", row.names = 1)
POKE_storm14_07_26_NO3 <- read.csv("Storms/POKE_storm14_07_26_NO3.csv", row.names = 1)
POKE_storm14_07_26_fDOM <- read.csv("Storms/POKE_storm14_07_26_fDOM.csv", row.names = 1)

POKE_storm15_08_02 <- read.csv("Storms/POKE_storm15_08_02.csv", row.names = 1)
POKE_storm15_08_02_Q <- read.csv("Storms/POKE_storm15_08_02_Q.csv", row.names = 1)
POKE_storm15_08_02_NO3 <- read.csv("Storms/POKE_storm15_08_02_NO3.csv", row.names = 1)
POKE_storm15_08_02_fDOM <- read.csv("Storms/POKE_storm15_08_02_fDOM.csv", row.names = 1)

POKE_storm16_08_12 <- read.csv("Storms/POKE_storm16_08_12.csv", row.names = 1)
POKE_storm16_08_12_Q <- read.csv("Storms/POKE_storm16_08_12_Q.csv", row.names = 1)
POKE_storm16_08_12_NO3 <- read.csv("Storms/POKE_storm16_08_12_NO3.csv", row.names = 1)
POKE_storm16_08_12_fDOM <- read.csv("Storms/POKE_storm16_08_12_fDOM.csv", row.names = 1)

POKE_storm17_08_24 <- read.csv("Storms/POKE_storm17_08_24.csv", row.names = 1)
POKE_storm17_08_24_Q <- read.csv("Storms/POKE_storm17_08_24_Q.csv", row.names = 1)
POKE_storm17_08_24_NO3 <- read.csv("Storms/POKE_storm17_08_24_NO3.csv", row.names = 1)
POKE_storm17_08_24_fDOM <- read.csv("Storms/POKE_storm17_08_24_fDOM.csv", row.names = 1)

POKE_storm18_08_25 <- read.csv("Storms/POKE_storm18_08_25.csv", row.names = 1)
POKE_storm18_08_25_Q <- read.csv("Storms/POKE_storm18_08_25_Q.csv", row.names = 1)
POKE_storm18_08_25_NO3 <- read.csv("Storms/POKE_storm18_08_25_NO3.csv", row.names = 1)
POKE_storm18_08_25_fDOM <- read.csv("Storms/POKE_storm18_08_25_fDOM.csv", row.names = 1)

POKE_storm19_08_27 <- read.csv("Storms/POKE_storm19_08_27.csv", row.names = 1)
POKE_storm19_08_27_Q <- read.csv("Storms/POKE_storm19_08_27_Q.csv", row.names = 1)
POKE_storm19_08_27_NO3 <- read.csv("Storms/POKE_storm19_08_27_NO3.csv", row.names = 1)
POKE_storm19_08_27_fDOM <- read.csv("Storms/POKE_storm19_08_27_fDOM.csv", row.names = 1)

POKE_storm20_09_01 <- read.csv("Storms/POKE_storm20_09_01.csv", row.names = 1)
POKE_storm20_09_01_Q <- read.csv("Storms/POKE_storm20_09_01_Q.csv", row.names = 1)
POKE_storm20_09_01_NO3 <- read.csv("Storms/POKE_storm20_09_01_NO3.csv", row.names = 1)
POKE_storm20_09_01_fDOM <- read.csv("Storms/POKE_storm20_09_01_fDOM.csv", row.names = 1)

POKE_storm21_09_03 <- read.csv("Storms/POKE_storm21_09_03.csv", row.names = 1)
POKE_storm21_09_03_Q <- read.csv("Storms/POKE_storm21_09_03_Q.csv", row.names = 1)
POKE_storm21_09_03_NO3 <- read.csv("Storms/POKE_storm21_09_03_NO3.csv", row.names = 1)
POKE_storm21_09_03_fDOM <- read.csv("Storms/POKE_storm21_09_03_fDOM.csv", row.names = 1)

POKE_storm22a_09_07 <- read.csv("Storms/POKE_storm22a_09_07.csv", row.names = 1)
POKE_storm22a_09_07_Q <- read.csv("Storms/POKE_storm22a_09_07_Q.csv", row.names = 1)
POKE_storm22a_09_07_NO3 <- read.csv("Storms/POKE_storm22a_09_07_NO3.csv", row.names = 1)
POKE_storm22a_09_07_fDOM <- read.csv("Storms/POKE_storm22a_09_07_fDOM.csv", row.names = 1)

POKE_storm22b_09_09 <- read.csv("Storms/POKE_storm22b_09_09.csv", row.names = 1)
POKE_storm22b_09_09_Q <- read.csv("Storms/POKE_storm22b_09_09_Q.csv", row.names = 1)
POKE_storm22b_09_09_NO3 <- read.csv("Storms/POKE_storm22b_09_09_NO3.csv", row.names = 1)
POKE_storm22b_09_09_fDOM <- read.csv("Storms/POKE_storm22b_09_09_fDOM.csv", row.names = 1)

# normalize data #
dfList <- Filter(function(x) is(x, "data.frame"), mget(ls()))

for(i in 1:length(dfList)) {
  dfList[[i]][["datavalue"]] = 
    (dfList[[i]][["datavalue"]] - min(dfList[[i]][["datavalue"]], na.rm=T)) / (max(dfList[[i]][["datavalue"]], na.rm=T) - min(dfList[[i]][["datavalue"]], na.rm=T))
}
list2env(dfList ,.GlobalEnv)

#### fxn: plot hysteresis loop ####
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
  dat.p = ggplot(data = dat_Q, 
                 aes(x=(dat_Q$datavalue), 
                     y=(dat_response$datavalue), 
                     color = as.numeric(dat_Q$valuedatetime))) +
    geom_point() +
    scale_colour_gradientn(colors = rainbow(3)) +
    theme_bw() +
    theme(legend.position="none") + 
    theme(axis.text=element_text(size=12),
          axis.title=element_text(size=14,face="bold")) +
    ylab(paste(site, response_var))+
    xlab("Normalized Discharge") +
    ggtitle(paste("Storm", storm_num))
  return(dat.p)
}

# plot STRT loops #
# NO3
STRT_storm1a_06_18_NO3.p = hyst_plot(STRT_storm1a_06_18_Q, STRT_storm1a_06_18_NO3, "STRT", "NO3", "0618a")
STRT_storm1b_06_19_NO3.p = hyst_plot(STRT_storm1b_06_19_Q, STRT_storm1b_06_19_NO3, "STRT", "NO3", "0619b")
STRT_storm1c_06_21_NO3.p = hyst_plot(STRT_storm1c_06_21_Q, STRT_storm1c_06_21_NO3, "STRT", "NO3", "0621c")
STRT_storm1d_06_22_NO3.p = hyst_plot(STRT_storm1d_06_22_Q, STRT_storm1d_06_22_NO3, "STRT", "NO3", "0622d")
STRT_storm1e_06_23_NO3.p = hyst_plot(STRT_storm1e_06_23_Q, STRT_storm1e_06_23_NO3, "STRT", "NO3", "0623e")
STRT_storm2_07_09_NO3.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_NO3, "STRT", "NO3", "0709")
STRT_storm3_07_20_NO3.p = hyst_plot(STRT_storm3_07_20_Q, STRT_storm3_07_20_NO3, "STRT", "NO3", "0720")
STRT_storm4a_08_01_NO3.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_NO3, "STRT", "NO3", "0801a")
STRT_storm4b_08_02_NO3.p = hyst_plot(STRT_storm4b_08_02_Q, STRT_storm4b_08_02_NO3, "STRT", "NO3", "0802b")
STRT_storm5_08_09_NO3.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_NO3, "STRT", "NO3", "0809")
STRT_storm6_08_12_NO3.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_NO3, "STRT", "NO3", "0812")
STRT_storm7a_08_20_NO3.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_NO3, "STRT", "NO3", "0820a")
STRT_storm7b_08_21_NO3.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_NO3, "STRT", "NO3", "0821b")
STRT_storm8_08_28_NO3.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_NO3, "STRT", "NO3", "0828")
STRT_storm9a_09_03_NO3.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_NO3, "STRT", "NO3", "0903a")
STRT_storm9b_09_06_NO3.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_NO3, "STRT", "NO3", "0906b")
STRT_storm9c_09_09_NO3.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_NO3, "STRT", "NO3", "0909c")
STRT_storm10_09_23_NO3.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_NO3, "STRT", "NO3", "0923")

# fDOM #
STRT_storm1a_06_18_fDOM.p = hyst_plot(STRT_storm1a_06_18_Q, STRT_storm1a_06_18_fDOM, "STRT", "fDOM", "0618a")
STRT_storm1b_06_19_fDOM.p = hyst_plot(STRT_storm1b_06_19_Q, STRT_storm1b_06_19_fDOM, "STRT", "fDOM", "0619b")
STRT_storm1c_06_21_fDOM.p = hyst_plot(STRT_storm1c_06_21_Q, STRT_storm1c_06_21_fDOM, "STRT", "fDOM", "0621c")
STRT_storm1d_06_22_fDOM.p = hyst_plot(STRT_storm1d_06_22_Q, STRT_storm1d_06_22_fDOM, "STRT", "fDOM", "0622d")
STRT_storm1e_06_23_fDOM.p = hyst_plot(STRT_storm1e_06_23_Q, STRT_storm1e_06_23_fDOM, "STRT", "fDOM", "0623e")
STRT_storm2_07_09_fDOM.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_fDOM, "STRT", "fDOM", "0709")
STRT_storm3_07_20_fDOM.p = hyst_plot(STRT_storm3_07_20_Q, STRT_storm3_07_20_fDOM, "STRT", "fDOM", "0720")
STRT_storm4a_08_01_fDOM.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_fDOM, "STRT", "fDOM", "0801a")
STRT_storm4b_08_02_fDOM.p = hyst_plot(STRT_storm4b_08_02_Q, STRT_storm4b_08_02_fDOM, "STRT", "fDOM", "0803b")
STRT_storm5_08_09_fDOM.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_fDOM, "STRT", "fDOM", "0809")
STRT_storm6_08_12_fDOM.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_fDOM, "STRT", "fDOM", "0812")
STRT_storm7a_08_20_fDOM.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_fDOM, "STRT", "fDOM", "0820a")
STRT_storm7b_08_21_fDOM.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_fDOM, "STRT", "fDOM", "0821b")
STRT_storm8_08_28_fDOM.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_fDOM, "STRT", "fDOM", "0828")
STRT_storm9a_09_03_fDOM.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_fDOM, "STRT", "fDOM", "0903a")
STRT_storm9b_09_06_fDOM.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_fDOM, "STRT", "fDOM", "0906b")
STRT_storm9c_09_09_fDOM.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_fDOM, "STRT", "fDOM", "0909c")
STRT_storm10_09_23_fDOM.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_fDOM, "STRT", "fDOM", "0923")

# SPC #
STRT_storm1a_06_18_SPC.p = hyst_plot(STRT_storm1a_06_18_Q, STRT_storm1a_06_18_SPC, "STRT", "SPC", "0618a")
STRT_storm1b_06_19_SPC.p = hyst_plot(STRT_storm1b_06_19_Q, STRT_storm1b_06_19_SPC, "STRT", "SPC", "0619b")
STRT_storm1c_06_21_SPC.p = hyst_plot(STRT_storm1c_06_21_Q, STRT_storm1c_06_21_SPC, "STRT", "SPC", "0621c")
STRT_storm1d_06_22_SPC.p = hyst_plot(STRT_storm1d_06_22_Q, STRT_storm1d_06_22_SPC, "STRT", "SPC", "0622d")
STRT_storm1e_06_23_SPC.p = hyst_plot(STRT_storm1e_06_23_Q, STRT_storm1e_06_23_SPC, "STRT", "SPC", "0623e")
STRT_storm2_07_09_SPC.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_SPC, "STRT", "SPC", "0709")
STRT_storm3_07_20_SPC.p = hyst_plot(STRT_storm3_07_20_Q, STRT_storm3_07_20_SPC, "STRT", "SPC", "0720")
STRT_storm4a_08_01_SPC.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_SPC, "STRT", "SPC", "0801a")
STRT_storm4b_08_02_SPC.p = hyst_plot(STRT_storm4b_08_02_Q, STRT_storm4b_08_02_SPC, "STRT", "SPC", "0803b")
STRT_storm5_08_09_SPC.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_SPC, "STRT", "SPC", "0809")
STRT_storm6_08_12_SPC.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_SPC, "STRT", "SPC", "0812")
STRT_storm7a_08_20_SPC.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_SPC, "STRT", "SPC", "0820a")
STRT_storm7b_08_21_SPC.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_SPC, "STRT", "SPC", "0821b")
STRT_storm8_08_28_SPC.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_SPC, "STRT", "SPC", "0828")
STRT_storm9a_09_03_SPC.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_SPC, "STRT", "SPC", "0903a")
STRT_storm9b_09_06_SPC.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_SPC, "STRT", "SPC", "0906b")
STRT_storm9c_09_09_SPC.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_SPC, "STRT", "SPC", "0909c")
STRT_storm10_09_23_SPC.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_SPC, "STRT", "SPC", "0923")

# turb
STRT_storm1a_06_18_turb.p = hyst_plot(STRT_storm1a_06_18_Q, STRT_storm1a_06_18_turb, "STRT", "turb", "0618a")
STRT_storm1b_06_19_turb.p = hyst_plot(STRT_storm1b_06_19_Q, STRT_storm1b_06_19_turb, "STRT", "turb", "0619b")
STRT_storm1c_06_21_turb.p = hyst_plot(STRT_storm1c_06_21_Q, STRT_storm1c_06_21_turb, "STRT", "turb", "0621c")
STRT_storm1d_06_22_turb.p = hyst_plot(STRT_storm1d_06_22_Q, STRT_storm1d_06_22_turb, "STRT", "turb", "0622d")
STRT_storm1e_06_23_turb.p = hyst_plot(STRT_storm1e_06_23_Q, STRT_storm1e_06_23_turb, "STRT", "turb", "0623e")
STRT_storm2_07_09_turb.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_turb, "STRT", "turb", "0709")
STRT_storm3_07_20_turb.p = hyst_plot(STRT_storm3_07_20_Q, STRT_storm3_07_20_turb, "STRT", "turb", "0720")
STRT_storm4a_08_01_turb.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_turb, "STRT", "turb", "0801a")
STRT_storm4b_08_02_turb.p = hyst_plot(STRT_storm4b_08_02_Q, STRT_storm4b_08_02_turb, "STRT", "turb", "0803b")
STRT_storm5_08_09_turb.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_turb, "STRT", "turb", "0809")
STRT_storm6_08_12_turb.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_turb, "STRT", "turb", "0812")
STRT_storm7a_08_20_turb.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_turb, "STRT", "turb", "0820a")
STRT_storm7b_08_21_turb.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_turb, "STRT", "turb", "0821b")
STRT_storm8_08_28_turb.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_turb, "STRT", "turb", "0828")
STRT_storm9a_09_03_turb.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_turb, "STRT", "turb", "0903a")
STRT_storm9b_09_06_turb.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_turb, "STRT", "turb", "0906b")
STRT_storm9c_09_09_turb.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_turb, "STRT", "turb", "0909c")
STRT_storm10_09_23_turb.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_turb, "STRT", "turb", "0923")


# Multiplots of STRT storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}


multiplot(STRT_storm1a_06_19_NO3.p, STRT_storm1a_06_19_fDOM.p) # works 
multiplot(STRT_storm1b_06_20_NO3.p, STRT_storm1b_06_20_fDOM.p)# fdom  does not work
multiplot(STRT_storm1c_06_22_NO3.p, STRT_storm1c_06_22_fDOM.p) # works 
multiplot(STRT_storm1d_06_23_NO3.p, STRT_storm1d_06_23_fDOM.p) # works 
multiplot(STRT_storm1e_06_24_NO3.p, STRT_storm1e_06_24_fDOM.p) # works

multiplot(STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p) # fDOM is full of NAs
multiplot(STRT_storm3_07_21_NO3.p, STRT_storm3_07_21_fDOM.p) # works 
multiplot(STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p) # works
multiplot(STRT_storm4b_08_03_NO3.p, STRT_storm4b_08_03_fDOM.p) # works 
multiplot(STRT_storm5_08_09_NO3.p, STRT_storm5_08_09_fDOM.p) # works 
multiplot(STRT_storm6_08_12_NO3.p, STRT_storm6_08_12_fDOM.p) # works 
multiplot(STRT_storm7a_08_20_NO3.p, STRT_storm7a_08_20_fDOM.p) # works
multiplot(STRT_storm7b_08_21_NO3.p, STRT_storm7b_08_21_fDOM.p) # works 
multiplot(STRT_storm8_08_28_NO3.p, STRT_storm8_08_28_fDOM.p) # works
multiplot(STRT_storm9a_09_03_NO3.p, STRT_storm9a_09_03_fDOM.p,
          STRT_storm9b_09_06_NO3.p, STRT_storm9b_09_06_fDOM.p,
          STRT_storm9c_09_09_NO3.p, STRT_storm9c_09_09_fDOM.p) # works
multiplot(STRT_storm10_09_23_NO3.p, STRT_storm10_09_23_fDOM.p) # works 

# SPC #
multiplot(STRT_storm1a_06_18_SPC.p) # works 
multiplot(STRT_storm1b_06_19_SPC.p) # works 
multiplot(STRT_storm1c_06_21_SPC.p) # works 
multiplot(STRT_storm1d_06_22_SPC.p) # works 
multiplot(STRT_storm1e_06_23_SPC.p) # works 
multiplot(STRT_storm2_07_09_SPC.p) # empty
multiplot(STRT_storm3_07_20_SPC.p) # works 
multiplot(STRT_storm4a_08_01_SPC.p) # works 
multiplot(STRT_storm4b_08_02_SPC.p) # works 
multiplot(STRT_storm5_08_09_SPC.p) # works 
multiplot(STRT_storm6_08_12_SPC.p) # works 
multiplot(STRT_storm7a_08_20_SPC.p) # works 
multiplot(STRT_storm7b_08_21_SPC.p) # works 
multiplot(STRT_storm8_08_28_SPC.p) # works 
multiplot(STRT_storm9a_09_03_SPC.p) # works 
multiplot(STRT_storm9b_09_06_SPC.p) # works 
multiplot(STRT_storm9c_09_09_SPC.p) # works 
multiplot(STRT_storm10_09_23_SPC.p) # works 

# turb # 
# SPC #
multiplot(STRT_storm1a_06_18_turb.p) # works 
multiplot(STRT_storm1b_06_19_turb.p) # works 
multiplot(STRT_storm1c_06_21_turb.p) # works 
multiplot(STRT_storm1d_06_22_turb.p) # works 
multiplot(STRT_storm1e_06_23_turb.p) # works 
multiplot(STRT_storm2_07_09_turb.p) # empty
multiplot(STRT_storm3_07_20_turb.p) # works 
multiplot(STRT_storm4a_08_01_turb.p) # works 
multiplot(STRT_storm4b_08_02_turb.p) # works 
multiplot(STRT_storm5_08_09_turb.p) # works 
multiplot(STRT_storm6_08_12_turb.p) # works 
multiplot(STRT_storm7a_08_20_turb.p) # works 
multiplot(STRT_storm7b_08_21_turb.p) # works 
multiplot(STRT_storm8_08_28_turb.p) # works 
multiplot(STRT_storm9a_09_03_turb.p) # works 
multiplot(STRT_storm9b_09_06_turb.p) # works 
multiplot(STRT_storm9c_09_09_turb.p) # works 
multiplot(STRT_storm10_09_23_turb.p) # works 

multiplot(STRT_storm1a_06_18_NO3.p, STRT_storm1a_06_18_fDOM.p, STRT_storm1a_06_18_SPC.p, STRT_storm1a_06_18_turb.p,
          STRT_storm1b_06_19_SPC.p, STRT_storm1b_06_19_turb.p,
          STRT_storm1c_06_21_NO3.p, STRT_storm1c_06_21_fDOM.p, STRT_storm1c_06_21_SPC.p, STRT_storm1c_06_21_turb.p,
          STRT_storm1d_06_22_NO3.p, STRT_storm1d_06_22_fDOM.p, STRT_storm1d_06_22_SPC.p, STRT_storm1d_06_22_turb.p,
          STRT_storm1e_06_23_NO3.p, STRT_storm1e_06_23_fDOM.p, STRT_storm1e_06_23_SPC.p, STRT_storm1e_06_23_turb.p,
          STRT_storm2_07_09_SPC.p, STRT_storm2_07_09_turb.p,
          STRT_storm3_07_20_NO3.p, STRT_storm3_07_20_fDOM.p, STRT_storm3_07_20_SPC.p, STRT_storm3_07_20_turb.p,
          STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p, STRT_storm4a_08_01_SPC.p, STRT_storm4a_08_01_turb.p,
          STRT_storm4b_08_02_NO3.p, STRT_storm4b_08_02_fDOM.p, STRT_storm4b_08_02_SPC.p, STRT_storm4b_08_02_turb.p,
          STRT_storm5_08_09_NO3.p, STRT_storm5_08_09_fDOM.p, STRT_storm5_08_09_SPC.p, STRT_storm5_08_09_turb.p,
          STRT_storm6_08_12_NO3.p, STRT_storm6_08_12_fDOM.p, STRT_storm6_08_12_SPC.p, STRT_storm6_08_12_turb.p,
          STRT_storm7a_08_20_NO3.p, STRT_storm7a_08_20_fDOM.p, STRT_storm7a_08_20_SPC.p, STRT_storm7a_08_20_turb.p,
          STRT_storm7b_08_21_NO3.p, STRT_storm7b_08_21_fDOM.p, STRT_storm7b_08_21_SPC.p, STRT_storm7b_08_21_turb.p,
          STRT_storm8_08_28_NO3.p, STRT_storm8_08_28_fDOM.p, STRT_storm8_08_28_SPC.p, STRT_storm8_08_28_turb.p,
          STRT_storm9a_09_03_NO3.p, STRT_storm9a_09_03_fDOM.p, STRT_storm9a_09_03_SPC.p, STRT_storm9a_09_03_turb.p,
          STRT_storm9b_09_06_NO3.p, STRT_storm9b_09_06_fDOM.p, STRT_storm9b_09_06_SPC.p, STRT_storm9b_09_06_turb.p,
          STRT_storm9c_09_09_NO3.p, STRT_storm9c_09_09_fDOM.p, STRT_storm9c_09_09_SPC.p, STRT_storm9c_09_09_turb.p,
          STRT_storm10_09_23_NO3.p, STRT_storm10_09_23_fDOM.p, STRT_storm10_09_23_SPC.p, STRT_storm10_09_23_turb.p,
          cols = 7)
# export pdf 20 x 30


# Make MOOS loops #
MOOS_storm1_06_21_NO3 <- filter(MOOS_storm1_06_21_NO3, datavalue >= 10)
# NO3
MOOS_storm1_06_20_NO3.p = hyst_plot(MOOS_storm1_06_20_Q, MOOS_storm1_06_20_NO3, "MOOS", "NO3", "0620")
MOOS_storm2_06_28_NO3.p = hyst_plot(MOOS_storm2_06_28_Q, MOOS_storm2_06_28_NO3, "MOOS", "NO3", "0628")
MOOS_storm3_07_18_NO3.p = hyst_plot(MOOS_storm3_07_18_Q, MOOS_storm3_07_18_NO3, "MOOS", "NO3", "0718")
MOOS_storm4_07_20_NO3.p = hyst_plot(MOOS_storm4_07_20_Q, MOOS_storm4_07_20_NO3, "MOOS", "NO3", "0720")
MOOS_storm5_07_26_NO3.p = hyst_plot(MOOS_storm5_07_26_Q, MOOS_storm5_07_26_NO3, "MOOS", "NO3", "0726")
MOOS_storm6a_08_01_NO3.p = hyst_plot(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_NO3, "MOOS", "NO3", "0801")
MOOS_storm6b_08_02_NO3.p = hyst_plot(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_NO3, "MOOS", "NO3", "0802")
MOOS_storm7a_08_09_NO3.p = hyst_plot(MOOS_storm7a_08_09_Q, MOOS_storm7a_08_09_NO3, "MOOS", "NO3", "0809")
MOOS_storm7b_08_12_NO3.p = hyst_plot(MOOS_storm7b_08_12_Q, MOOS_storm7b_08_12_NO3, "MOOS", "NO3", "0812")
MOOS_storm8_09_06_NO3.p = hyst_plot(MOOS_storm8_09_06_Q, MOOS_storm8_09_06_NO3, "MOOS", "NO3", "0906")
MOOS_storm9_09_09_NO3.p = hyst_plot(MOOS_storm9_09_09_Q, MOOS_storm9_09_09_NO3, "MOOS", "NO3", "0909")
# fDOM #
MOOS_storm1_06_20_fDOM.p = hyst_plot(MOOS_storm1_06_20_Q, MOOS_storm1_06_20_fDOM, "MOOS", "fDOM", "0620")
MOOS_storm2_06_28_fDOM.p = hyst_plot(MOOS_storm2_06_28_Q, MOOS_storm2_06_28_fDOM, "MOOS", "fDOM", "0628")
MOOS_storm3_07_18_fDOM.p = hyst_plot(MOOS_storm3_07_18_Q, MOOS_storm3_07_18_fDOM, "MOOS", "fDOM", "0718")
MOOS_storm4_07_20_fDOM.p = hyst_plot(MOOS_storm4_07_20_Q, MOOS_storm4_07_20_fDOM, "MOOS", "fDOM", "0720")
MOOS_storm5_07_26_fDOM.p = hyst_plot(MOOS_storm5_07_26_Q, MOOS_storm5_07_26_fDOM, "MOOS", "fDOM", "0726")
MOOS_storm6a_08_01_fDOM.p = hyst_plot(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_fDOM, "MOOS", "fDOM", "0801")
MOOS_storm6b_08_02_fDOM.p = hyst_plot(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_fDOM, "MOOS", "fDOM", "0802")
MOOS_storm7a_08_09_fDOM.p = hyst_plot(MOOS_storm7a_08_09_Q, MOOS_storm7a_08_09_fDOM, "MOOS", "fDOM", "0809")
MOOS_storm7b_08_12_fDOM.p = hyst_plot(MOOS_storm7b_08_12_Q, MOOS_storm7b_08_12_fDOM, "MOOS", "fDOM", "0812")
MOOS_storm8_09_06_fDOM.p = hyst_plot(MOOS_storm8_09_06_Q, MOOS_storm8_09_06_fDOM, "MOOS", "fDOM", "0906")
MOOS_storm9_09_09_fDOM.p = hyst_plot(MOOS_storm9_09_09_Q, MOOS_storm9_09_09_fDOM, "MOOS", "fDOM", "0909")
# SPC #
MOOS_storm1_06_20_SPC.p = hyst_plot(MOOS_storm1_06_20_Q, MOOS_storm1_06_20_SPC, "MOOS", "SPC", "0620")
MOOS_storm2_06_28_SPC.p = hyst_plot(MOOS_storm2_06_28_Q, MOOS_storm2_06_28_SPC, "MOOS", "SPC", "0628")
MOOS_storm3_07_18_SPC.p = hyst_plot(MOOS_storm3_07_18_Q, MOOS_storm3_07_18_SPC, "MOOS", "SPC", "0718")
MOOS_storm4_07_20_SPC.p = hyst_plot(MOOS_storm4_07_20_Q, MOOS_storm4_07_20_SPC, "MOOS", "SPC", "0720")
MOOS_storm5_07_26_SPC.p = hyst_plot(MOOS_storm5_07_26_Q, MOOS_storm5_07_26_SPC, "MOOS", "SPC", "0726")
MOOS_storm6a_08_01_SPC.p = hyst_plot(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_SPC, "MOOS", "SPC", "0801")
MOOS_storm6b_08_02_SPC.p = hyst_plot(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_SPC, "MOOS", "SPC", "0802")
MOOS_storm7a_08_09_SPC.p = hyst_plot(MOOS_storm7a_08_09_Q, MOOS_storm7a_08_09_SPC, "MOOS", "SPC", "0809")
MOOS_storm7b_08_12_SPC.p = hyst_plot(MOOS_storm7b_08_12_Q, MOOS_storm7b_08_12_SPC, "MOOS", "SPC", "0812")
MOOS_storm8_09_06_SPC.p = hyst_plot(MOOS_storm8_09_06_Q, MOOS_storm8_09_06_SPC, "MOOS", "SPC", "0906")
MOOS_storm9_09_09_SPC.p = hyst_plot(MOOS_storm9_09_09_Q, MOOS_storm9_09_09_SPC, "MOOS", "SPC", "0909")
# turb #
MOOS_storm1_06_20_turb.p = hyst_plot(MOOS_storm1_06_20_Q, MOOS_storm1_06_20_turb, "MOOS", "turb", "0620")
MOOS_storm2_06_28_turb.p = hyst_plot(MOOS_storm2_06_28_Q, MOOS_storm2_06_28_turb, "MOOS", "turb", "0628")
MOOS_storm3_07_18_turb.p = hyst_plot(MOOS_storm3_07_18_Q, MOOS_storm3_07_18_turb, "MOOS", "turb", "0718")
MOOS_storm4_07_20_turb.p = hyst_plot(MOOS_storm4_07_20_Q, MOOS_storm4_07_20_turb, "MOOS", "turb", "0720")
MOOS_storm5_07_26_turb.p = hyst_plot(MOOS_storm5_07_26_Q, MOOS_storm5_07_26_turb, "MOOS", "turb", "0726")
MOOS_storm6a_08_01_turb.p = hyst_plot(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_turb, "MOOS", "turb", "0801")
MOOS_storm6b_08_02_turb.p = hyst_plot(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_turb, "MOOS", "turb", "0802")
MOOS_storm7a_08_09_turb.p = hyst_plot(MOOS_storm7a_08_09_Q, MOOS_storm7a_08_09_turb, "MOOS", "turb", "0809")
MOOS_storm7b_08_12_turb.p = hyst_plot(MOOS_storm7b_08_12_Q, MOOS_storm7b_08_12_turb, "MOOS", "turb", "0812")
MOOS_storm8_09_06_turb.p = hyst_plot(MOOS_storm8_09_06_Q, MOOS_storm8_09_06_turb, "MOOS", "turb", "0906")
MOOS_storm9_09_09_turb.p = hyst_plot(MOOS_storm9_09_09_Q, MOOS_storm9_09_09_turb, "MOOS", "turb", "0909")


#### Multiplots of MOOS storms ####

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}
# Plot MOOS loops #
multiplot(MOOS_storm1_06_20_NO3.p, MOOS_storm1_06_20_fDOM.p) # need to clean values that are below 10 but if i do clear it then i get the error code so i gotta figure that out 
multiplot(MOOS_storm2_06_28_NO3.p, MOOS_storm2_06_28_fDOM.p) # works
multiplot(MOOS_storm3_07_18_NO3.p, MOOS_storm3_07_18_fDOM.p) # works
multiplot(MOOS_storm4_07_20_NO3.p, MOOS_storm4_07_20_fDOM.p) # works 
multiplot(MOOS_storm5_07_26_NO3.p, MOOS_storm5_07_26_fDOM.p) # works 
multiplot(MOOS_storm6a_08_01_NO3.p, MOOS_storm6a_08_01_fDOM.p) # works
multiplot(MOOS_storm6b_08_02_NO3.p, MOOS_storm6b_08_02_fDOM.p) # works but needs to be cleaned for values below 10
multiplot(MOOS_storm7a_08_09_NO3.p, MOOS_storm7a_08_09_fDOM.p) # works 
multiplot(MOOS_storm7b_08_12_NO3.p, MOOS_storm7b_08_12_fDOM.p) # works 
multiplot(MOOS_storm8_09_06_NO3.p, MOOS_storm8_09_06_fDOM.p) # works
multiplot(MOOS_storm9_09_09_NO3.p, MOOS_storm9_09_09_fDOM.p) # works better for fDOM

multiplot(MOOS_storm1_06_20_SPC.p, MOOS_storm1_06_20_turb.p) # need to clean values that are below 10 but if i do clear it then i get the error code so i gotta figure that out 
multiplot(MOOS_storm2_06_28_SPC.p, MOOS_storm2_06_28_turb.p) # works
multiplot(MOOS_storm3_07_18_SPC.p, MOOS_storm3_07_18_turb.p) # works
multiplot(MOOS_storm4_07_20_SPC.p, MOOS_storm4_07_20_turb.p) # works 
multiplot(MOOS_storm5_07_26_SPC.p, MOOS_storm5_07_26_turb.p) # works 
multiplot(MOOS_storm6a_08_01_SPC.p, MOOS_storm6a_08_01_turb.p) # works
multiplot(MOOS_storm6b_08_02_SPC.p, MOOS_storm6b_08_02_turb.p) # works but needs to be cleaned for values below 10
multiplot(MOOS_storm7a_08_09_SPC.p, MOOS_storm7a_08_09_turb.p) # works 
multiplot(MOOS_storm7b_08_12_SPC.p, MOOS_storm7b_08_12_turb.p) # works 
multiplot(MOOS_storm8_09_06_SPC.p, MOOS_storm8_09_06_turb.p) # works
multiplot(MOOS_storm9_09_09_SPC.p, MOOS_storm9_09_09_turb.p) # works


multiplot(MOOS_storm1_06_20_NO3.p, MOOS_storm1_06_20_fDOM.p, MOOS_storm1_06_20_SPC.p, MOOS_storm1_06_20_turb.p,
          MOOS_storm2_06_28_NO3.p, MOOS_storm2_06_28_fDOM.p, MOOS_storm2_06_28_SPC.p, MOOS_storm2_06_28_turb.p,
          MOOS_storm3_07_18_NO3.p, MOOS_storm3_07_18_fDOM.p, MOOS_storm3_07_18_SPC.p, MOOS_storm3_07_18_turb.p,
          MOOS_storm4_07_20_NO3.p, MOOS_storm4_07_20_fDOM.p, MOOS_storm4_07_20_SPC.p, MOOS_storm4_07_20_turb.p,
          MOOS_storm5_07_26_NO3.p, MOOS_storm5_07_26_fDOM.p, MOOS_storm5_07_26_SPC.p, MOOS_storm5_07_26_turb.p,
          MOOS_storm6a_08_01_NO3.p, MOOS_storm6a_08_01_fDOM.p, MOOS_storm6a_08_01_SPC.p, MOOS_storm6a_08_01_turb.p,
          MOOS_storm6b_08_02_NO3.p, MOOS_storm6b_08_02_fDOM.p,MOOS_storm6b_08_02_SPC.p, MOOS_storm6b_08_02_turb.p,
          MOOS_storm7a_08_09_NO3.p, MOOS_storm7a_08_09_fDOM.p, MOOS_storm7a_08_09_SPC.p, MOOS_storm7a_08_09_turb.p,
          MOOS_storm7b_08_12_NO3.p, MOOS_storm7b_08_12_fDOM.p, MOOS_storm7b_08_12_SPC.p, MOOS_storm7b_08_12_turb.p,
          MOOS_storm8_09_06_NO3.p, MOOS_storm8_09_06_fDOM.p, MOOS_storm8_09_06_SPC.p, MOOS_storm8_09_06_turb.p,
          MOOS_storm9_09_09_NO3.p, MOOS_storm9_09_09_fDOM.p, MOOS_storm9_09_09_SPC.p, MOOS_storm9_09_09_turb.p,
          cols = 7) # works

# export pdf 20 x 30

#### Make FRCH loops ####

FRCH_storm1_06_13_NO3.p = hyst_plot(FRCH_storm1_06_13_Q, FRCH_storm1_06_13_NO3, "FRCH", "NO3", "0613")
FRCH_storm2_06_18_NO3.p = hyst_plot(FRCH_storm2_06_18_Q, FRCH_storm2_06_18_NO3, "FRCH", "NO3", "0618")
FRCH_storm3a_06_20_NO3.p = hyst_plot(FRCH_storm3a_06_20_Q, FRCH_storm3a_06_20_NO3, "FRCH", "NO3", "0620a")
FRCH_storm3b_06_21_NO3.p = hyst_plot(FRCH_storm3b_06_21_Q, FRCH_storm3b_06_21_NO3, "FRCH", "NO3", "0621b")
FRCH_storm3c_06_26_NO3.p = hyst_plot(FRCH_storm3c_06_26_Q, FRCH_storm3c_06_26_NO3, "FRCH", "NO3", "0626c")
FRCH_storm4a_07_07_NO3.p = hyst_plot(FRCH_storm4a_07_07_Q, FRCH_storm4a_07_07_NO3, "FRCH", "NO3", "0707a")
FRCH_storm4b_07_09_NO3.p = hyst_plot(FRCH_storm4b_07_09_Q, FRCH_storm4b_07_09_NO3, "FRCH", "NO3", "0709b")
FRCH_storm5_07_15_NO3.p = hyst_plot(FRCH_storm5_07_15_Q, FRCH_storm5_07_15_NO3, "FRCH", "NO3", "0715")
FRCH_storm6_07_18_NO3.p = hyst_plot(FRCH_storm6_07_18_Q, FRCH_storm6_07_18_NO3, "FRCH", "NO3", "0718")
FRCH_storm7_07_20_NO3.p = hyst_plot(FRCH_storm7_07_20_Q, FRCH_storm7_07_20_NO3, "FRCH", "NO3", "0720")
FRCH_storm8_07_26_NO3.p = hyst_plot(FRCH_storm8_07_26_Q, FRCH_storm8_07_26_NO3, "FRCH", "NO3", "0726")
FRCH_storm9a_08_01_NO3.p = hyst_plot(FRCH_storm9a_08_01_Q, FRCH_storm9a_08_01_NO3, "FRCH", "NO3", "0801a")
FRCH_storm9b_08_02_NO3.p = hyst_plot(FRCH_storm9b_08_02_Q, FRCH_storm9b_08_023_NO3, "FRCH", "NO3", "0802b")
FRCH_storm10a_08_09_NO3.p = hyst_plot(FRCH_storm10a_08_09_Q, FRCH_storm10a_08_09_NO3, "FRCH", "NO3", "0809a")
FRCH_storm10b_08_12_NO3.p = hyst_plot(FRCH_storm10b_08_12_Q, FRCH_storm10b_08_12_NO3, "FRCH", "NO3", "0812b")
FRCH_storm11_08_20_NO3.p = hyst_plot(FRCH_storm11_08_20_Q, FRCH_storm11_08_20_NO3, "FRCH", "NO3", "0820")
FRCH_storm12_09_06_NO3.p = hyst_plot(FRCH_storm12_09_06_Q, FRCH_storm12_09_06_NO3, "FRCH", "NO3", "0906")


FRCH_storm1_06_13_fDOM.p = hyst_plot(FRCH_storm1_06_13_Q, FRCH_storm1_06_13_fDOM, "FRCH", "fDOM", "0613")
FRCH_storm2_06_18_fDOM.p = hyst_plot(FRCH_storm2_06_18_Q, FRCH_storm2_06_18_fDOM, "FRCH", "fDOM", "0618")
FRCH_storm3a_06_20_fDOM.p = hyst_plot(FRCH_storm3a_06_20_Q, FRCH_storm3a_06_20_fDOM, "FRCH", "fDOM", "0620a")
FRCH_storm3b_06_21_fDOM.p = hyst_plot(FRCH_storm3b_06_21_Q, FRCH_storm3b_06_21_fDOM, "FRCH", "fDOM", "0621b")
FRCH_storm3c_06_26_fDOM.p = hyst_plot(FRCH_storm3c_06_26_Q, FRCH_storm3c_06_26_fDOM, "FRCH", "fDOM", "0626c")
FRCH_storm4a_07_07_fDOM.p = hyst_plot(FRCH_storm4a_07_07_Q, FRCH_storm4a_07_07_fDOM, "FRCH", "fDOM", "0707a")
FRCH_storm4b_07_09_fDOM.p = hyst_plot(FRCH_storm4b_07_09_Q, FRCH_storm4b_07_09_fDOM, "FRCH", "fDOM", "0709b")
FRCH_storm5_07_15_fDOM.p = hyst_plot(FRCH_storm5_07_15_Q, FRCH_storm5_07_15_fDOM, "FRCH", "fDOM", "0715")
FRCH_storm6_07_18_fDOM.p = hyst_plot(FRCH_storm6_07_18_Q, FRCH_storm6_07_18_fDOM, "FRCH", "fDOM", "0718")
FRCH_storm7_07_20_fDOM.p = hyst_plot(FRCH_storm7_07_20_Q, FRCH_storm7_07_20_fDOM, "FRCH", "fDOM", "0720")
FRCH_storm8_07_26_fDOM.p = hyst_plot(FRCH_storm8_07_26_Q, FRCH_storm8_07_26_fDOM, "FRCH", "fDOM", "0726")
FRCH_storm9a_08_01_fDOM.p = hyst_plot(FRCH_storm9a_08_01_Q, FRCH_storm9a_08_01_fDOM, "FRCH", "fDOM", "0801a")
FRCH_storm9b_08_02_fDOM.p = hyst_plot(FRCH_storm9b_08_02_Q, FRCH_storm9b_08_02_fDOM, "FRCH", "fDOM", "0802b")
FRCH_storm10a_08_09_fDOM.p = hyst_plot(FRCH_storm10a_08_09_Q, FRCH_storm10a_08_09_fDOM, "FRCH", "fDOM", "0809a")
FRCH_storm10b_08_12_fDOM.p = hyst_plot(FRCH_storm10b_08_12_Q, FRCH_storm10b_08_12_fDOM, "FRCH", "fDOM", "0812b")
FRCH_storm11_08_20_fDOM.p = hyst_plot(FRCH_storm11_08_20_Q, FRCH_storm11_08_20_fDOM, "FRCH", "fDOM", "0820")
FRCH_storm12_09_06_fDOM.p = hyst_plot(FRCH_storm12_09_06_Q, FRCH_storm11_09_06_fDOM, "FRCH", "fDOM", "0906")

FRCH_storm1_06_13_SPC.p = hyst_plot(FRCH_storm1_06_13_Q, FRCH_storm1_06_13_SPC, "FRCH", "SPC", "0613")
FRCH_storm2_06_18_SPC.p = hyst_plot(FRCH_storm2_06_18_Q, FRCH_storm2_06_18_SPC, "FRCH", "SPC", "0618")
FRCH_storm3a_06_20_SPC.p = hyst_plot(FRCH_storm3a_06_20_Q, FRCH_storm3a_06_20_SPC, "FRCH", "SPC", "0620a")
FRCH_storm3b_06_21_SPC.p = hyst_plot(FRCH_storm3b_06_21_Q, FRCH_storm3b_06_21_SPC, "FRCH", "SPC", "0621b")
FRCH_storm3c_06_26_SPC.p = hyst_plot(FRCH_storm3c_06_26_Q, FRCH_storm3c_06_26_SPC, "FRCH", "SPC", "0626c")
FRCH_storm4a_07_07_SPC.p = hyst_plot(FRCH_storm4a_07_07_Q, FRCH_storm4a_07_07_SPC, "FRCH", "SPC", "0707a")
FRCH_storm4b_07_09_SPC.p = hyst_plot(FRCH_storm4b_07_09_Q, FRCH_storm4b_07_09_SPC, "FRCH", "SPC", "0709b")
FRCH_storm5_07_15_SPC.p = hyst_plot(FRCH_storm5_07_15_Q, FRCH_storm5_07_15_SPC, "FRCH", "SPC", "0715")
FRCH_storm6_07_18_SPC.p = hyst_plot(FRCH_storm6_07_18_Q, FRCH_storm6_07_18_SPC, "FRCH", "SPC", "0718")
FRCH_storm7_07_20_SPC.p = hyst_plot(FRCH_storm7_07_20_Q, FRCH_storm7_07_20_SPC, "FRCH", "SPC", "0720")
FRCH_storm8_07_26_SPC.p = hyst_plot(FRCH_storm8_07_26_Q, FRCH_storm8_07_26_SPC, "FRCH", "SPC", "0726")
FRCH_storm9a_08_01_SPC.p = hyst_plot(FRCH_storm9a_08_01_Q, FRCH_storm9a_08_01_SPC, "FRCH", "SPC", "0801a")
FRCH_storm9b_08_02_SPC.p = hyst_plot(FRCH_storm9b_08_02_Q, FRCH_storm9b_08_023_SPC, "FRCH", "SPC", "0802b")
FRCH_storm10a_08_09_SPC.p = hyst_plot(FRCH_storm10a_08_09_Q, FRCH_storm10a_08_09_SPC, "FRCH", "SPC", "0809a")
FRCH_storm10b_08_12_SPC.p = hyst_plot(FRCH_storm10b_08_12_Q, FRCH_storm10b_08_12_SPC, "FRCH", "SPC", "0812b")
FRCH_storm11_08_20_SPC.p = hyst_plot(FRCH_storm11_08_20_Q, FRCH_storm11_08_20_SPC, "FRCH", "SPC", "0820")
FRCH_storm12_09_06_SPC.p = hyst_plot(FRCH_storm12_09_06_Q, FRCH_storm12_09_06_SPC, "FRCH", "SPC", "0906")

FRCH_storm1_06_13_turb.p = hyst_plot(FRCH_storm1_06_13_Q, FRCH_storm1_06_13_turb, "FRCH", "turb", "0613")
FRCH_storm2_06_18_turb.p = hyst_plot(FRCH_storm2_06_18_Q, FRCH_storm2_06_18_turb, "FRCH", "turb", "0618")
FRCH_storm3a_06_20_turb.p = hyst_plot(FRCH_storm3a_06_20_Q, FRCH_storm3a_06_20_turb, "FRCH", "turb", "0620a")
FRCH_storm3b_06_21_turb.p = hyst_plot(FRCH_storm3b_06_21_Q, FRCH_storm3b_06_21_turb, "FRCH", "turb", "0621b")
FRCH_storm3c_06_26_turb.p = hyst_plot(FRCH_storm3c_06_26_Q, FRCH_storm3c_06_26_turb, "FRCH", "turb", "0626c")
FRCH_storm4a_07_07_turb.p = hyst_plot(FRCH_storm4a_07_07_Q, FRCH_storm4a_07_07_turb, "FRCH", "turb", "0707a")
FRCH_storm4b_07_09_turb.p = hyst_plot(FRCH_storm4b_07_09_Q, FRCH_storm4b_07_09_turb, "FRCH", "turb", "0709b")
FRCH_storm5_07_15_turb.p = hyst_plot(FRCH_storm5_07_15_Q, FRCH_storm5_07_15_turb, "FRCH", "turb", "0715")
FRCH_storm6_07_18_turb.p = hyst_plot(FRCH_storm6_07_18_Q, FRCH_storm6_07_18_turb, "FRCH", "turb", "0718")
FRCH_storm7_07_20_turb.p = hyst_plot(FRCH_storm7_07_20_Q, FRCH_storm7_07_20_turb, "FRCH", "turb", "0720")
FRCH_storm8_07_26_turb.p = hyst_plot(FRCH_storm8_07_26_Q, FRCH_storm8_07_26_turb, "FRCH", "turb", "0726")
FRCH_storm9a_08_01_turb.p = hyst_plot(FRCH_storm9a_08_01_Q, FRCH_storm9a_08_01_turb, "FRCH", "turb", "0801a")
FRCH_storm9b_08_02_turb.p = hyst_plot(FRCH_storm9b_08_02_Q, FRCH_storm9b_08_023_turb, "FRCH", "turb", "0802b")
FRCH_storm10a_08_09_turb.p = hyst_plot(FRCH_storm10a_08_09_Q, FRCH_storm10a_08_09_turb, "FRCH", "turb", "0809a")
FRCH_storm10b_08_12_turb.p = hyst_plot(FRCH_storm10b_08_12_Q, FRCH_storm10b_08_12_turb, "FRCH", "turb", "0812b")
FRCH_storm11_08_20_turb.p = hyst_plot(FRCH_storm11_08_20_Q, FRCH_storm11_08_20_turb, "FRCH", "turb", "0820")
FRCH_storm12_09_06_turb.p = hyst_plot(FRCH_storm12_09_06_Q, FRCH_storm12_09_06_turb, "FRCH", "turb", "0906")


multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}
# Plot FRCH Loops #

multiplot(FRCH_storm1_06_13_NO3.p, FRCH_storm1_06_13_fDOM.p) # clean "0" points
multiplot(FRCH_storm2_06_18_NO3.p, FRCH_storm2_06_18_fDOM.p) # works
multiplot(FRCH_storm3a_06_20_NO3.p, FRCH_storm3a_06_20_fDOM.p) # works
multiplot(FRCH_storm3b_06_22_NO3.p, FRCH_storm3b_06_22_fDOM.p) # works 
multiplot(FRCH_storm3c_06_28_NO3.p, FRCH_storm3c_06_28_fDOM.p) # works 
multiplot(FRCH_storm4a_07_07_NO3.p, FRCH_storm4a_07_07_fDOM.p) # works
multiplot(FRCH_storm4b_07_09_NO3.p, FRCH_storm4b_07_09_fDOM.p) # works 
multiplot(FRCH_storm5_07_16_NO3.p, FRCH_storm5_07_16_fDOM.p) # works 
multiplot(FRCH_storm6_07_17_NO3.p, FRCH_storm6_07_17_fDOM.p) # works 
multiplot(FRCH_storm7_07_20_NO3.p, FRCH_storm7_07_20_fDOM.p) # works
multiplot(FRCH_storm8_07_26_NO3.p, FRCH_storm8_07_26_fDOM.p) # works 
multiplot(FRCH_storm9a_08_01_NO3.p, FRCH_storm9a_08_01_fDOM.p) # works 
multiplot(FRCH_storm9b_08_02_NO3.p, FRCH_storm9b_08_02_fDOM.p) # Does not work
multiplot(FRCH_storm10a_08_09_NO3.p, FRCH_storm10a_08_09_fDOM.p) # works 
multiplot(FRCH_storm10b_08_12_NO3.p, FRCH_storm10b_08_12_fDOM.p) # works 
multiplot(FRCH_storm11_08_20_NO3.p, FRCH_storm11_08_20_fDOM.p) # works 
multiplot(FRCH_storm12_09_06_NO3.p, FRCH_storm12_09_06_fDOM.p) # No3 works 

multiplot(FRCH_storm1_06_13_SPC.p, FRCH_storm1_06_13_turb.p) # clean "0" points
multiplot(FRCH_storm2_06_18_SPC.p, FRCH_storm2_06_18_turb.p) # works
multiplot(FRCH_storm3a_06_20_SPC.p, FRCH_storm3a_06_20_turb.p) # works
multiplot(FRCH_storm3b_06_21_SPC.p, FRCH_storm3b_06_21_turb.p) # works 
multiplot(FRCH_storm3c_06_26_SPC.p, FRCH_storm3c_06_26_turb.p) # works 
multiplot(FRCH_storm4a_07_07_SPC.p, FRCH_storm4a_07_07_turb.p) # works
multiplot(FRCH_storm4b_07_09_SPC.p, FRCH_storm4b_07_09_turb.p) # works 
multiplot(FRCH_storm5_07_15_SPC.p, FRCH_storm5_07_15_turb.p) # works 
multiplot(FRCH_storm6_07_18_SPC.p, FRCH_storm6_07_18_turb.p) # works 
multiplot(FRCH_storm7_07_20_SPC.p, FRCH_storm7_07_20_turb.p) # works
multiplot(FRCH_storm8_07_26_SPC.p, FRCH_storm8_07_26_turb.p) # works 
multiplot(FRCH_storm9a_08_01_SPC.p, FRCH_storm9a_08_01_turb.p) # works 
#multiplot(FRCH_storm9b_08_02_SPC.p, FRCH_storm9b_08_02_turb.p) # Does not work
multiplot(FRCH_storm10a_08_09_SPC.p, FRCH_storm10a_08_09_turb.p) # works 
multiplot(FRCH_storm10b_08_12_SPC.p, FRCH_storm10b_08_12_turb.p) # works 
multiplot(FRCH_storm11_08_20_SPC.p, FRCH_storm11_08_20_turb.p) # works 
multiplot(FRCH_storm12_09_06_SPC.p, FRCH_storm12_09_06_turb.p) # works


multiplot(FRCH_storm1_06_13_NO3.p, FRCH_storm1_06_13_fDOM.p, FRCH_storm1_06_13_SPC.p, FRCH_storm1_06_13_turb.p,
          FRCH_storm2_06_18_NO3.p, FRCH_storm2_06_18_fDOM.p, FRCH_storm2_06_18_SPC.p, FRCH_storm2_06_18_turb.p,
          FRCH_storm3a_06_20_NO3.p, FRCH_storm3a_06_20_fDOM.p, FRCH_storm3a_06_20_SPC.p, FRCH_storm3a_06_20_turb.p,
          FRCH_storm3b_06_21_NO3.p, FRCH_storm3b_06_21_fDOM.p, FRCH_storm3b_06_21_SPC.p, FRCH_storm3b_06_21_turb.p,
          FRCH_storm3c_06_26_NO3.p, FRCH_storm3c_06_26_fDOM.p, FRCH_storm3c_06_26_SPC.p, FRCH_storm3c_06_26_turb.p,
          FRCH_storm4a_07_07_NO3.p, FRCH_storm4a_07_07_fDOM.p, FRCH_storm4a_07_07_SPC.p, FRCH_storm4a_07_07_turb.p,
          FRCH_storm4b_07_09_NO3.p, FRCH_storm4b_07_09_fDOM.p, FRCH_storm4b_07_09_SPC.p, FRCH_storm4b_07_09_turb.p,
          FRCH_storm5_07_15_NO3.p, FRCH_storm5_07_15_fDOM.p, FRCH_storm5_07_15_SPC.p, FRCH_storm5_07_15_turb.p,
          FRCH_storm6_07_18_NO3.p, FRCH_storm6_07_18_fDOM.p,FRCH_storm6_07_18_SPC.p, FRCH_storm6_07_18_turb.p,
          FRCH_storm7_07_20_NO3.p, FRCH_storm7_07_20_fDOM.p, FRCH_storm7_07_20_SPC.p, FRCH_storm7_07_20_turb.p,
          FRCH_storm8_07_26_NO3.p, FRCH_storm8_07_26_fDOM.p, FRCH_storm8_07_26_SPC.p, FRCH_storm8_07_26_turb.p,
          FRCH_storm9a_08_01_NO3.p, FRCH_storm9a_08_01_fDOM.p, FRCH_storm9a_08_01_SPC.p, FRCH_storm9a_08_01_turb.p,
          FRCH_storm10a_08_09_NO3.p, FRCH_storm10a_08_09_fDOM.p,FRCH_storm10a_08_09_SPC.p, FRCH_storm10a_08_09_turb.p,
          FRCH_storm10b_08_12_NO3.p, FRCH_storm10b_08_12_fDOM.p, FRCH_storm10b_08_12_SPC.p, FRCH_storm10b_08_12_turb.p,
          FRCH_storm11_08_20_NO3.p, FRCH_storm11_08_20_fDOM.p, FRCH_storm11_08_20_SPC.p, FRCH_storm11_08_20_turb.p,
          FRCH_storm12_09_06_NO3.p, FRCH_storm12_09_06_SPC.p, FRCH_storm12_09_06_turb.p,
          cols = 7) # works
# export pdf 20 x 30

#### Make POKE loops ####

POKE_storm1_06_09_NO3.p = hyst_plot(POKE_storm1_06_09_Q, POKE_storm1_06_09_NO3, "POKE", "NO3", "0609")
POKE_storm2_06_12_NO3.p = hyst_plot(POKE_storm2_06_12_Q, POKE_storm2_06_12_NO3, "POKE", "NO3", "0612")
POKE_storm3_06_15_NO3.p = hyst_plot(POKE_storm3_06_15_Q, POKE_storm3_06_15_NO3, "POKE", "NO3", "0615")
POKE_storm4a_06_19_NO3.p = hyst_plot(POKE_storm4a_06_19_Q, POKE_storm4a_06_19_NO3, "POKE", "NO3", "0619a")
POKE_storm4b_06_20_NO3.p = hyst_plot(POKE_storm4b_06_20_Q, POKE_storm4b_06_20_NO3, "POKE", "NO3", "0620b")
POKE_storm4c_06_21_NO3.p = hyst_plot(POKE_storm4c_06_21_Q, POKE_storm4c_06_21_NO3, "POKE", "NO3", "0621c")
POKE_storm5_06_22_NO3.p = hyst_plot(POKE_storm5_06_22_Q, POKE_storm5_06_22_NO3, "POKE", "NO3", "0622")
POKE_storm6_06_29_NO3.p = hyst_plot(POKE_storm6_06_29_Q, POKE_storm6_06_29_NO3, "POKE", "NO3", "0629")
POKE_storm7_07_04_NO3.p = hyst_plot(POKE_storm7_07_04_Q, POKE_storm7_07_04_NO3, "POKE", "NO3", "0704")
POKE_storm8_07_09_NO3.p = hyst_plot(POKE_storm8_07_09_Q, POKE_storm8_07_09_NO3, "POKE", "NO3", "0709")
POKE_storm9_07_12_NO3.p = hyst_plot(POKE_storm9_07_12_Q, POKE_storm9_07_12_NO3, "POKE", "NO3", "0712")
POKE_storm10_07_16_NO3.p = hyst_plot(POKE_storm10_07_16_Q, POKE_storm10_07_16_NO3, "POKE", "NO3", "0716")
POKE_storm11_07_18_NO3.p = hyst_plot(POKE_storm11_07_18_Q, POKE_storm11_07_18_NO3, "POKE", "NO3", "0718")
POKE_storm12_07_20_NO3.p = hyst_plot(POKE_storm12_07_20_Q, POKE_storm12_07_20_NO3, "POKE", "NO3", "0720")
POKE_storm13_07_24_NO3.p = hyst_plot(POKE_storm13_07_24_Q, POKE_storm13_07_24_NO3, "POKE", "NO3", "0724")
POKE_storm14_07_26_NO3.p = hyst_plot(POKE_storm14_07_26_Q, POKE_storm14_07_26_NO3, "POKE", "NO3", "0726")
POKE_storm15_08_02_NO3.p = hyst_plot(POKE_storm15_08_02_Q, POKE_storm15_08_02_NO3, "POKE", "NO3", "0802")
POKE_storm16_08_12_NO3.p = hyst_plot(POKE_storm16_08_12_Q, POKE_storm16_08_12_NO3, "POKE", "NO3", "0812")
POKE_storm17_08_24_NO3.p = hyst_plot(POKE_storm17_08_24_Q, POKE_storm17_08_24_NO3, "POKE", "NO3", "0824")
POKE_storm18_08_25_NO3.p = hyst_plot(POKE_storm18_08_25_Q, POKE_storm18_08_25_NO3, "POKE", "NO3", "0825")
POKE_storm19_08_27_NO3.p = hyst_plot(POKE_storm19_08_27_Q, POKE_storm19_08_27_NO3, "POKE", "NO3", "0827")
POKE_storm20_09_01_NO3.p = hyst_plot(POKE_storm20_09_01_Q, POKE_storm20_09_01_NO3, "POKE", "NO3", "0901")
POKE_storm21_09_03_NO3.p = hyst_plot(POKE_storm21_09_03_Q, POKE_storm21_09_03_NO3, "POKE", "NO3", "0903")
POKE_storm22a_09_07_NO3.p = hyst_plot(POKE_storm22a_09_07_Q, POKE_storm22a_09_07_NO3, "POKE", "NO3", "0907a")
POKE_storm22b_09_09_NO3.p = hyst_plot(POKE_storm22b_09_09_Q, POKE_storm22b_09_09_NO3, "POKE", "NO3", "0909b")




POKE_storm1_06_09_fDOM.p = hyst_plot(POKE_storm1_06_09_Q, POKE_storm1_06_09_fDOM, "POKE", "fDOM", "0609")
POKE_storm2_06_12_fDOM.p = hyst_plot(POKE_storm2_06_12_Q, POKE_storm2_06_12_fDOM, "POKE", "fDOM", "0612")
POKE_storm3_06_15_fDOM.p = hyst_plot(POKE_storm3_06_15_Q, POKE_storm3_06_15_fDOM, "POKE", "fDOM", "0615")
POKE_storm4a_06_19_fDOM.p = hyst_plot(POKE_storm4a_06_19_Q, POKE_storm4a_06_19_fDOM, "POKE", "fDOM", "0619a")
POKE_storm4b_06_20_fDOM.p = hyst_plot(POKE_storm4b_06_20_Q, POKE_storm4b_06_20_fDOM, "POKE", "fDOM", "0620b")
POKE_storm4c_06_21_fDOM.p = hyst_plot(POKE_storm4c_06_21_Q, POKE_storm4c_06_219_fDOM, "POKE", "fDOM", "0621c")
POKE_storm5_06_22_fDOM.p = hyst_plot(POKE_storm5_06_22_Q, POKE_storm5_06_22_fDOM, "POKE", "fDOM", "0622")
POKE_storm6_06_29_fDOM.p = hyst_plot(POKE_storm6_06_29_Q, POKE_storm6_06_29_fDOM, "POKE", "fDOM", "0629")
POKE_storm7_07_04_fDOM.p = hyst_plot(POKE_storm7_07_04_Q, POKE_storm7_07_04_fDOM, "POKE", "fDOM", "0704")
POKE_storm8_07_09_fDOM.p = hyst_plot(POKE_storm8_07_09_Q, POKE_storm8_07_09_fDOM, "POKE", "fDOM", "0709")
POKE_storm9_07_12_fDOM.p = hyst_plot(POKE_storm9_07_12_Q, POKE_storm9_07_12_fDOM, "POKE", "fDOM", "0712")
POKE_storm10_07_16_fDOM.p = hyst_plot(POKE_storm10_07_16_Q, POKE_storm10_07_16_fDOM, "POKE", "fDOM", "0716")
POKE_storm11_07_18_fDOM.p = hyst_plot(POKE_storm11_07_18_Q, POKE_storm11_07_18_fDOM, "POKE", "fDOM", "0718")
POKE_storm12_07_20_fDOM.p = hyst_plot(POKE_storm12_07_20_Q, POKE_storm12_07_20_fDOM, "POKE", "fDOM", "0720")
POKE_storm13_07_24_fDOM.p = hyst_plot(POKE_storm13_07_24_Q, POKE_storm13_07_24_fDOM, "POKE", "fDOM", "0724")
POKE_storm14_07_26_fDOM.p = hyst_plot(POKE_storm14_07_26_Q, POKE_storm14_07_26_fDOM, "POKE", "fDOM", "0726")
POKE_storm15_08_02_fDOM.p = hyst_plot(POKE_storm15_08_02_Q, POKE_storm15_08_02_fDOM, "POKE", "fDOM", "0802")
POKE_storm16_08_12_fDOM.p = hyst_plot(POKE_storm16_08_12_Q, POKE_storm16_08_12_fDOM, "POKE", "fDOM", "0812")
POKE_storm17_08_24_fDOM.p = hyst_plot(POKE_storm17_08_24_Q, POKE_storm17_08_24_fDOM, "POKE", "fDOM", "0824")
POKE_storm18_08_25_fDOM.p = hyst_plot(POKE_storm18_08_25_Q, POKE_storm18_08_25_fDOM, "POKE", "fDOM", "0825")
POKE_storm19_08_27_fDOM.p = hyst_plot(POKE_storm19_08_27_Q, POKE_storm19_08_27_fDOM, "POKE", "fDOM", "0827")
POKE_storm20_09_01_fDOM.p = hyst_plot(POKE_storm20_09_01_Q, POKE_storm20_09_01_fDOM, "POKE", "fDOM", "0901")
POKE_storm21_09_03_fDOM.p = hyst_plot(POKE_storm21_09_03_Q, POKE_storm21_09_03_fDOM, "POKE", "fDOM", "0903")
POKE_storm22a_09_07_fDOM.p = hyst_plot(POKE_storm22a_09_07_Q, POKE_storm22a_09_07_fDOM, "POKE", "fDOM", "0907a")
POKE_storm22b_09_09_fDOM.p = hyst_plot(POKE_storm22b_09_09_Q, POKE_storm22b_09_09_fDOM, "POKE", "fDOM", "0909b")

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}
# Plot POKE Loops #

multiplot(POKE_storm1_06_09_NO3.p, POKE_storm1_06_09_fDOM.p) # works
multiplot(POKE_storm2_06_12_NO3.p, POKE_storm2_06_12_fDOM.p) # works
multiplot(POKE_storm3_06_15_NO3.p, POKE_storm3_06_15_fDOM.p) # clean nitrate/ works
multiplot(POKE_storm4a_06_19_NO3.p, POKE_storm4a_06_19_fDOM.p) # works
multiplot(POKE_storm4b_06_20_NO3.p, POKE_storm4b_06_20_fDOM.p) # works
multiplot(POKE_storm4c_06_21_NO3.p, POKE_storm4c_06_21_fDOM.p) # does not work
multiplot(POKE_storm5_06_22_NO3.p, POKE_storm5_06_22_fDOM.p) # works
multiplot(POKE_storm6_06_29_NO3.p, POKE_storm6_06_29_fDOM.p) # works
multiplot(POKE_storm7_07_04_NO3.p, POKE_storm7_07_04_fDOM.p) # works
multiplot(POKE_storm8_07_09_NO3.p, POKE_storm8_07_09_fDOM.p) # works
multiplot(POKE_storm9_07_12_NO3.p, POKE_storm9_07_12_fDOM.p)# works
multiplot(POKE_storm10_07_16_NO3.p, POKE_storm10_07_16_fDOM.p) # works
multiplot(POKE_storm11_07_18_NO3.p, POKE_storm11_07_18_fDOM.p) # clean nitrate/works
multiplot(POKE_storm12_07_20_NO3.p, POKE_storm12_07_20_fDOM.p) # works
multiplot(POKE_storm13_07_24_NO3.p, POKE_storm13_07_24_fDOM.p)# works
multiplot(POKE_storm14_07_26_NO3.p, POKE_storm14_07_26_fDOM.p)# clean nitrate/works
multiplot(POKE_storm15_08_02_NO3.p, POKE_storm15_08_02_fDOM.p)# works
multiplot(POKE_storm16_08_12_NO3.p, POKE_storm16_08_12_fDOM.p)# works
multiplot(POKE_storm17_08_24_NO3.p, POKE_storm17_08_24_fDOM.p)# works
multiplot(POKE_storm18_08_25_NO3.p, POKE_storm18_08_25_fDOM.p)# works
multiplot(POKE_storm19_08_27_NO3.p, POKE_storm19_08_27_fDOM.p)# works
multiplot(POKE_storm20_09_01_NO3.p, POKE_storm20_09_01_fDOM.p)# works
multiplot(POKE_storm21_09_03_NO3.p, POKE_storm21_09_03_fDOM.p)# works
multiplot(POKE_storm22a_09_07_NO3.p, POKE_storm22a_09_07_fDOM.p)# works
multiplot(POKE_storm22b_09_09_NO3.p, POKE_storm22b_09_09_fDOM.p)# works





multiplot(POKE_storm1_06_09_NO3.p, POKE_storm1_06_09_fDOM.p,
          POKE_storm2_06_12_NO3.p, POKE_storm2_06_12_fDOM.p,
          POKE_storm3_06_15_NO3.p, POKE_storm3_06_15_fDOM.p,
          POKE_storm4a_06_19_NO3.p, POKE_storm4a_06_19_fDOM.p,
          POKE_storm4b_06_20_NO3.p, POKE_storm4b_06_20_fDOM.p,
          POKE_storm5_06_22_NO3.p, POKE_storm5_06_22_fDOM.p,
          POKE_storm6_06_29_NO3.p, POKE_storm6_06_29_fDOM.p,
          POKE_storm7_07_04_NO3.p, POKE_storm7_07_04_fDOM.p,
          POKE_storm8_07_09_NO3.p, POKE_storm8_07_09_fDOM.p,
          POKE_storm9_07_12_NO3.p, POKE_storm9_07_12_fDOM.p,
          POKE_storm10_07_16_NO3.p, POKE_storm10_07_16_fDOM.p,
          POKE_storm11_07_18_NO3.p, POKE_storm11_07_18_fDOM.p,
          POKE_storm12_07_20_NO3.p, POKE_storm12_07_20_fDOM.p,
          POKE_storm13_07_24_NO3.p, POKE_storm13_07_24_fDOM.p,
          POKE_storm14_07_26_NO3.p, POKE_storm14_07_26_fDOM.p,
          POKE_storm15_08_02_NO3.p, POKE_storm15_08_02_fDOM.p,
          POKE_storm16_08_12_NO3.p, POKE_storm16_08_12_fDOM.p,
          POKE_storm17_08_24_NO3.p, POKE_storm17_08_24_fDOM.p,
          POKE_storm18_08_25_NO3.p, POKE_storm18_08_25_fDOM.p,
          POKE_storm19_08_27_NO3.p, POKE_storm19_08_27_fDOM.p,
          POKE_storm20_09_01_NO3.p, POKE_storm20_09_01_fDOM.p,
          POKE_storm21_09_03_NO3.p, POKE_storm21_09_03_fDOM.p,
          POKE_storm22a_09_07_NO3.p, POKE_storm22a_09_07_fDOM.p,
          POKE_storm22b_09_09_NO3.p, POKE_storm22b_09_09_fDOM.p,
          cols = 7) # works

#### VAUL Hysteresis ####
# NO3-#
VAUL_storm1a_06_19_NO3.p = hyst_plot(VAUL_storm1a_06_19_Q, VAUL_storm1a_06_19_NO3, "VAUL", "NO3", "0619a")
VAUL_storm1b_06_20_NO3.p = hyst_plot(VAUL_storm1b_06_20_Q, VAUL_storm1b_06_20_NO3, "VAUL", "NO3", "0620b")
VAUL_storm1c_06_22_NO3.p = hyst_plot(VAUL_storm1c_06_22_Q, VAUL_storm1c_06_22_NO3, "VAUL", "NO3", "0622c")
VAUL_storm2_06_27_NO3.p = hyst_plot(VAUL_storm2_06_27_Q, VAUL_storm2_06_27_NO3, "VAUL", "NO3", "0627")
VAUL_storm3_07_08_NO3.p = hyst_plot(VAUL_storm3_07_08_Q, VAUL_storm3_07_08_NO3, "VAUL", "NO3", "0708")
VAUL_storm4_07_12_NO3.p = hyst_plot(VAUL_storm4_07_12_Q, VAUL_storm4_07_12_NO3, "VAUL", "NO3", "0712")
VAUL_storm5_07_26_NO3.p = hyst_plot(VAUL_storm5_07_26_Q, VAUL_storm5_07_26_NO3, "VAUL", "NO3", "0726")
VAUL_storm6a_08_01_NO3.p = hyst_plot(VAUL_storm6a_08_01_Q, VAUL_storm6a_08_01_NO3, "VAUL", "NO3", "0801a")
VAUL_storm6b_08_02_NO3.p = hyst_plot(VAUL_storm6b_08_02_Q, VAUL_storm6b_08_02_NO3, "VAUL", "NO3", "0802b")
VAUL_storm7_08_08_NO3.p = hyst_plot(VAUL_storm7_08_08_Q, VAUL_storm7_08_08_NO3, "VAUL", "NO3", "0808")
VAUL_storm8_08_11_NO3.p = hyst_plot(VAUL_storm8_08_11_Q, VAUL_storm8_08_11_NO3, "VAUL", "NO3", "0811")
VAUL_storm9_08_12_NO3.p = hyst_plot(VAUL_storm9_08_12_Q, VAUL_storm9_08_12_NO3, "VAUL", "NO3", "0812")
VAUL_storm10_08_25_NO3.p = hyst_plot(VAUL_storm10_08_25_Q, VAUL_storm10_08_25_NO3, "VAUL", "NO3", "0825")
VAUL_storm11_08_27_NO3.p = hyst_plot(VAUL_storm11_08_27_Q, VAUL_storm11_08_27_NO3, "VAUL", "NO3", "0827")
VAUL_storm12_09_01_NO3.p = hyst_plot(VAUL_storm12_09_01_Q, VAUL_storm12_09_01_NO3, "VAUL", "NO3", "0901")
VAUL_storm13_09_03_NO3.p = hyst_plot(VAUL_storm13_09_03_Q, VAUL_storm13_09_03_NO3, "VAUL", "NO3", "0903")
VAUL_storm14_09_06_NO3.p = hyst_plot(VAUL_storm14_09_06_Q, VAUL_storm14_09_06_NO3, "VAUL", "NO3", "0906")

#fDOM#
VAUL_storm1a_06_19_fDOM.p = hyst_plot(VAUL_storm1a_06_19_Q, VAUL_storm1a_06_19_fDOM, "VAUL", "fDOM", "0619a")
VAUL_storm1b_06_20_fDOM.p = hyst_plot(VAUL_storm1b_06_20_Q, VAUL_storm1b_06_20_fDOM, "VAUL", "fDOM", "0620b")
VAUL_storm1c_06_22_fDOM.p = hyst_plot(VAUL_storm1c_06_22_Q, VAUL_storm1c_06_22_fDOM, "VAUL", "fDOM", "0622c")
VAUL_storm2_06_27_fDOM.p = hyst_plot(VAUL_storm2_06_27_Q, VAUL_storm2_06_27_fDOM, "VAUL", "fDOM", "0627")
VAUL_storm3_07_08_fDOM.p = hyst_plot(VAUL_storm3_07_08_Q, VAUL_storm3_07_08_fDOM, "VAUL", "fDOM", "0708")
VAUL_storm4_07_12_fDOM.p = hyst_plot(VAUL_storm4_07_12_Q, VAUL_storm4_07_12_fDOM, "VAUL", "fDOM", "0712")
VAUL_storm5_07_26_fDOM.p = hyst_plot(VAUL_storm5_07_26_Q, VAUL_storm5_07_26_fDOM, "VAUL", "fDOM", "0726")
VAUL_storm6a_08_01_fDOM.p = hyst_plot(VAUL_storm6a_08_01_Q, VAUL_storm6a_08_01_fDOM, "VAUL", "fDOM", "0801a")
VAUL_storm6b_08_02_fDOM.p = hyst_plot(VAUL_storm6b_08_02_Q, VAUL_storm6b_08_02_fDOM, "VAUL", "fDOM", "0802b")
VAUL_storm7_08_08_fDOM.p = hyst_plot(VAUL_storm7_08_08_Q, VAUL_storm7_08_08_fDOM, "VAUL", "fDOM", "0808")
VAUL_storm8_08_11_fDOM.p = hyst_plot(VAUL_storm8_08_11_Q, VAUL_storm8_08_11_fDOM, "VAUL", "fDOM", "0811")
VAUL_storm9_08_12_fDOM.p = hyst_plot(VAUL_storm9_08_12_Q, VAUL_storm9_08_12_fDOM, "VAUL", "fDOM", "0812")
VAUL_storm10_08_25_fDOM.p = hyst_plot(VAUL_storm10_08_25_Q, VAUL_storm10_08_25_fDOM, "VAUL", "fDOM", "0825")
VAUL_storm11_08_27_fDOM.p = hyst_plot(VAUL_storm11_08_27_Q, VAUL_storm11_08_27_fDOM, "VAUL", "fDOM", "0827")
VAUL_storm12_09_01_fDOM.p = hyst_plot(VAUL_storm12_09_01_Q, VAUL_storm12_09_01_fDOM, "VAUL", "fDOM", "0901")
VAUL_storm13_09_03_fDOM.p = hyst_plot(VAUL_storm13_09_03_Q, VAUL_storm13_09_03_fDOM, "VAUL", "fDOM", "0903")
VAUL_storm14_09_06_fDOM.p = hyst_plot(VAUL_storm14_09_06_Q, VAUL_storm14_09_06_fDOM, "VAUL", "fDOM", "0906")
# SPC #
VAUL_storm1a_06_19_SPC.p = hyst_plot(VAUL_storm1a_06_19_Q, VAUL_storm1a_06_19_SPC, "VAUL", "SPC", "0619a")
VAUL_storm1b_06_20_SPC.p = hyst_plot(VAUL_storm1b_06_20_Q, VAUL_storm1b_06_20_SPC, "VAUL", "SPC", "0620b")
VAUL_storm1c_06_22_SPC.p = hyst_plot(VAUL_storm1c_06_22_Q, VAUL_storm1c_06_22_SPC, "VAUL", "SPC", "0622c")
VAUL_storm2_06_27_SPC.p = hyst_plot(VAUL_storm2_06_27_Q, VAUL_storm2_06_27_SPC, "VAUL", "SPC", "0627")
VAUL_storm3_07_08_SPC.p = hyst_plot(VAUL_storm3_07_08_Q, VAUL_storm3_07_08_SPC, "VAUL", "SPC", "0708")
VAUL_storm4_07_12_SPC.p = hyst_plot(VAUL_storm4_07_12_Q, VAUL_storm4_07_12_SPC, "VAUL", "SPC", "0712")
VAUL_storm5_07_26_SPC.p = hyst_plot(VAUL_storm5_07_26_Q, VAUL_storm5_07_26_SPC, "VAUL", "SPC", "0726")
VAUL_storm6a_08_01_SPC.p = hyst_plot(VAUL_storm6a_08_01_Q, VAUL_storm6a_08_01_SPC, "VAUL", "SPC", "0801a")
VAUL_storm6b_08_02_SPC.p = hyst_plot(VAUL_storm6b_08_02_Q, VAUL_storm6b_08_02_SPC, "VAUL", "SPC", "0802b")
VAUL_storm7_08_08_SPC.p = hyst_plot(VAUL_storm7_08_08_Q, VAUL_storm7_08_08_SPC, "VAUL", "SPC", "0808")
VAUL_storm8_08_11_SPC.p = hyst_plot(VAUL_storm8_08_11_Q, VAUL_storm8_08_11_SPC, "VAUL", "SPC", "0811")
VAUL_storm9_08_12_SPC.p = hyst_plot(VAUL_storm9_08_12_Q, VAUL_storm9_08_12_SPC, "VAUL", "SPC", "0812")
VAUL_storm10_08_25_SPC.p = hyst_plot(VAUL_storm10_08_25_Q, VAUL_storm10_08_25_SPC, "VAUL", "SPC", "0825")
VAUL_storm11_08_27_SPC.p = hyst_plot(VAUL_storm11_08_27_Q, VAUL_storm11_08_27_SPC, "VAUL", "SPC", "0827")
VAUL_storm12_09_01_SPC.p = hyst_plot(VAUL_storm12_09_01_Q, VAUL_storm12_09_01_SPC, "VAUL", "SPC", "0901")
VAUL_storm13_09_03_SPC.p = hyst_plot(VAUL_storm13_09_03_Q, VAUL_storm13_09_03_SPC, "VAUL", "SPC", "0903")
VAUL_storm14_09_06_SPC.p = hyst_plot(VAUL_storm14_09_06_Q, VAUL_storm14_09_06_SPC, "VAUL", "SPC", "0906")

# turb #
VAUL_storm1a_06_19_turb.p = hyst_plot(VAUL_storm1a_06_19_Q, VAUL_storm1a_06_19_turb, "VAUL", "turb", "0619a")
VAUL_storm1b_06_20_turb.p = hyst_plot(VAUL_storm1b_06_20_Q, VAUL_storm1b_06_20_turb, "VAUL", "turb", "0620b")
VAUL_storm1c_06_22_turb.p = hyst_plot(VAUL_storm1c_06_22_Q, VAUL_storm1c_06_22_turb, "VAUL", "turb", "0622c")
VAUL_storm2_06_27_turb.p = hyst_plot(VAUL_storm2_06_27_Q, VAUL_storm2_06_27_turb, "VAUL", "turb", "0627")
VAUL_storm3_07_08_turb.p = hyst_plot(VAUL_storm3_07_08_Q, VAUL_storm3_07_08_turb, "VAUL", "turb", "0708")
VAUL_storm4_07_12_turb.p = hyst_plot(VAUL_storm4_07_12_Q, VAUL_storm4_07_12_turb, "VAUL", "turb", "0712")
VAUL_storm5_07_26_turb.p = hyst_plot(VAUL_storm5_07_26_Q, VAUL_storm5_07_26_turb, "VAUL", "turb", "0726")
VAUL_storm6a_08_01_turb.p = hyst_plot(VAUL_storm6a_08_01_Q, VAUL_storm6a_08_01_turb, "VAUL", "turb", "0801a")
VAUL_storm6b_08_02_turb.p = hyst_plot(VAUL_storm6b_08_02_Q, VAUL_storm6b_08_02_turb, "VAUL", "turb", "0802b")
VAUL_storm7_08_08_turb.p = hyst_plot(VAUL_storm7_08_08_Q, VAUL_storm7_08_08_turb, "VAUL", "turb", "0808")
VAUL_storm8_08_11_turb.p = hyst_plot(VAUL_storm8_08_11_Q, VAUL_storm8_08_11_turb, "VAUL", "turb", "0811")
VAUL_storm9_08_12_turb.p = hyst_plot(VAUL_storm9_08_12_Q, VAUL_storm9_08_12_turb, "VAUL", "turb", "0812")
VAUL_storm10_08_25_turb.p = hyst_plot(VAUL_storm10_08_25_Q, VAUL_storm10_08_25_turb, "VAUL", "turb", "0825")
VAUL_storm11_08_27_turb.p = hyst_plot(VAUL_storm11_08_27_Q, VAUL_storm11_08_27_turb, "VAUL", "turb", "0827")
VAUL_storm12_09_01_turb.p = hyst_plot(VAUL_storm12_09_01_Q, VAUL_storm12_09_01_turb, "VAUL", "turb", "0901")
VAUL_storm13_09_03_turb.p = hyst_plot(VAUL_storm13_09_03_Q, VAUL_storm13_09_03_turb, "VAUL", "turb", "0903")
VAUL_storm14_09_06_turb.p = hyst_plot(VAUL_storm14_09_06_Q, VAUL_storm14_09_06_turb, "VAUL", "turb", "0906")


# Plot Loops #
multiplot(VAUL_storm1a_06_19_NO3.p, VAUL_storm1a_06_19_fDOM.p) # No3 doesnt have much of a relationship by fdom does 
multiplot(VAUL_storm1b_06_20_NO3.p, VAUL_storm1b_06_20_fDOM.p) # No3 doesnt have much of a relationship by fdom does 
multiplot(VAUL_storm2_06_27_NO3.p, VAUL_storm2_06_27_fDOM.p) # fdom NAs? 
multiplot(VAUL_storm3_07_08_NO3.p, VAUL_storm3_07_08_fDOM.p) # works 
multiplot(VAUL_storm4_07_12_NO3.p, VAUL_storm4_07_12_fDOM.p) # works 
multiplot(VAUL_storm5_07_26_NO3.p, VAUL_storm5_07_26_fDOM.p) # works
multiplot(VAUL_storm6a_08_01_NO3.p, VAUL_storm6a_08_01_fDOM.p) # works but needs to be cleaned for values below 10
multiplot(VAUL_storm6b_08_02_NO3.p, VAUL_storm6b_08_02_fDOM.p) # works but needs to be cleaned 
multiplot(VAUL_storm7_08_08_NO3.p, VAUL_storm7_08_08_fDOM.p) # fdom has one really big value...nitrate needs cleaning 
multiplot(VAUL_storm8_08_11_NO3.p, VAUL_storm8_08_11_fDOM.p) # works
multiplot(VAUL_storm9_08_12_NO3.p, VAUL_storm9_08_12_fDOM.p)# works
multiplot(VAUL_storm10_08_25_NO3.p, VAUL_storm10_08_25_fDOM.p) # works 
multiplot(VAUL_storm11_08_27_NO3.p, VAUL_storm11_08_27_fDOM.p) # works 
multiplot(VAUL_storm12_09_01_NO3.p, VAUL_storm12_09_01_fDOM.p) # works
multiplot(VAUL_storm13_09_03_NO3.p, VAUL_storm13_09_03_fDOM.p) # works
multiplot(VAUL_storm14_09_06_NO3.p, VAUL_storm14_09_06_fDOM.p) # works


multiplot(VAUL_storm1a_06_19_SPC.p, VAUL_storm1a_06_19_turb.p) # works
multiplot(VAUL_storm1b_06_20_SPC.p, VAUL_storm1b_06_20_turb.p) # works
multiplot(VAUL_storm2_06_27_SPC.p, VAUL_storm2_06_27_turb.p) # empty
multiplot(VAUL_storm3_07_08_SPC.p, VAUL_storm3_07_08_turb.p) # works 
multiplot(VAUL_storm4_07_12_SPC.p, VAUL_storm4_07_12_turb.p) # works 
multiplot(VAUL_storm5_07_26_SPC.p, VAUL_storm5_07_26_turb.p) # works
multiplot(VAUL_storm6a_08_01_SPC.p, VAUL_storm6a_08_01_turb.p) # works 
multiplot(VAUL_storm6b_08_02_SPC.p, VAUL_storm6b_08_02_turb.p) # works 
multiplot(VAUL_storm7_08_08_SPC.p, VAUL_storm7_08_08_turb.p) # works
multiplot(VAUL_storm8_08_11_SPC.p, VAUL_storm8_08_11_turb.p) # works
multiplot(VAUL_storm9_08_12_SPC.p, VAUL_storm9_08_12_turb.p)# works
multiplot(VAUL_storm10_08_25_SPC.p, VAUL_storm10_08_25_turb.p) # works 
multiplot(VAUL_storm11_08_27_SPC.p, VAUL_storm11_08_27_turb.p) # works 
multiplot(VAUL_storm12_09_01_SPC.p, VAUL_storm12_09_01_turb.p) # works
multiplot(VAUL_storm13_09_03_SPC.p, VAUL_storm13_09_03_turb.p) # works
multiplot(VAUL_storm14_09_06_SPC.p, VAUL_storm14_09_06_turb.p) # works


multiplot(VAUL_storm1a_06_19_NO3.p, VAUL_storm1a_06_19_fDOM.p, VAUL_storm1a_06_19_SPC.p, VAUL_storm1a_06_19_turb.p,
          VAUL_storm1b_06_20_NO3.p, VAUL_storm1b_06_20_fDOM.p, VAUL_storm1b_06_20_SPC.p, VAUL_storm1b_06_20_turb.p,
          VAUL_storm2_06_27_NO3.p, VAUL_storm2_06_27_fDOM.p,
          VAUL_storm3_07_08_NO3.p, VAUL_storm3_07_08_fDOM.p, VAUL_storm3_07_08_SPC.p, VAUL_storm3_07_08_turb.p,
          VAUL_storm4_07_12_NO3.p, VAUL_storm4_07_12_fDOM.p, VAUL_storm4_07_12_SPC.p, VAUL_storm4_07_12_turb.p,
          VAUL_storm5_07_26_NO3.p, VAUL_storm5_07_26_fDOM.p, VAUL_storm5_07_26_SPC.p, VAUL_storm5_07_26_turb.p,
          VAUL_storm6a_08_01_NO3.p, VAUL_storm6a_08_01_fDOM.p,VAUL_storm6a_08_01_SPC.p, VAUL_storm6a_08_01_turb.p,
          VAUL_storm6b_08_02_NO3.p, VAUL_storm6b_08_02_fDOM.p, VAUL_storm6b_08_02_SPC.p, VAUL_storm6b_08_02_turb.p,
          VAUL_storm7_08_08_NO3.p, VAUL_storm7_08_08_fDOM.p, VAUL_storm7_08_08_SPC.p, VAUL_storm7_08_08_turb.p,
          VAUL_storm8_08_11_NO3.p, VAUL_storm8_08_11_fDOM.p, VAUL_storm8_08_11_SPC.p, VAUL_storm8_08_11_turb.p,
          VAUL_storm9_08_12_NO3.p, VAUL_storm9_08_12_fDOM.p, VAUL_storm9_08_12_SPC.p, VAUL_storm9_08_12_turb.p,
          VAUL_storm10_08_25_NO3.p, VAUL_storm10_08_25_fDOM.p, VAUL_storm10_08_25_SPC.p, VAUL_storm10_08_25_turb.p,
          VAUL_storm11_08_27_NO3.p, VAUL_storm11_08_27_fDOM.p, VAUL_storm11_08_27_SPC.p, VAUL_storm11_08_27_turb.p,
          VAUL_storm12_09_01_NO3.p, VAUL_storm12_09_01_fDOM.p, VAUL_storm12_09_01_SPC.p, VAUL_storm12_09_01_turb.p,
          VAUL_storm13_09_03_NO3.p, VAUL_storm13_09_03_fDOM.p, VAUL_storm13_09_03_SPC.p, VAUL_storm13_09_03_turb.p,
          VAUL_storm14_09_06_NO3.p, VAUL_storm14_09_06_fDOM.p,VAUL_storm14_09_06_SPC.p, VAUL_storm14_09_06_turb.p,
          cols = 7)

# export pdf 20 x 30



##################################### 2021 ###########################################
# MOOS #
# fxn: plot hysteresis loop #
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
  dat.p = ggplot(data = dat_Q, 
                 aes(x=(dat_Q$datavalue), 
                     y=(dat_response$datavalue), 
                     color = as.numeric(dat_Q$valuedatetime))) +
    geom_point() +
    scale_colour_gradientn(colors = rainbow(3)) +
    theme_bw() +
    theme(legend.position="none") + 
    theme(axis.text=element_text(size=12),
          axis.title=element_text(size=14,face="bold")) +
    ylab(paste(site, response_var))+
    xlab("Normalized Discharge") +
    ggtitle(paste("Storm", storm_num))
  return(dat.p)
}

# plot MOOS loops #
# NO3
MOOS_storm1_07_23_NO3.p = hyst_plot(MOOS_storm1_07_23_Q, MOOS_storm1_07_23_NO3, "MOOS", "NO3", "0723")
MOOS_storm2_07_27_NO3.p = hyst_plot(MOOS_storm2_07_27_Q, MOOS_storm2_07_27_NO3, "MOOS", "NO3", "0727")
MOOS_storm3a_08_06_NO3.p = hyst_plot(MOOS_storm3a_08_06_Q, MOOS_storm3a_08_06_NO3, "MOOS", "NO3", "0806a")
MOOS_storm3b_08_08_NO3.p = hyst_plot(MOOS_storm3b_08_08_Q, MOOS_storm3b_08_08_NO3, "MOOS", "NO3", "0808b")
MOOS_storm4a_08_15_NO3.p = hyst_plot(MOOS_storm4a_08_15_Q, MOOS_storm4a_08_15_NO3, "MOOS", "NO3", "0815a")
MOOS_storm4b_08_17_NO3.p = hyst_plot(MOOS_storm4b_08_17_Q, MOOS_storm4b_08_17_NO3, "MOOS", "NO3", "0817b")
MOOS_storm5a_08_19_NO3.p = hyst_plot(MOOS_storm5a_08_19_Q, MOOS_storm5a_08_19_NO3, "MOOS", "NO3", "0819a")
MOOS_storm5b_08_21_NO3.p = hyst_plot(MOOS_storm5b_08_21_Q, MOOS_storm5b_08_21_NO3, "MOOS", "NO3", "0821b")
MOOS_storm6_08_25_NO3.p = hyst_plot(MOOS_storm6_08_25_Q, MOOS_storm6_08_25_NO3, "MOOS", "NO3", "0825")
MOOS_storm7_08_27_NO3.p = hyst_plot(MOOS_storm7_08_27_Q, MOOS_storm7_08_27_NO3, "MOOS", "NO3", "0827")

# fDOM #
MOOS_storm1_07_23_fDOM.p = hyst_plot(MOOS_storm1_07_23_Q, MOOS_storm1_07_23_fDOM, "MOOS", "fDOM", "0723")
MOOS_storm2_07_27_fDOM.p = hyst_plot(MOOS_storm2_07_27_Q, MOOS_storm2_07_27_fDOM, "MOOS", "fDOM", "0727")
MOOS_storm3a_08_06_fDOM.p = hyst_plot(MOOS_storm3a_08_06_Q, MOOS_storm3a_08_06_fDOM, "MOOS", "fDOM", "0806a")
MOOS_storm3b_08_08_fDOM.p = hyst_plot(MOOS_storm3b_08_08_Q, MOOS_storm3b_08_08_fDOM, "MOOS", "fDOM", "0808b")
MOOS_storm4a_08_15_fDOM.p = hyst_plot(MOOS_storm4a_08_15_Q, MOOS_storm4a_08_15_fDOM, "MOOS", "fDOM", "0815a")
MOOS_storm4b_08_17_fDOM.p = hyst_plot(MOOS_storm4b_08_17_Q, MOOS_storm4b_08_17_fDOM, "MOOS", "fDOM", "0817b")
MOOS_storm5a_08_19_fDOM.p = hyst_plot(MOOS_storm5a_08_19_Q, MOOS_storm5a_08_19_fDOM, "MOOS", "fDOM", "0819a")
MOOS_storm5b_08_21_fDOM.p = hyst_plot(MOOS_storm5b_08_21_Q, MOOS_storm5b_08_21_fDOM, "MOOS", "fDOM", "0821b")
MOOS_storm6_08_25_fDOM.p = hyst_plot(MOOS_storm6_08_25_Q, MOOS_storm6_08_25_fDOM, "MOOS", "fDOM", "0825")
MOOS_storm7_08_27_fDOM.p = hyst_plot(MOOS_storm7_08_27_Q, MOOS_storm7_08_27_fDOM, "MOOS", "fDOM", "0827")

# SPC #
MOOS_storm1_07_23_SPC.p = hyst_plot(MOOS_storm1_07_23_Q, MOOS_storm1_07_23_SPC, "MOOS", "SPC", "0723")
MOOS_storm2_07_27_SPC.p = hyst_plot(MOOS_storm2_07_27_Q, MOOS_storm2_07_27_SPC, "MOOS", "SPC", "0727")
MOOS_storm3a_08_06_SPC.p = hyst_plot(MOOS_storm3a_08_06_Q, MOOS_storm3a_08_06_SPC, "MOOS", "SPC", "0806a")
MOOS_storm3b_08_08_SPC.p = hyst_plot(MOOS_storm3b_08_08_Q, MOOS_storm3b_08_08_SPC, "MOOS", "SPC", "0808b")
MOOS_storm4a_08_15_SPC.p = hyst_plot(MOOS_storm4a_08_15_Q, MOOS_storm4a_08_15_SPC, "MOOS", "SPC", "0815a")
MOOS_storm4b_08_17_SPC.p = hyst_plot(MOOS_storm4b_08_17_Q, MOOS_storm4b_08_17_SPC, "MOOS", "SPC", "0817b")
MOOS_storm5a_08_19_SPC.p = hyst_plot(MOOS_storm5a_08_19_Q, MOOS_storm5a_08_19_SPC, "MOOS", "SPC", "0819a")
MOOS_storm5b_08_21_SPC.p = hyst_plot(MOOS_storm5b_08_21_Q, MOOS_storm5b_08_21_SPC, "MOOS", "SPC", "0821b")
MOOS_storm6_08_25_SPC.p = hyst_plot(MOOS_storm6_08_25_Q, MOOS_storm6_08_25_SPC, "MOOS", "SPC", "0825")
MOOS_storm7_08_27_SPC.p = hyst_plot(MOOS_storm7_08_27_Q, MOOS_storm7_08_27_SPC, "MOOS", "SPC", "0827")

# turb
MOOS_storm1_07_23_turb.p = hyst_plot(MOOS_storm1_07_23_Q, MOOS_storm1_07_23_turb, "MOOS", "turb", "0723")
MOOS_storm2_07_27_turb.p = hyst_plot(MOOS_storm2_07_27_Q, MOOS_storm2_07_27_turb, "MOOS", "turb", "0727")
MOOS_storm3a_08_06_turb.p = hyst_plot(MOOS_storm3a_08_06_Q, MOOS_storm3a_08_06_turb, "MOOS", "turb", "0806a")
MOOS_storm3b_08_08_turb.p = hyst_plot(MOOS_storm3b_08_08_Q, MOOS_storm3b_08_08_turb, "MOOS", "turb", "0808b")
MOOS_storm4a_08_15_turb.p = hyst_plot(MOOS_storm4a_08_15_Q, MOOS_storm4a_08_15_turb, "MOOS", "turb", "0815a")
MOOS_storm4b_08_17_turb.p = hyst_plot(MOOS_storm4b_08_17_Q, MOOS_storm4b_08_17_turb, "MOOS", "turb", "0817b")
MOOS_storm5a_08_19_turb.p = hyst_plot(MOOS_storm5a_08_19_Q, MOOS_storm5a_08_19_turb, "MOOS", "turb", "0819a")
MOOS_storm5b_08_21_turb.p = hyst_plot(MOOS_storm5b_08_21_Q, MOOS_storm5b_08_21_turb, "MOOS", "turb", "0821b")
MOOS_storm6_08_25_turb.p = hyst_plot(MOOS_storm6_08_25_Q, MOOS_storm6_08_25_turb, "MOOS", "turb", "0825")
MOOS_storm7_08_27_turb.p = hyst_plot(MOOS_storm7_08_27_Q, MOOS_storm7_08_27_turb, "MOOS", "turb", "0827")

# Multiplots of MOOS storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

multiplot(MOOS_storm1_07_23_NO3.p, MOOS_storm1_07_23_fDOM.p, MOOS_storm1_07_23_SPC.p, MOOS_storm1_07_23_turb.p) # works 
multiplot(MOOS_storm2_07_27_NO3.p, MOOS_storm2_07_27_fDOM.p, MOOS_storm2_07_27_SPC.p, MOOS_storm2_07_27_turb.p) # works/ empty
multiplot(MOOS_storm3a_08_06_NO3.p, MOOS_storm3a_08_06_fDOM.p, MOOS_storm3a_08_06_SPC.p, MOOS_storm3a_08_06_turb.p) # works/empty
multiplot(MOOS_storm3b_08_08_NO3.p, MOOS_storm3b_08_08_fDOM.p, MOOS_storm3b_08_08_SPC.p, MOOS_storm3b_08_08_turb.p) # works/empty
multiplot(MOOS_storm4a_08_15_NO3.p, MOOS_storm4a_08_15_fDOM.p, MOOS_storm4a_08_15_SPC.p, MOOS_storm4a_08_15_turb.p) # works 
multiplot(MOOS_storm4b_08_17_NO3.p, MOOS_storm4b_08_17_fDOM.p, MOOS_storm4b_08_17_SPC.p, MOOS_storm4b_08_17_turb.p) # works 
multiplot(MOOS_storm5a_08_19_NO3.p, MOOS_storm5a_08_19_fDOM.p, MOOS_storm5a_08_19_SPC.p, MOOS_storm5a_08_19_turb.p) # works 
multiplot(MOOS_storm5b_08_21_NO3.p, MOOS_storm5b_08_21_fDOM.p, MOOS_storm5b_08_21_SPC.p, MOOS_storm5b_08_21_turb.p) # works 
multiplot(MOOS_storm6_08_25_NO3.p, MOOS_storm6_08_25_fDOM.p, MOOS_storm6_08_25_SPC.p, MOOS_storm6_08_25_turb.p) # works 
multiplot(MOOS_storm7_08_27_NO3.p, MOOS_storm7_08_27_fDOM.p, MOOS_storm7_08_27_SPC.p, MOOS_storm7_08_27_turb.p) # works 


multiplot(MOOS_storm1_07_23_NO3.p, MOOS_storm1_07_23_fDOM.p, MOOS_storm1_07_23_SPC.p, MOOS_storm1_07_23_turb.p,
          MOOS_storm2_07_27_NO3.p, MOOS_storm2_07_27_fDOM.p, MOOS_storm2_07_27_SPC.p, MOOS_storm2_07_27_turb.p,
          MOOS_storm3a_08_06_NO3.p, MOOS_storm3a_08_06_fDOM.p, MOOS_storm3a_08_06_SPC.p, MOOS_storm3a_08_06_turb.p,
          MOOS_storm3b_08_08_NO3.p, MOOS_storm3b_08_08_fDOM.p, MOOS_storm3b_08_08_SPC.p, MOOS_storm3b_08_08_turb.p,
          MOOS_storm4a_08_15_NO3.p, MOOS_storm4a_08_15_fDOM.p, MOOS_storm4a_08_15_SPC.p, MOOS_storm4a_08_15_turb.p,
          MOOS_storm4b_08_17_NO3.p, MOOS_storm4b_08_17_fDOM.p, MOOS_storm4b_08_17_SPC.p, MOOS_storm4b_08_17_turb.p,
          MOOS_storm5a_08_19_NO3.p, MOOS_storm5a_08_19_fDOM.p, MOOS_storm5a_08_19_SPC.p, MOOS_storm5a_08_19_turb.p,
          MOOS_storm5b_08_21_NO3.p, MOOS_storm5b_08_21_fDOM.p, MOOS_storm5b_08_21_SPC.p, MOOS_storm5b_08_21_turb.p,
          MOOS_storm6_08_25_NO3.p, MOOS_storm6_08_25_fDOM.p, MOOS_storm6_08_25_SPC.p, MOOS_storm6_08_25_turb.p,
          MOOS_storm7_08_27_NO3.p, MOOS_storm7_08_27_fDOM.p, MOOS_storm7_08_27_SPC.p, MOOS_storm7_08_27_turb.p,
          cols = 7)

# VAUL #
# fxn: plot hysteresis loop #
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
  dat.p = ggplot(data = dat_Q, 
                 aes(x=(dat_Q$datavalue), 
                     y=(dat_response$datavalue), 
                     color = as.numeric(dat_Q$valuedatetime))) +
    geom_point() +
    scale_colour_gradientn(colors = rainbow(3)) +
    theme_bw() +
    theme(legend.position="none") + 
    theme(axis.text=element_text(size=12),
          axis.title=element_text(size=14,face="bold")) +
    ylab(paste(site, response_var))+
    xlab("Normalized Discharge") +
    ggtitle(paste("Storm", storm_num))
  return(dat.p)
}

# plot VAUL loops #
# NO3
VAUL_storm1a_07_23_NO3.p = hyst_plot(VAUL_storm1a_07_23_Q, VAUL_storm1a_07_23_NO3, "VAUL", "NO3", "0723a")
VAUL_storm1b_07_27_NO3.p = hyst_plot(VAUL_storm1b_07_27_Q, VAUL_storm1b_07_27_NO3, "VAUL", "NO3", "0727b")
VAUL_storm2_08_05_NO3.p = hyst_plot(VAUL_storm2_08_05_Q, VAUL_storm2_08_05_NO3, "VAUL", "NO3", "0805")
VAUL_storm3_08_08_NO3.p = hyst_plot(VAUL_storm3_08_08_Q, VAUL_storm3_08_08_NO3, "VAUL", "NO3", "0808")
VAUL_storm4a_08_15_NO3.p = hyst_plot(VAUL_storm4a_08_15_Q, VAUL_storm4a_08_15_NO3, "VAUL", "NO3", "0815a")
VAUL_storm4b_08_20_NO3.p = hyst_plot(VAUL_storm4b_08_20_Q, VAUL_storm4b_08_20_NO3, "VAUL", "NO3", "0820b")
VAUL_storm5a_08_23_NO3.p = hyst_plot(VAUL_storm5a_08_23_Q, VAUL_storm5a_08_23_NO3, "VAUL", "NO3", "0823a")
VAUL_storm5b_08_26_NO3.p = hyst_plot(VAUL_storm5b_08_26_Q, VAUL_storm5b_08_26_NO3, "VAUL", "NO3", "0826b")

# fDOM #
VAUL_storm1a_07_23_fDOM.p = hyst_plot(VAUL_storm1a_07_23_Q, VAUL_storm1a_07_23_fDOM, "VAUL", "fDOM", "0723a")
VAUL_storm1b_07_27_fDOM.p = hyst_plot(VAUL_storm1b_07_27_Q, VAUL_storm1b_07_27_fDOM, "VAUL", "fDOM", "0727b")
VAUL_storm2_08_05_fDOM.p = hyst_plot(VAUL_storm2_08_05_Q, VAUL_storm2_08_05_fDOM, "VAUL", "fDOM", "0805")
VAUL_storm3_08_08_fDOM.p = hyst_plot(VAUL_storm3_08_08_Q, VAUL_storm3_08_08_fDOM, "VAUL", "fDOM", "0808")
VAUL_storm4a_08_15_fDOM.p = hyst_plot(VAUL_storm4a_08_15_Q, VAUL_storm4a_08_15_fDOM, "VAUL", "fDOM", "0815a")
VAUL_storm4b_08_20_fDOM.p = hyst_plot(VAUL_storm4b_08_20_Q, VAUL_storm4b_08_20_fDOM, "VAUL", "fDOM", "0820b")
VAUL_storm5a_08_23_fDOM.p = hyst_plot(VAUL_storm5a_08_23_Q, VAUL_storm5a_08_23_fDOM, "VAUL", "fDOM", "0823a")
VAUL_storm5b_08_26_fDOM.p = hyst_plot(VAUL_storm5b_08_26_Q, VAUL_storm5b_08_26_fDOM, "VAUL", "fDOM", "0826b")

# SPC #
VAUL_storm1a_07_23_SPC.p = hyst_plot(VAUL_storm1a_07_23_Q, VAUL_storm1a_07_23_SPC, "VAUL", "SPC", "0723a")
VAUL_storm1b_07_27_SPC.p = hyst_plot(VAUL_storm1b_07_27_Q, VAUL_storm1b_07_27_SPC, "VAUL", "SPC", "0727b")
VAUL_storm2_08_05_SPC.p = hyst_plot(VAUL_storm2_08_05_Q, VAUL_storm2_08_05_SPC, "VAUL", "SPC", "0805")
VAUL_storm3_08_08_SPC.p = hyst_plot(VAUL_storm3_08_08_Q, VAUL_storm3_08_08_SPC, "VAUL", "SPC", "0808")
VAUL_storm4a_08_15_SPC.p = hyst_plot(VAUL_storm4a_08_15_Q, VAUL_storm4a_08_15_SPC, "VAUL", "SPC", "0815a")
VAUL_storm4b_08_20_SPC.p = hyst_plot(VAUL_storm4b_08_20_Q, VAUL_storm4b_08_20_SPC, "VAUL", "SPC", "0820b")
VAUL_storm5a_08_23_SPC.p = hyst_plot(VAUL_storm5a_08_23_Q, VAUL_storm5a_08_23_SPC, "VAUL", "SPC", "0823a")
VAUL_storm5b_08_26_SPC.p = hyst_plot(VAUL_storm5b_08_26_Q, VAUL_storm5b_08_26_SPC, "VAUL", "SPC", "0826b")

# turb
VAUL_storm1a_07_23_turb.p = hyst_plot(VAUL_storm1a_07_23_Q, VAUL_storm1a_07_23_turb, "VAUL", "turb", "0723a")
VAUL_storm1b_07_27_turb.p = hyst_plot(VAUL_storm1b_07_27_Q, VAUL_storm1b_07_27_turb, "VAUL", "turb", "0727b")
VAUL_storm2_08_05_turb.p = hyst_plot(VAUL_storm2_08_05_Q, VAUL_storm2_08_05_turb, "VAUL", "turb", "0805")
VAUL_storm3_08_08_turb.p = hyst_plot(VAUL_storm3_08_08_Q, VAUL_storm3_08_08_turb, "VAUL", "turb", "0808")
VAUL_storm4a_08_15_turb.p = hyst_plot(VAUL_storm4a_08_15_Q, VAUL_storm4a_08_15_turb, "VAUL", "turb", "0815a")
VAUL_storm4b_08_20_turb.p = hyst_plot(VAUL_storm4b_08_20_Q, VAUL_storm4b_08_20_turb, "VAUL", "turb", "0820b")
VAUL_storm5a_08_23_turb.p = hyst_plot(VAUL_storm5a_08_23_Q, VAUL_storm5a_08_23_turb, "VAUL", "turb", "0823a")
VAUL_storm5b_08_26_turb.p = hyst_plot(VAUL_storm5b_08_26_Q, VAUL_storm5b_08_26_turb, "VAUL", "turb", "0826b")

# Multiplots of VAUL storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

multiplot(VAUL_storm1a_07_23_NO3.p, VAUL_storm1a_07_23_fDOM.p, VAUL_storm1a_07_23_SPC.p, VAUL_storm1a_07_23_turb.p) # works 
multiplot(VAUL_storm1b_07_27_NO3.p, VAUL_storm1b_07_27_fDOM.p, VAUL_storm1b_07_27_SPC.p, VAUL_storm1b_07_27_turb.p) # works/ empty
multiplot(VAUL_storm2_08_05_NO3.p, VAUL_storm2_08_05_fDOM.p, VAUL_storm2_08_05_SPC.p, VAUL_storm2_08_05_turb.p) # works/empty
multiplot(VAUL_storm3_08_08_NO3.p, VAUL_storm3_08_08_fDOM.p, VAUL_storm3_08_08_SPC.p, VAUL_storm3_08_08_turb.p) # works/empty
multiplot(VAUL_storm4a_08_15_NO3.p, VAUL_storm4a_08_15_fDOM.p, VAUL_storm4a_08_15_SPC.p, VAUL_storm4a_08_15_turb.p) # works 
multiplot(VAUL_storm4b_08_20_NO3.p, VAUL_storm4b_08_20_fDOM.p, VAUL_storm4b_08_20_SPC.p, VAUL_storm4b_08_20_turb.p) # works 
multiplot(VAUL_storm5a_08_23_NO3.p, VAUL_storm5a_08_23_fDOM.p, VAUL_storm5a_08_23_SPC.p, VAUL_storm5a_08_23_turb.p) # works 
multiplot(VAUL_storm5b_08_26_NO3.p, VAUL_storm5b_08_26_fDOM.p, VAUL_storm5b_08_26_SPC.p, VAUL_storm5b_08_26_turb.p) # works 


multiplot(VAUL_storm1a_07_23_NO3.p, VAUL_storm1a_07_23_fDOM.p, VAUL_storm1a_07_23_SPC.p, VAUL_storm1a_07_23_turb.p,
          VAUL_storm1b_07_27_NO3.p, VAUL_storm1b_07_27_fDOM.p, VAUL_storm1b_07_27_SPC.p, VAUL_storm1b_07_27_turb.p,
          VAUL_storm2_08_05_NO3.p, VAUL_storm2_08_05_fDOM.p, VAUL_storm2_08_05_SPC.p, VAUL_storm2_08_05_turb.p,
          VAUL_storm3_08_08_NO3.p, VAUL_storm3_08_08_fDOM.p, VAUL_storm3_08_08_SPC.p, VAUL_storm3_08_08_turb.p,
          VAUL_storm4a_08_15_NO3.p, VAUL_storm4a_08_15_fDOM.p, VAUL_storm4a_08_15_SPC.p, VAUL_storm4a_08_15_turb.p,
          VAUL_storm4b_08_20_NO3.p, VAUL_storm4b_08_20_fDOM.p, VAUL_storm4b_08_20_SPC.p, VAUL_storm4b_08_20_turb.p,
          VAUL_storm5a_08_23_NO3.p, VAUL_storm5a_08_23_fDOM.p, VAUL_storm5a_08_23_SPC.p, VAUL_storm5a_08_23_turb.p,
          VAUL_storm5b_08_26_NO3.p, VAUL_storm5b_08_26_fDOM.p, VAUL_storm5b_08_26_SPC.p, VAUL_storm5b_08_26_turb.p,
          cols = 7)

# FRCH #
# fxn: plot hysteresis loop #
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
  dat.p = ggplot(data = dat_Q, 
                 aes(x=(dat_Q$datavalue), 
                     y=(dat_response$datavalue), 
                     color = as.numeric(dat_Q$valuedatetime))) +
    geom_point() +
    scale_colour_gradientn(colors = rainbow(3)) +
    theme_bw() +
    theme(legend.position="none") + 
    theme(axis.text=element_text(size=12),
          axis.title=element_text(size=14,face="bold")) +
    ylab(paste(site, response_var))+
    xlab("Normalized Discharge") +
    ggtitle(paste("Storm", storm_num))
  return(dat.p)
}

# plot VAUL loops #
# NO3
FRCH_storm1_07_23_NO3.p = hyst_plot(FRCH_storm1_07_23_Q, FRCH_storm1_07_23_NO3, "FRCH", "NO3", "0723")
FRCH_storm2_07_27_NO3.p = hyst_plot(FRCH_storm2_07_27_Q, FRCH_storm2_07_27_NO3, "FRCH", "NO3", "0727")
FRCH_storm3_08_05_NO3.p = hyst_plot(FRCH_storm3_08_05_Q, FRCH_storm3_08_05_NO3, "VAUL", "NO3", "0805")
FRCH_storm4_08_08_NO3.p = hyst_plot(FRCH_storm4_08_08_Q, FRCH_storm4_08_08_NO3, "FRCH", "NO3", "0808")
FRCH_storm5a_08_15_NO3.p = hyst_plot(FRCH_storm5a_08_15_Q, FRCH_storm5a_08_15_NO3, "FRCH", "NO3", "0815a")
FRCH_storm5b_08_17_NO3.p = hyst_plot(FRCH_storm5b_08_17_Q, FRCH_storm5b_08_17_NO3, "FRCH", "NO3", "0817b")
FRCH_storm6a_08_19_NO3.p = hyst_plot(FRCH_storm6a_08_19_Q, FRCH_storm6a_08_19_NO3, "FRCH", "NO3", "0819q")
FRCH_storm6b_08_20_NO3.p = hyst_plot(FRCH_storm6b_08_20_Q, FRCH_storm6b_08_20_NO3, "FRCH", "NO3", "0820b")
FRCH_storm7_08_25_NO3.p = hyst_plot(FRCH_storm7_08_25_Q, FRCH_storm7_08_25_NO3, "FRCH", "NO3", "0825")
FRCH_storm8_08_27_NO3.p = hyst_plot(FRCH_storm8_08_27_Q, FRCH_storm8_08_27_NO3, "FRCH", "NO3", "0827")

# fDOM #
FRCH_storm1_07_23_fDOM.p = hyst_plot(FRCH_storm1_07_23_Q, FRCH_storm1_07_23_fDOM, "FRCH", "fDOM", "0723")
FRCH_storm2_07_27_fDOM.p = hyst_plot(FRCH_storm2_07_27_Q, FRCH_storm2_07_27_fDOM, "FRCH", "fDOM", "0727")
FRCH_storm3_08_05_fDOM.p = hyst_plot(FRCH_storm3_08_05_Q, FRCH_storm3_08_05_fDOM, "VAUL", "fDOM", "0805")
FRCH_storm4_08_08_fDOM.p = hyst_plot(FRCH_storm4_08_08_Q, FRCH_storm4_08_08_fDOM, "FRCH", "fDOM", "0808")
FRCH_storm5a_08_15_fDOM.p = hyst_plot(FRCH_storm5a_08_15_Q, FRCH_storm5a_08_15_fDOM, "FRCH", "fDOM", "0815a")
FRCH_storm5b_08_17_fDOM.p = hyst_plot(FRCH_storm5b_08_17_Q, FRCH_storm5b_08_17_fDOM, "FRCH", "fDOM", "0817b")
FRCH_storm6a_08_19_fDOM.p = hyst_plot(FRCH_storm6a_08_19_Q, FRCH_storm6a_08_19_fDOM, "FRCH", "fDOM", "0819q")
FRCH_storm6b_08_20_fDOM.p = hyst_plot(FRCH_storm6b_08_20_Q, FRCH_storm6b_08_20_fDOM, "FRCH", "fDOM", "0820b")
FRCH_storm7_08_25_fDOM.p = hyst_plot(FRCH_storm7_08_25_Q, FRCH_storm7_08_25_fDOM, "FRCH", "fDOM", "0825")
FRCH_storm8_08_27_fDOM.p = hyst_plot(FRCH_storm8_08_27_Q, FRCH_storm8_08_27_fDOM, "FRCH", "fDOM", "0827")

# SPC #
FRCH_storm1_07_23_SPC.p = hyst_plot(FRCH_storm1_07_23_Q, FRCH_storm1_07_23_SPC, "FRCH", "SPC", "0723")
FRCH_storm2_07_27_SPC.p = hyst_plot(FRCH_storm2_07_27_Q, FRCH_storm2_07_27_SPC, "FRCH", "SPC", "0727")
FRCH_storm3_08_05_SPC.p = hyst_plot(FRCH_storm3_08_05_Q, FRCH_storm3_08_05_SPC, "VAUL", "SPC", "0805")
FRCH_storm4_08_08_SPC.p = hyst_plot(FRCH_storm4_08_08_Q, FRCH_storm4_08_08_SPC, "FRCH", "SPC", "0808")
FRCH_storm5a_08_15_SPC.p = hyst_plot(FRCH_storm5a_08_15_Q, FRCH_storm5a_08_15_SPC, "FRCH", "SPC", "0815a")
FRCH_storm5b_08_17_SPC.p = hyst_plot(FRCH_storm5b_08_17_Q, FRCH_storm5b_08_17_SPC, "FRCH", "SPC", "0817b")
FRCH_storm6a_08_19_SPC.p = hyst_plot(FRCH_storm6a_08_19_Q, FRCH_storm6a_08_19_SPC, "FRCH", "SPC", "0819q")
FRCH_storm6b_08_20_SPC.p = hyst_plot(FRCH_storm6b_08_20_Q, FRCH_storm6b_08_20_SPC, "FRCH", "SPC", "0820b")
FRCH_storm7_08_25_SPC.p = hyst_plot(FRCH_storm7_08_25_Q, FRCH_storm7_08_25_SPC, "FRCH", "SPC", "0825")
FRCH_storm8_08_27_SPC.p = hyst_plot(FRCH_storm8_08_27_Q, FRCH_storm8_08_27_SPC, "FRCH", "SPC", "0827")

# turb
FRCH_storm1_07_23_turb.p = hyst_plot(FRCH_storm1_07_23_Q, FRCH_storm1_07_23_turb, "FRCH", "turb", "0723")
FRCH_storm2_07_27_turb.p = hyst_plot(FRCH_storm2_07_27_Q, FRCH_storm2_07_27_turb, "FRCH", "turb", "0727")
FRCH_storm3_08_05_turb.p = hyst_plot(FRCH_storm3_08_05_Q, FRCH_storm3_08_05_turb, "VAUL", "turb", "0805")
FRCH_storm4_08_08_turb.p = hyst_plot(FRCH_storm4_08_08_Q, FRCH_storm4_08_08_turb, "FRCH", "turb", "0808")
FRCH_storm5a_08_15_turb.p = hyst_plot(FRCH_storm5a_08_15_Q, FRCH_storm5a_08_15_turb, "FRCH", "turb", "0815a")
FRCH_storm5b_08_17_turb.p = hyst_plot(FRCH_storm5b_08_17_Q, FRCH_storm5b_08_17_turb, "FRCH", "turb", "0817b")
FRCH_storm6a_08_19_turb.p = hyst_plot(FRCH_storm6a_08_19_Q, FRCH_storm6a_08_19_turb, "FRCH", "turb", "0819q")
FRCH_storm6b_08_20_turb.p = hyst_plot(FRCH_storm6b_08_20_Q, FRCH_storm6b_08_20_turb, "FRCH", "turb", "0820b")
FRCH_storm7_08_25_turb.p = hyst_plot(FRCH_storm7_08_25_Q, FRCH_storm7_08_25_turb, "FRCH", "turb", "0825")
FRCH_storm8_08_27_turb.p = hyst_plot(FRCH_storm8_08_27_Q, FRCH_storm8_08_27_turb, "FRCH", "turb", "0827")

# Multiplots of FRCH storms #

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

multiplot(FRCH_storm1_07_23_NO3.p, FRCH_storm1_07_23_fDOM.p, FRCH_storm1_07_23_SPC.p, FRCH_storm1_07_23_turb.p) # works 
multiplot(FRCH_storm2_07_27_NO3.p, FRCH_storm2_07_27_fDOM.p, FRCH_storm2_07_27_SPC.p, FRCH_storm2_07_27_turb.p) # works/ empty
multiplot(FRCH_storm3_08_05_NO3.p, FRCH_storm3_08_05_fDOM.p, FRCH_storm3_08_05_SPC.p, FRCH_storm3_08_05_turb.p) # works/empty
multiplot(FRCH_storm4_08_08_NO3.p, FRCH_storm4_08_08_fDOM.p, FRCH_storm4_08_08_SPC.p, FRCH_storm4_08_08_turb.p) # works/empty
multiplot(FRCH_storm5a_08_15_NO3.p, FRCH_storm5a_08_15_fDOM.p, FRCH_storm5a_08_15_SPC.p, FRCH_storm5a_08_15_turb.p) # works 
multiplot(FRCH_storm5b_08_17_NO3.p, FRCH_storm5b_08_17_fDOM.p, FRCH_storm5b_08_17_SPC.p, FRCH_storm5b_08_17_turb.p) # works 
multiplot(FRCH_storm6a_08_19_NO3.p, FRCH_storm6a_08_19_fDOM.p, FRCH_storm6a_08_19_SPC.p, FRCH_storm6a_08_19_turb.p) # works 
multiplot(FRCH_storm6b_08_20_NO3.p, FRCH_storm6b_08_20_fDOM.p, FRCH_storm6b_08_20_SPC.p, FRCH_storm6b_08_20_turb.p) # works 
multiplot(FRCH_storm7_08_25_NO3.p, FRCH_storm7_08_25_fDOM.p, FRCH_storm7_08_25_SPC.p, FRCH_storm7_08_25_turb.p) # works 
multiplot(FRCH_storm8_08_27_NO3.p, FRCH_storm8_08_27_fDOM.p, FRCH_storm8_08_27_SPC.p, FRCH_storm8_08_27_turb.p) # works 


multiplot(FRCH_storm1_07_23_NO3.p, FRCH_storm1_07_23_fDOM.p, FRCH_storm1_07_23_SPC.p, FRCH_storm1_07_23_turb.p,
          FRCH_storm2_07_27_NO3.p, FRCH_storm2_07_27_fDOM.p, FRCH_storm2_07_27_SPC.p, FRCH_storm2_07_27_turb.p,
          FRCH_storm3_08_05_NO3.p, FRCH_storm3_08_05_fDOM.p, FRCH_storm3_08_05_SPC.p, FRCH_storm3_08_05_turb.p,
          FRCH_storm4_08_08_NO3.p, FRCH_storm4_08_08_fDOM.p, FRCH_storm4_08_08_SPC.p, FRCH_storm4_08_08_turb.p,
          FRCH_storm5a_08_15_NO3.p, FRCH_storm5a_08_15_fDOM.p, FRCH_storm5a_08_15_SPC.p, FRCH_storm5a_08_15_turb.p,
          FRCH_storm5b_08_17_NO3.p, FRCH_storm5b_08_17_fDOM.p, FRCH_storm5b_08_17_SPC.p, FRCH_storm5b_08_17_turb.p,
          FRCH_storm6a_08_19_NO3.p, FRCH_storm6a_08_19_fDOM.p, FRCH_storm6a_08_19_SPC.p, FRCH_storm6a_08_19_turb.p,
          FRCH_storm6b_08_20_NO3.p, FRCH_storm6b_08_20_fDOM.p, FRCH_storm6b_08_20_SPC.p, FRCH_storm6b_08_20_turb.p,
          FRCH_storm7_08_25_NO3.p, FRCH_storm7_08_25_fDOM.p, FRCH_storm7_08_25_SPC.p, FRCH_storm7_08_25_turb.p,
          FRCH_storm8_08_27_NO3.p, FRCH_storm8_08_27_fDOM.p, FRCH_storm8_08_27_SPC.p, FRCH_storm8_08_27_turb.p,
          cols = 7)


###################################################################################################################
storm_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
  
  par(mar=c(5,5,3,5), bty = "n")
  plot(dat_Q$datavalue ~ as.POSIXct(dat_Q$valuedatetime, tz="America/Anchorage"), 
       type="l", xlab="", ylab="Q (L/sec)",
       ylim = c(min(dat_Q$datavalue, na.rm=T),max(dat_Q$datavalue, na.rm=T)), 
       col="blue", main= paste("Storm", storm_num),xaxt="n")
  axis.POSIXct(1, dat_Q$valuedatetime,format="%b-%d", las=2)
  
  par(new = T)
  
  plot(dat_response$datavalue ~ as.POSIXct(dat_response$valuedatetime, tz="America/Anchorage"), 
       type="l", axes=F, xlab="", ylab="",
       ylim = c(min(dat_response$datavalue, na.rm=T),max(dat_response$datavalue, na.rm=T)*1.25),
       col="red")
  axis(side = 4)
  mtext(side = 4, line = 3, paste(site, response_var)) 
}




pdf("Output from analyses/24_25_CPCRW_2017/C2.storm.plots.pdf", width = 25, height =15, onefile=FALSE)

layout.matrix <- matrix(c(1,7,14,21,
                          2,8,15,22,
                          3,9,16,23,
                          4,10,17,24,
                          5,11,18,25,
                          6,12,19,26,
                          0,13,20,27 ), nrow = 4, ncol = 7)
layout(layout.matrix)

storm_plot(C2_storm1_Q, C2_storm1_NO3, "C2", "NO3", "1")
storm_plot(C2_storm1a_Q, C2_storm1a_NO3, "C2", "NO3", "1a")
storm_plot(C2_storm1b_Q, C2_storm1b_NO3, "C2", "NO3", "1b")
storm_plot(C2_storm2_Q, C2_storm2_NO3, "C2", "NO3", "2")
storm_plot(C2_storm3_Q, C2_storm3_NO3, "C2", "NO3", "3")
storm_plot(C2_storm4_Q, C2_storm4_NO3, "C2", "NO3", "4")
#storm_plot(C2_storm5_Q, C2_storm5_NO3, "C2", "NO3", "5")

storm_plot(C2_storm1_Q, C2_storm1_fDOM, "C2", "fDOM", "1")
storm_plot(C2_storm1a_Q, C2_storm1a_fDOM, "C2", "fDOM", "1a")
storm_plot(C2_storm1b_Q, C2_storm1b_fDOM, "C2", "fDOM", "1b")
storm_plot(C2_storm2_Q, C2_storm2_fDOM, "C2", "fDOM", "2")
storm_plot(C2_storm3_Q, C2_storm3_fDOM, "C2", "fDOM", "3")
storm_plot(C2_storm4_Q, C2_storm4_fDOM, "C2", "fDOM", "4")
storm_plot(C2_storm5_Q, C2_storm5_fDOM, "C2", "fDOM", "5")
